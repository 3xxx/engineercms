/**
 * SCAYT v3.1.2364 master:6f5c7c97 #180
 * Copyright (c) 2000-2018 WebSpellChecker LLC All rights reserved.
 */

/*!
 * jQuip JavaScript Library v0.0.3
 * https://github.com/mythz/jquip
 *
 * Copyright, Demis Bellot
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 *
 */

/*!
 * Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Copyright 2012, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.681
 * Build date: 20 July 2012
 */

/*! @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 0.8.1 - Build: 266 (2012/07/31 03:33 PM)
 */ 
!function(){var a,b,c={node:"node",browser:"browser"};"undefined"==typeof window?(b=global,a=c.node):(b=window,a=c.browser),b.WEBSPELLCHECKER=b.WEBSPELLCHECKER||{},b.WEBSPELLCHECKER.env=a,b.WEBSPELLCHECKER.envTypes=c,a===c.node&&(module.exports=b.WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={arrayUnique:function(a,b){for(var c=a.concat(),b=b||function(a,b){return a===b},d=0;d<c.length;d++)for(var e=d+1;e<c.length;e++)b(c[d],c[e])&&c.splice(e--,1);return c},argumentsToArray:function(a){for(var b=a.length,c=new Array(b),d=0;b>d;d++)c[d]=a[d];return c},zipArraysToObject:function(a,b){for(var c={},d=0;d<a.length;d++)c[a[d]]=b[d];return c},diffArrays:function(a,b){for(var c=[],d=b.length,e=0;d>e;e++)this.indexOf(a,b[e])<0&&c.push(b[e]);return c}};a.Utils=a.Utils||{},a.Utils.ArrayUtils=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={splice:function(a,b,c,d){return a.substring(0,b)+d+a.substring(b+c)},replaceFromTo:function(a,b,c,d){return a.substring(0,b)+d+a.substring(c)}};a.Utils=a.Utils||{},a.Utils.StringUtils=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";if(a.env===a.envTypes.browser){var b=function(){var a=navigator.userAgent.toLowerCase(),b=a.match(/edge[ \/](\d+.?\d*)/),c=a.indexOf("trident/")>-1,d=!(!b&&!c),e=window.opera,f={ie:d,edge:!!b,opera:!!e&&e.version,webkit:!d&&a.indexOf(" applewebkit/")>-1,air:a.indexOf(" adobeair/")>-1,mac:a.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode&&(!document.documentMode||document.documentMode<10),mobile:a.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(a)};f.gecko="Gecko"==navigator.product&&!f.webkit&&!f.opera&&!f.ie,f.webkit&&(a.indexOf("chrome")>-1?f.chrome=!0:f.safari=!0);var g=0;if(f.ie&&(g=b?parseFloat(b[1]):f.quirks||!document.documentMode?parseFloat(a.match(/msie (\d+)/)[1]):document.documentMode),f.gecko){var h=a.match(/rv:([\d\.]+)/);h&&(h=h[1].split("."),g=1e4*h[0]+100*(h[1]||0)+1*(h[2]||0))}return f.air&&(g=parseFloat(a.match(/ adobeair\/(\d+)/)[1])),f.webkit&&(g=parseFloat(a.match(/ applewebkit\/(\d+)/)[1])),f.version=g,f}();a.Utils=a.Utils||{},a.Utils.Browser=b}}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(a){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(null!=d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b}),"function"!=typeof Object.create&&(Object.create=function(){function a(){}var b=Object.prototype.hasOwnProperty;return function(c){if("object"!=typeof c)throw TypeError("Object prototype may only be an Object or null");a.prototype=c;var d=new a;if(a.prototype=null,arguments.length>1){var e=Object(arguments[1]);for(var f in e)b.call(e,f)&&(d[f]=e[f])}return d}}()),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("function"!=typeof e&&("object"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}()),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=0|b;if(f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.map||(Array.prototype.map=function(a){var b,c,d;if(null==this)throw new TypeError("this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(b=arguments[1]),c=new Array(f),d=0;f>d;){var g,h;d in e&&(g=e[d],h=a.call(b,g,d,e),c[d]=h),d++}return c}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(arguments.length>=2)b=arguments[1];else{for(;d>e&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;d>e;e++)e in c&&(b=a(b,c[e],e,c));return b}),Array.prototype.forEach||(Array.prototype.forEach=function(a){var b,c;if(null==this)throw new TypeError("this is null or not defined");var d=Object(this),e=d.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(b=arguments[1]),c=0;e>c;){var f;c in d&&(f=d[c],a.call(b,f,c,d)),c++}}),Array.prototype.includes||(Array.prototype.includes=function(a){var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;for(e>=0?d=e:(d=c+e,0>d&&(d=0));c>d;){var f=b[d];if(a===f||a!==a&&f!==f)return!0;d++}return!1})}(),function(){function a(a){var b={isString:function(a){return"string"==typeof a},notEmptyString:function(a){return""!==a&&b.isString(a)},isArray:function(a){return"[object Array]"==={}.toString.call(a)},isHash:function(a){return b.isObject(a)&&!b.isArray(a)&&!b.isFunction(a)},isBoolean:function(a){return"boolean"==typeof a},isObject:function(a){return a===Object(a)},isDate:function(a){return a instanceof Date},isDefined:function(a){return null!==a&&void 0!==a},isEmpty:function(a){var c;if(!b.isDefined(a))return!0;if(b.isFunction(a))return!1;if(b.isString(a))return b.EMPTY_STRING_REGEXP.test(a);if(b.isArray(a))return 0===a.length;if(b.isDate(a))return!1;if(b.isObject(a)){for(c in a)return!1;return!0}return!1},isFunction:function(a){return"function"==typeof a},isInteger:function(a){return b.isNumber(a)&&a%1===0},isNumber:function(a){return"number"==typeof a&&!isNaN(a)},isPositive:function(a){return"number"==typeof a&&a>=0}};a.Utils=a.Utils||{},a.Utils.TypeChecker=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={space:"[\\s\\xA0]",commonSpace:" ",quotes:"'\"",nonWhiteSpaceChar:"\\S",dot:"\\.",anyChar:".",comma:"\\,",EOL:"[\r\n(\r\n)]",digits:"[0-9]",HtmlSpaceSymbol:String.fromCharCode(160),textPunctuation:' ,"^$*+?=!:|\\/\\(\\)\\[\\]\\{\\}\\>\\<\\@\\%\\&\\#\\;\\_\\~\\u061F\\u060C\\u061B\\u0001-\\u001F\\u0080-\\u00B6\\u00B8-\\u00BF\\u2000-\\u200A\\u200C-\\u266F\\u2E00-\\u2E7F',situationalSeparators:"\\.\\-\\'",sentenceEndChars:"\\.!?",specialCharacters:String.fromCharCode(8203)+String.fromCharCode(65279),ip:"/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/",twoAndMore:"{2,}",whiteSpace:" \\f\\n\\r\\t\\v\\uFEFF\\u0085\\u00A0\\u1680\\u180E\\u2000-\\u200C\\u2028\\u2029\\u202F\\u205F\\u3000"};a.RegularsSources=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b=["log","warn","info","debug"],c=a.Utils.browser;JSON.stringify=JSON.stringify||function(){return arguments};for(var d=0;d<b.length;d++)console[b[d]]=console[b[d]]||function(){};var e=!1,f={isON:function(a){a=a||!1,e=a?!0:/scaytDebug\b/.test(location.hash)},isIE:c?c.ie:!1,log:function(a){var b=a||{},c=void 0;e&&(c="object"==typeof b?[b.name,":: "+b.msg,b.data]:[b],this.isIE?(c=[b.name,":: "+b.msg,JSON.stringify(b.data,null,"")],c=c.join(" "),console.log(c)):console.log.apply(console,c))},console:console};a.logger=f}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){var b=a.Utils,c=a.logger.console,d=!1,e=[],f={XMLHttpRequest:"undefined"!=typeof XMLHttpRequest?XMLHttpRequest:null,XDomainRequest:"undefined"!=typeof XDomainRequest?XDomainRequest:null,URL:function(a){a=a||{};var b=this.protocol=a.protocol||"http",c=this.host=a.host||"localhost",d=this.port=a.port||"80",e=this.path=a.path||"",f={},g={};this.addParameter=function(a,b){return a&&b&&(f[a]=b),this},this.addParameters=function(a){for(var b in a)this.addParameter(b,a[b]);return this},this.addMetaParameters=function(a){return Object.assign(g,a),this},this.getParameter=function(a){return f[a]},this.joinParams=function(a){var b="";if(a=a||f,Object.keys(a).length){for(var c in a)b+=c+"="+encodeURIComponent(a[c])+"&";return b.slice(0,-1)}return""},this.joinRequestParams=function(){return this.joinParams(f)},this.joinRequestMetaParams=function(){return this.joinParams(g)},this.joinUrl=function(){var a="";return a+=b+"://",a+=c,a+="80"==d?"/":":"+d+"/",a+=e.replace(/^\/*/,"")},this.joinUrlWithParams=function(a){var b=this.joinUrl();return b+=a?"?"+a:""},this.joinUrlWithMetadata=function(){return this.joinUrlWithParams(this.joinRequestMetaParams())},this.build=function(){return this.joinUrlWithParams(this.joinRequestParams())},this.clear=function(){return f={},g={},this}},AJAX:function(a){var g={},h=JSON.parse||function(){return arguments};if(d){for(var i=0;i<e.length;i++)!function(b){e[b].success&&setTimeout(function(){a.onSuccess(e[b].success)},0),e[b].error&&setTimeout(function(){a.onError(e[b].error)},0)}(i);return{finished:!0}}return g.params={url:a.url.joinUrlWithMetadata(),data:a.url.joinRequestParams(),onSuccess:a.onSuccess,onError:a.onError},g.request=new f.XMLHttpRequest,null!==f.XDomainRequest?g.request=new f.XDomainRequest:"withCredentials"in g.request?g.request.withCredentials=!1:c.warn("Cors is not supported by this browser!"),g.request.onload=function(){var a=g.request.responseText,b=g.request.status;if(g.success=!0,b&&200!==b)g.params.onError&&g.params.onError({});else{try{a=h(a)}catch(d){return c.warn("CORS response parsing error: "+d),void(g.params.onError&&g.params.onError())}a&&a.error?(a.message&&c.warn(a.message),g.params.onError&&g.params.onError(a)):g.params.onSuccess&&g.params.onSuccess(a)}},g.request.onerror=function(){console.warn("The WebSpellChecker Service is currently unavailable."),g.error=!0,g.params.onError&&g.params.onError({})},g.request.onabort=function(){g.error=!0,g.params.onError&&g.params.onError({})},g.request.open("POST",g.params.url,!0),b.Browser.ie&&9===b.Browser.version?setTimeout(function(){g.request.send(g.params.data)},500):g.request.send(g.params.data),g},JSONP:function(a){var b="callback"+Math.random().toString(20).substr(2,9),c="WEBSPELLCHECKER.IO.";if(d){for(var g=0;g<e.length;g++)e[g].success&&a.onSuccess(e[g].success),e[g].error&&a.onError(e[g].error);return b}return a.url.addParameter("callback",c+b),new f.Script({url:a.url.build(),id:b,callbackName:b,onSuccess:a.onSuccess,onError:a.onError})},NODE:function(a){var b,d=a.url,e=d.joinRequestMetaParams(),f=require("http"===d.protocol?"http":"https"),g={protocol:d.protocol+":",port:d.port,hostname:d.host,path:"/"+d.path+(e?"?"+e:""),method:"POST",headers:{"Content-Type":"text/javascript; charset=UTF-8"}};return b=f.request(g,function(b){(b.statusCode<200||b.statusCode>299)&&a.onError&&a.onError("Failed to load page, status code: "+b.statusCode);var d=[];b.on("data",function(a){d.push(a)}),b.on("end",function(){var b=d.join("");try{b=JSON.parse(b)}catch(e){c.warn("CORS response parsing error: "+e)}b&&b.error?(b.message&&c.warn(b.message),a.onError&&a.onError(b)):a.onSuccess&&a.onSuccess(b)})}),b.on("error",function(){a.onError&&a.onError({})}),b.write(a.url.joinRequestParams()),b.end(),b},Script:function(a){a=a||{};var b,d,e=this,f=function(){WEBSPELLCHECKER.IO[a.callbackName]=function(a){b=a}},g=function(){delete WEBSPELLCHECKER.IO[a.callbackName]},h=function(){g(),e.removeScript()};a.callbackName&&f();var i=document.createElement("script");i.type="text/javascript",i.id=a.id?a.id:"",i.src=a.url?a.url:"",i.onload=function(){this.success||(this.success=!0,a.callbackName?(b&&b.error?(b.message&&c.warn(b.message),a.onError&&a.onError(b)):a.onSuccess&&a.onSuccess(b),h()):a.onSuccess&&a.onSuccess())},i.onerror=function(){this.error=!0,a.onError&&a.onError({}),a.callbackName&&h()},i.onreadystatechange=function(){var a=this;("complete"===this.readyState||"loaded"===this.readyState)&&setTimeout(function(){a.onload()},0)},d=document.getElementsByTagName("head")[0],d.appendChild(i),this.getScript=function(){return i},this.removeScript=function(){d.removeChild(i),i=null}},get:function(a,b,c){return f.request({url:a,onSuccess:b,onError:c})},loadScript:function(a,b,c){var d=f.loadScript.cache?f.loadScript.cache:f.loadScript.cache={};if(a=a.build(),!d.hasOwnProperty(a)){d[a]=!0;var e=new f.Script({url:a,onSuccess:b,onError:c});return e}},ioMockStart:function(a){d=!0,e=a?a:e},ioMockEnd:function(){d=!1}};f.requestTypes={AJAX:f.AJAX,JSONP:f.JSONP,NODE:f.NODE},f.setRequestType=function(a){var b=f.requestTypes[a];b&&(f.request=b)},f.request=a.env===a.envTypes.node?f.requestTypes.NODE:f.requestTypes.AJAX,a.IO=f}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a){for(var b=0;b<a.length;b++)"\\"===a[b-1]||"["!==a[b]&&"]"!==a[b]||(a=a.substring(0,b)+a.substring(b+1));return a}function c(a,b,c){this.name=a,this.flags=c||"",this.source=b,this.string="",this.regExp=null}c.prototype={_wrapSymbol:"#",_getRegExp:function(){if(this.regExp){var a=this.regExp.toString().match(/[gimuy]*$/)[0];if(this.regExp.source===this.source&&a===this.flags)return this.regExp}return this.regExp=new RegExp(this.source,this.flags)},_combine:function(a){var b=a.regExpObject;if(b instanceof c==!1)throw new Error(b.name+" should be instance of RegularType constructor.");var d=a.separator||"",e=(a.nameSeparator||"&",this.source+d+b.source),f=a.compositionName||this.name+a.nameSeparator+b.name,g=new c(f,e).init(this.string);return g=g.addFlags(b.flags+this.flags)},_replaceWithAnotherSource:function(a,b){var c=this._updateSource(b).replace(a);return c.source=this.source,c},_updateSource:function(a){var b=this.clone();return b.source=a,b},init:function(a){var b=this.clone();return b.string=a,b},clone:function(){var a=Object.create(c.prototype);return Object.assign(a,this)},getString:function(){return this.string},getLastIndex:function(){return this._getRegExp().lastIndex},setLastIndex:function(a){var b=this._getRegExp();b.lastIndex=a},addFlags:function(a){var b=this.clone(),c=a.split("");return c.forEach(function(a){-1===b.flags.indexOf(a)&&(b.flags+=a)},this),b},g:function(){return this.addFlags("g")},i:function(){return this.addFlags("i")},set:function(){var a=b(this.source);return this._updateSource("["+a+"]")},group:function(){return this._updateSource("("+this.source+")")},start:function(){return this._updateSource("^"+this.source)},end:function(){return this._updateSource(this.source+"$")},onePlus:function(){return this._updateSource(this.source+"+")},more:function(){return this._updateSource(this.source+"*")},leftWordBoundary:function(){return this._updateSource("\\b"+this.source)},rightWordBoundary:function(){return this._updateSource(this.source+"\\b")},wrapWordBoundary:function(){return this.leftWordBoundary().rightWordBoundary()},lookahead:function(){return this.group(this._updateSource("?="+this.source))},split:function(a){return a=a||this.string,a.split(this._getRegExp())},match:function(a){return a=a||this.string,a.match(this._getRegExp())},search:function(a){return a=a||this.string,a.search(this._getRegExp())},test:function(a){return this._getRegExp().test(a||this.string)},replace:function(a,b){if(void 0!==b)return a.replace(this._getRegExp(),b);var c=this.clone();return b=a,c.string=c.string.replace(this._getRegExp(),b),c},replaceLeftWrapped:function(a,b){return a=a||this._wrapSymbol,this._replaceWithAnotherSource(b,a+this.source)},replaceRightWrapped:function(a,b){return a=a||this._wrapSymbol,this._replaceWithAnotherSource(b,this.source+a)},wrapInclude:function(a){return a=a||this._wrapSymbol,this.group().replace(a+"$1"+a)},composition:function(a,b){return this._combine({regExpObject:a,separator:"",nameSeparator:"&",compositionName:b})},or:function(a,b){return this._combine({compositionName:b,regExpObject:a,separator:"|",nameSeparator:"|"})},compositionGraph:function(a,b){var d=this instanceof c?this:void 0;return a.forEach(function(a){d=d?d.composition(a):a},this),d.name=b||d.name,d},store:function(a){return d.addRegularType(a||this.name,this.source,this.flags),this}};var d={addRegularType:function(a,b,d){var e=new c(a,b,d);return this[a]=e,e},wrap:function(a){return new c("regular",a)}},e=a.RegularsSources;for(var f in e)d.addRegularType(f,e[f]);a.RegularsManager=d}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){function b(a,b){this.name=a,this.validate=b}function c(){this.critical=!1,this.count=0,this.reports=[],this.addError=function(a){a.critical&&this.critical===!1&&(this.critical=!0),this.reports.push(a),this.count+=1}}function d(){this._validatedFields=[]}function e(a){var b;if(h.isHash(a)){b={};for(var c in a)b[c]=e(a[c])}else if(h.isArray(a)){b=a.slice(0);for(var d=0;d<b.length;d+=1)b[d]=e(b[d])}else b=a;return b}function f(a){Object.assign(this,a)}{var g,h=a.Utils.TypeChecker;a.Utils.ArrayUtils,a.RegularsManager}d.prototype={constructor:d,addOption:function(a){var b=a.name;this._validatedFields.includes(b)||(this[b]=this._createOptionValue(a),"undefined"!=typeof this[b]&&this._validatedFields.push(b))},_createOptionValue:function(a){var b,c=a.value,d=a.template,f={},g=a.name,h=a.errorHandler,i=e(d.defaultValue);return void 0!==c||d.required?(b=d.type.validate(c))?c:(f.critical=d.required||!1,f.optionName=g,f.message="Parameter "+g+" should have a type - "+d.type.name+".",h(f),i):i}},f.prototype={constructor:f,getDefaultValue:function(a){return this[a].defaultValue},setDefaults:function(a){for(var b in a)this[b].defaultValue=a[b]}};var i={optionTypes:{},optionsTemplate:{},optionsValidators:{array:h.isArray,"boolean":h.isBoolean,date:h.isDate,defined:h.isDefined,empty:h.isEmpty,"function":h.isFunction,hash:h.isHash,integer:h.isInteger,positive:h.isPositive,number:h.isNumber,object:h.isObject,string:h.isString,urlProtocol:function(a){return"http"===a||"https"===a},urlHost:function(a){return h.notEmptyString(a)},urlPort:function(a){return h.isNumber(a)?h.isInteger(a):h.isString?h.isInteger(parseFloat(a)):!1},urlPath:function(a){return h.notEmptyString(a)},defaultValue:function(){return!1}},createOptions:function(a,e,g){var i,j,k=new c;a=a||{},i=a instanceof d==!0?a:new d,h.isString(e)?j=this.importOptionsTemplate(e):h.isObject(e)&&(j=e instanceof f==!0?e:new f(e));for(var l in j)if(j.hasOwnProperty(l)!==!1){if(j[l].type instanceof b==!1)throw new Error(l+' template "type" parameter should be instance of OptionsManager.OptionType constructor.');i.addOption({name:l,value:a[l],template:j[l],errorHandler:function(a){k.addError(a)}})}return g&&k.count>0&&g(k),i},extendOptionTypes:function(a){return h.isArray(a)&&a.forEach(i.extendOptionTypes.bind(this)),a.name&&h.isFunction(a.validate)?void(this.optionTypes[a.name]||(this.optionTypes[a.name]=new b(a.name,a.validate))):!1},exportOptionsTemplate:function(a,b){b instanceof f==!1&&(b=new f(b)),this.optionsTemplate[a]=b},importOptionsTemplate:function(a){var b=this.optionsTemplate[a];if(b instanceof f==!1)throw new Error("Templates name: "+a+" is not defined.");return b},mergeOptionsTemplates:function(){var a={};return Array.prototype.forEach.call(arguments,function(b){if(h.isObject(b))for(var c in b)if(b.hasOwnProperty(c)!==!1){if(a[c])throw new Error("Template for "+c+" defined twice.");a[c]=b[c]}}),new f(a)}};g=i.optionsValidators,i.optionTypes={};for(var j in g)i.optionTypes[j]=new b(j,g[j]);a.OptionsManager=i}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){function b(b){var c,d;this._services={},this._options=e.createOptions(b,"WebApiTemplate",function(a){c=a.critical,a.reports.forEach(function(a){f.log(a.message)},this)}),this._dependencies={TextProcessor:a.TextProcessor,Connection:a.Connection};for(var g in this._dependencies)this._services[g]=new this._dependencies[g](g,this);d=this._services.Connection,this._commands=d.getCommands(),this._udActions=d.getUdActions()}function c(a){this.name=a.name,this.wordlist=a.wordlist,this.makeUdAction=a.makeUdAction}var d,e=a.OptionsManager,f=a.logger,g=e.optionTypes;f.isON(!0),d={lang:{type:g.string,defaultValue:"en_US"},serviceProtocol:{type:g.urlProtocol,defaultValue:"http"},serviceHost:{type:g.urlHost,defaultValue:"svc.webspellchecker.net"},servicePort:{type:g.urlPort,defaultValue:80},servicePath:{type:g.urlPath,defaultValue:"spellcheck31/script/ssrv.cgi"},serviceId:{type:g.string,defaultValue:"1:KpkvQ2-6KNUj-L1W3u2-C9j0K1-Zv2tY1-CfDOx-WfGRg2-qXtci-YyyE34-j09H42-b0aCt3-d9a"},userDictionaryName:{type:g.string,defaultValue:""},customDictionaryIds:{type:g.string,defaultValue:""},minWordLength:{type:g.number,defaultValue:3},communicationFormat:{type:g.string,defaultValue:"json"},customPunctuation:{type:g.string,defaultValue:""},appType:{type:g.string,defaultValue:"webApi"}},e.exportOptionsTemplate("WebApiTemplate",d),b.prototype={constructor:b,_getService:function(a){return this._services[a]||null},_request:function(a,b){return this._getService("Connection").request(a,b.success||function(){},b.error||function(){})},_makeUdAction:function(a,b){"undefined"==typeof b.name&&(b.name=this.getOption("userDictionaryName"));var c={command:this._commands.userDictionary,UDAction:this._udActions[a],UDName:b.name,newUDName:b.newName,wordList:b.wordList,UDWord:b.word};return this._request(c,b)},_udMethodWrapper:function(a,b){var d=this,e=b.success||function(){};return b.success=function(a){var b=new c({wordlist:a.wordlist,name:a.name,makeUdAction:d._makeUdAction.bind(d)});e(b)},this._makeUdAction(a,b)},getOption:function(a){return this._options[a]},setOption:function(a,b){var c=!1,f={},g={};return d[a]&&(c=!0,f[a]=d[a],g[a]=b,this._options[a]=e.createOptions(g,f)[a]),c},getInfo:function(a){return this._request({command:this._commands.getInfo},a)},getLangList:function(a){return this._request({command:this._commands.getLangList},a)},spellCheck:function(a){function b(a,b){var c;return b.reduce(function(b,d){for(var e=0;e<a.length;e+=1)if(c=a[e],c.word===d.word)return b.push(Object.assign({},c,d)),b;return b},[])}var c=Object.assign({},a),d=this._getService("TextProcessor").getWordsFromString(c.text),e=d.wordsCollection.join(",");return c.success=function(c){var e=b(c,d.wordsOffsets);a.success(e)},this._request({command:this._commands.spellCheck,language:c.lang||this.getOption("lang"),userWordlist:a.userWordlist,customDictionary:this.getOption("customDictionaryIds"),userDictionary:this.getOption("userDictionaryName"),text:e},{success:c.success,error:c.error})},grammarCheck:function(a){return this._request({command:this._commands.grammarCheck,language:a.lang||this.getOption("lang"),sentences:a.sentences,text:a.text},a)},getUserDictionary:function(a){return this._udMethodWrapper("getDict",a)},createUserDictionary:function(a){return this._udMethodWrapper("create",a)},deleteUserDictionary:function(a){return this._udMethodWrapper("delete",a)},renameUserDictionary:function(a){return this._udMethodWrapper("rename",a)},addWordToUserDictionary:function(a){return this._udMethodWrapper("addWord",a)},deleteWordFromUserDictionary:function(a){return this._udMethodWrapper("deleteWord",a)},getDictionariesModifyTime:function(a){return this._request({command:this._commands.getDictionariesModifyTime,UDName:a.userDictionary,customDictionary:a.customDictionary},a)}},c.prototype={constructor:c,_action:function(a,b){this.makeUdAction(a,Object.assign({name:this.name},b))},addWord:function(a){var b=a.success,c=this;a.success=function(){c.wordlist.push(a.word),b(c)},this._action("addWord",a)},deleteWord:function(a){var b=a.success,c=a.word,d=this;a.success=function(){for(var a=[],e=0;e<d.wordlist.length;e+=1)d.wordlist[e]!==c&&a.push(a[e]);d.wordlist=a,b(d)},this._action("deleteWord",a)},"delete":function(a){var b=a.success,c=this;a.success=function(){this.name=void 0,this.wordlist=void 0,b(c)},this._action("delete",a)},rename:function(a){var b=a.success,c=this;a.success=function(){c.name=a.newName,b(c)},this._action("rename",a)},getWordList:function(){return this.wordlist.slice()}},a.initWebApi=function(a){return new b(a)}}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a,b){this.moduleId=a,this.appInstance=b;var d=this.appInstance.getOption("customPunctuation");c.addRegularType("customPunctuation",d),c.textPunctuation.composition(c.customPunctuation).store("punctuationRegExp")}var c=a.RegularsManager,d=a.Utils.StringUtils;b.prototype={constructor:b,replaceSepatators:function(a){var b,d=c.punctuationRegExp;return a=c.HtmlSpaceSymbol.compositionGraph([d,c.EOL]).g().set().replace(a," "),b=c.situationalSeparators.set().g(),a=b.composition(c.twoAndMore).init(a).wrapInclude("#").getString(),a=b.init(a).replaceLeftWrapped("#"," ").replaceRightWrapped("#"," ").getString(),a=b.init(a).replaceRightWrapped(" ","  ").replaceLeftWrapped(" ","  ").start().or(b.end()).replace(" ").getString()},removeSpecialCharacters:function(a){return c.specialCharacters.set().g().replace(a,"")},getWordOffsets:function(a,b){var c=b.indexOf(a),d=c+a.length;return{startOffset:c,endOffset:d}},getWordsFromString:function(a){var b,e=this.appInstance.getOption("minWordLength"),f=[],g=this;return a=this.replaceSepatators(a),a=this.removeSpecialCharacters(a),b=c.space.init(a).split().reduce(function(b,c){var h;return""!==c&&c.length>=e&&(f.includes(c)||f.push(c),h=g.getWordOffsets(c,a),h.word=c,b.push(h),a=d.replaceFromTo(a,h.startOffset,h.endOffset,new Array(c.length+1).join(" "))),b},[]),{wordsOffsets:b,wordsCollection:f}}},a.TextProcessor=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a,b){this.moduleId=a,this.appInstance=b,this.url=new c.URL({protocol:b.getOption("serviceProtocol"),host:b.getOption("serviceHost"),port:b.getOption("servicePort"),path:b.getOption("servicePath")}),this.defaultParameters=this.setDefaults(["serviceId","communicationFormat"],d),this.defaultMetaParameters=this.setDefaults(["appType"],e)}var c=a.IO,d={serviceId:"customerid",command:"cmd",communicationFormat:"format",userDictionary:"user_dictionary",customDictionary:"custom_dictionary",UDAction:"action",UDName:"name",newUDName:"new_name",removeUDCookie:"remove_ud_cookie",UDWord:"word",userWordlist:"user_wordlist",wordList:"wordlist",language:"slang",outType:"out_type",text:"text",sentences:"sentences"},e={appType:"app_type"},f={spellCheck:"check_spelling",grammarCheck:"grammar_check",userDictionary:"user_dictionary",getLangList:"get_lang_list",getInfo:"get_info",getDictionariesModifyTime:"get_dicts_modify_time"},g={create:"create","delete":"delete",rename:"rename",check:"check",addWord:"addword",deleteWord:"deleteword",getDict:"getdict"};b.prototype={constructor:b,getCommands:function(){return f},getUdActions:function(){return g},setDefaults:function(a,b){var c={};return a.forEach(function(a){c[b[a]]=this.appInstance.getOption(a)},this),c},getURL:function(){return this.url.clear()},prepareParameters:function(a,b){var c,d={};for(var e in a){if(c=b[e],!c)throw new Error("parameter "+e+" is not specified.");d[c]=a[e]}return d=Object.assign({},this.defaultParameters,d),d[b.command]===f.getLangList&&delete d[b.communicationFormat],d},request:function(a,b,e){return c.get(this.getURL().addParameters(this.prepareParameters(a,d)).addMetaParameters(this.defaultMetaParameters),b,e)}},a.Connection=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),WEBSPELLCHECKER.signals=function(){!function(a){function b(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function c(a,b){if("function"!=typeof a)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function d(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){d.prototype.dispatch.apply(a,arguments)}}b.prototype={active:!0,params:null,execute:function(a){var b;if(this.active&&this._listener){a=this.params?this.params.concat(a):a;try{b=this._listener.apply(this.context,a)}catch(c){setTimeout(function(){throw c},0)}finally{this._isOnce&&this.detach()}}return b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},d.prototype={VERSION:"1.1.1",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,c,d,e){var f=this._indexOfListener(a,d);if(-1!==f){if(a=this._bindings[f],a.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.")}else a=new b(this,a,c,d,e),this._addBinding(a);return this.memorize&&this._prevParams&&a.execute(this._prevParams),a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,d){return c(a,"add"),this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){return c(a,"addOnce"),this._registerListener(a,!0,b,d)},remove:function(a,b){c(a,"remove");var d=this._indexOfListener(a,b);return-1!==d&&(this._bindings[d]._destroy(),this._bindings.splice(d,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){for(var a=arguments.length,b=Array(a),c=0;a>c;++c)b[c]=arguments[c];if(a=this._bindings.length,this.memorize&&(this._prevParams=b),a){c=this._bindings.slice(),this._shouldPropagate=!0;do a--;while(c[a]&&this._shouldPropagate&&!1!==c[a].execute(b))
}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},d.Signal=d,a.signals=d}(this)},WEBSPELLCHECKER.signals(),WEBSPELLCHECKER.rangy=function(){!function(a){function b(a,b){var c=typeof a[b];return c==v||!(c!=u||!a[b])||"unknown"==c}function c(a,b){return!(typeof a[b]!=u||!a[b])}function d(a,b){return typeof a[b]!=w}function e(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function f(a){return a&&B(a,A)&&D(a,z)}function g(a){return c(a,"body")?a.body:a.getElementsByTagName("body")[0]}function h(a){typeof console!=w&&b(console,"log")&&console.log(a)}function i(a,b){G&&b?alert(a):h(a)}function j(a){I.initialized=!0,I.supported=!1,i("Rangy is not supported in this environment. Reason: "+a,I.config.alertOnFail)}function k(a){i("Rangy warning: "+a,I.config.alertOnWarn)}function l(a){return a.message||a.description||String(a)}function m(){if(G&&!I.initialized){var a,c=!1,d=!1;b(document,"createRange")&&(a=document.createRange(),B(a,y)&&D(a,x)&&(c=!0));var e=g(document);if(!e||"body"!=e.nodeName.toLowerCase())return void j("No body element found");if(e&&b(e,"createTextRange")&&(a=e.createTextRange(),f(a)&&(d=!0)),!c&&!d)return void j("Neither Range nor TextRange are available");I.initialized=!0,I.features={implementsDomRange:c,implementsTextRange:d};var i,k;for(var m in F)(i=F[m])instanceof q&&i.init(i,I);for(var n=0,o=L.length;o>n;++n)try{L[n](I)}catch(p){k="Rangy init listener threw an exception. Continuing. Detail: "+l(p),h(k)}}}function n(a,b,c){c&&(a+=" in module "+c.name),I.warn("DEPRECATED: "+a+" is deprecated. Please use "+b+" instead.")}function o(a,b,c,d){a[b]=function(){return n(b,c,d),a[c].apply(a,H.toArray(arguments))}}function p(a){a=a||window,m();for(var b=0,c=M.length;c>b;++b)M[b](a)}function q(a,b,c){this.name=a,this.dependencies=b,this.initialized=!1,this.supported=!1,this.initializer=c}function r(a,b,c){var d=new q(a,b,function(b){if(!b.initialized){b.initialized=!0;try{c(I,b),b.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+l(d);h(e),d.stack&&h(d.stack)}}});return F[a]=d,d}function s(){}function t(){}var u="object",v="function",w="undefined",x=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],y=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],z=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],A=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],B=e(b),C=e(c),D=e(d),E=[].forEach?function(a,b){a.forEach(b)}:function(a,b){for(var c=0,d=a.length;d>c;++c)b(a[c],c)},F={},G=typeof window!=w&&typeof document!=w,H={isHostMethod:b,isHostObject:c,isHostProperty:d,areHostMethods:B,areHostObjects:C,areHostProperties:D,isTextRange:f,getBody:g,forEach:E},I={version:"1.3.0",initialized:!1,isBrowser:G,supported:!0,util:H,features:{},modules:F,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==w?!0:rangyAutoInitialize}};I.fail=j,I.warn=k;var J;({}).hasOwnProperty?(H.extend=J=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&null!==d&&"object"==typeof d&&null!==e&&"object"==typeof e&&J(d,e,!0),a[f]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},H.createOptions=function(a,b){var c={};return J(c,b),a&&J(c,a),c}):j("hasOwnProperty not supported"),G||j("Rangy can only run in a browser"),function(){var a;if(G){var b=document.createElement("div");b.appendChild(document.createElement("span"));var c=[].slice;try{1==c.call(b.childNodes,0)[0].nodeType&&(a=function(a){return c.call(a,0)})}catch(d){}}a||(a=function(a){for(var b=[],c=0,d=a.length;d>c;++c)b[c]=a[c];return b}),H.toArray=a}();var K;G&&(b(document,"addEventListener")?K=function(a,b,c){a.addEventListener(b,c,!1)}:b(document,"attachEvent")?K=function(a,b,c){a.attachEvent("on"+b,c)}:j("Document does not have required addEventListener or attachEvent method"),H.addListener=K);var L=[];H.deprecationNotice=n,H.createAliasForDeprecatedMethod=o,I.init=m,I.addInitListener=function(a){I.initialized?a(I):L.push(a)};var M=[];I.addShimListener=function(a){M.push(a)},G&&(I.shim=I.createMissingNativeApi=p,o(I,"createMissingNativeApi","shim")),q.prototype={init:function(){for(var a,b,c=this.dependencies||[],d=0,e=c.length;e>d;++d){if(b=c[d],a=F[b],!(a&&a instanceof q))throw new Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw new Error("required module '"+b+"' not supported")}this.initializer(this)},fail:function(a){throw this.initialized=!0,this.supported=!1,new Error(a)},warn:function(a){I.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){I.warn("DEPRECATED: "+a+" in module "+this.name+" is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},I.createModule=function(a){var b,c;2==arguments.length?(b=arguments[1],c=[]):(b=arguments[2],c=arguments[1]);var d=r(a,c,b);I.initialized&&I.supported&&d.init()},I.createCoreModule=function(a,b,c){r(a,b,c)},I.RangePrototype=s,I.rangePrototype=new s,I.selectionPrototype=new t,I.createCoreModule("DomUtil",[],function(a,b){function c(a){var b;return typeof a.namespaceURI==F||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)++b;return b}function f(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(K(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b){return h(a,b,!0)}function j(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function k(a){var b=a.nodeType;return 3==b||4==b||8==b}function l(a){if(!a)return!1;var b=a.nodeType;return 3==b||8==b}function m(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function n(a,b,c){var d=a.cloneNode(!1);if(d.deleteData(0,b),a.deleteData(b,a.length-b),m(d,a),c)for(var f,g=0;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return d}function o(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=F)return a.ownerDocument;if(typeof a.document!=F)return a.document;if(a.parentNode)return o(a.parentNode);throw b.createError("getDocument: no document found for node")}function p(a){var c=o(a);if(typeof c.defaultView!=F)return c.defaultView;if(typeof c.parentWindow!=F)return c.parentWindow;throw b.createError("Cannot get a window object for node")}function q(a){if(typeof a.contentDocument!=F)return a.contentDocument;if(typeof a.contentWindow!=F)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function r(a){if(typeof a.contentWindow!=F)return a.contentWindow;if(typeof a.contentDocument!=F)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function s(a){return a&&G.isHostMethod(a,"setTimeout")&&G.isHostObject(a,"document")}function t(a,b,c){var d;if(a?G.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):o(a):s(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d}function u(a){for(var b;b=a.parentNode;)a=b;return a}function v(a,c,d,f){var h,i,k,l,m;if(a==d)return c===f?0:f>c?-1:1;if(h=j(d,a,!0))return c<=e(h)?-1:1;if(h=j(a,d,!0))return e(h)<f?-1:1;if(i=g(a,d),!i)throw new Error("comparePoints error: nodes have no common ancestor");if(k=a===i?i:j(a,i,!0),l=d===i?i:j(d,i,!0),k===l)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(m=i.firstChild;m;){if(m===k)return-1;if(m===l)return 1;m=m.nextSibling}}function w(a){var b;try{return b=a.parentNode,!1}catch(c){return!0}}function x(a){if(!a)return"[No node]";if(L&&w(a))return"[Broken node]";if(k(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function y(a){for(var b,c=o(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function z(a,b,c){var d=H(a),e=a.createElement("div");e.contentEditable=""+!!c,b&&(e.innerHTML=b);var f=d.firstChild;return f?d.insertBefore(e,f):d.appendChild(e),e}function A(a){return a.parentNode.removeChild(a)}function B(a){this.root=a,this._next=a}function C(a){return new B(a)}function D(a,b){this.node=a,this.offset=b}function E(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var F="undefined",G=a.util,H=G.getBody;G.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),G.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var I=document.createElement("div");G.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),G.isHostProperty(I,"innerHTML")||b.fail("Element is missing innerHTML property");var J=document.createTextNode("test");G.areHostMethods(J,["splitText","deleteData","insertData","appendData","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!G.areHostProperties(J,["data"]))||b.fail("Incomplete Text Node implementation");var K=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},L=!1;!function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br />",L=w(c),a.features.crashyTextNodes=L}();var M;typeof window.getComputedStyle!=F?M=function(a,b){return p(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=F?M=function(a,b){return a.currentStyle?a.currentStyle[b]:""}:b.fail("No means of obtaining computed style properties found"),B.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},D.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},E.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},E.prototype.toString=function(){return this.message},a.dom={arrayContains:K,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,isOrIsAncestorOf:i,getClosestAncestorIn:j,isCharacterDataNode:k,isTextOrCommentNode:l,insertAfter:m,splitDataNode:n,getDocument:o,getWindow:p,getIframeWindow:r,getIframeDocument:q,getBody:H,isWindow:s,getContentDocument:t,getRootContainer:u,comparePoints:v,isBrokenNode:w,inspectNode:x,getComputedStyleProperty:M,createTestElement:z,removeNode:A,fragmentFromNodeChildren:y,createIterator:C,DomPosition:D},a.DOMException=E}),I.createCoreModule("DomRange",["DomUtil"],function(a){function b(a,b){return 3!=a.nodeType&&(O(a,b.startContainer)||O(a,b.endContainer))}function c(a){return a.document||P(a.startContainer)}function d(a){return V(a.startContainer)}function e(a){return new K(a.parentNode,N(a))}function f(a){return new K(a.parentNode,N(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return M(b)?c==b.length?I.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:R(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a,b,d){if(y(a),y(b),c(b)!=c(a))throw new L("WRONG_DOCUMENT_ERR");var e=Q(a.startContainer,a.startOffset,b.endContainer,b.endOffset),f=Q(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return d?0>=e&&f>=0:0>e&&f>0}function i(a){for(var b,d,e,f=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(e=a.getSubtreeIterator(),d.appendChild(i(e)),e.detach()),10==d.nodeType)throw new L("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function j(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),j(g,b,c),g.detach(),c.stop)return}else for(d=I.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function k(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),k(b),b.detach()):a.remove()}function l(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(l(d)),d.detach()):a.remove(),10==b.nodeType)throw new L("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function m(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return j(new o(a,!1),function(b){if(!(e&&!d.test(b.nodeType)||f&&!c(b))){var h=a.startContainer;if(b!=h||!M(h)||a.startOffset!=h.length){var i=a.endContainer;b==i&&M(i)&&0==a.endOffset||g.push(b)}}}),g}function n(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+I.inspectNode(a.startContainer)+":"+a.startOffset+", "+I.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function o(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&M(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||M(this.sc)?S(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||M(this.ec)?S(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function p(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,U(a,d))return e;e=e.parentNode}return null}}function q(a,b){if(db(a,b))throw new L("INVALID_NODE_TYPE_ERR")}function r(a,b){if(!U(b,a.nodeType))throw new L("INVALID_NODE_TYPE_ERR")}function s(a,b){if(0>b||b>(M(a)?a.length:a.childNodes.length))throw new L("INDEX_SIZE_ERR")}function t(a,b){if(bb(a,!0)!==bb(b,!0))throw new L("WRONG_DOCUMENT_ERR")}function u(a){if(cb(a,!0))throw new L("NO_MODIFICATION_ALLOWED_ERR")}function v(a,b){if(!a)throw new L(b)}function w(a,b){return b<=(M(a)?a.length:a.childNodes.length)}function x(a){return!!a.startContainer&&!!a.endContainer&&!(W&&(I.isBrokenNode(a.startContainer)||I.isBrokenNode(a.endContainer)))&&V(a.startContainer)==V(a.endContainer)&&w(a.startContainer,a.startOffset)&&w(a.endContainer,a.endOffset)}function y(a){if(!x(a))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+a.inspect()+")")}function z(a,b){y(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,g=c===e;M(e)&&f>0&&f<e.length&&R(e,f,b),M(c)&&d>0&&d<c.length&&(c=R(c,d,b),g?(f-=d,e=c):e==c.parentNode&&f>=N(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function A(a){y(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function B(a){a.START_TO_START=jb,a.START_TO_END=kb,a.END_TO_END=lb,a.END_TO_START=mb,a.NODE_BEFORE=nb,a.NODE_AFTER=ob,a.NODE_BEFORE_AND_AFTER=pb,a.NODE_INSIDE=qb}function C(a){B(a),B(a.prototype)}function D(a,b){return function(){y(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,i=new o(this,!0);e!==h&&(c=S(e,h,!0),d=f(c),e=d.node,g=d.offset),j(i,u),i.reset();var k=a(i);return i.detach(),b(this,e,g,e,g),k}}function E(c,d){function g(a,b){return function(c){r(c,Y),r(V(c),Z);var d=(a?e:f)(c);(b?h:i)(this,d.node,d.offset)}}function h(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((V(b)!=V(e)||1==Q(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function i(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((V(b)!=V(e)||-1==Q(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}var j=function(){};j.prototype=a.rangePrototype,c.prototype=new j,J.extend(c.prototype,{setStart:function(a,b){q(a,!0),s(a,b),h(this,a,b)},setEnd:function(a,b){q(a,!0),s(a,b),i(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],e=b,f=c;switch(a.length){case 3:f=a[2];break;case 4:e=a[2],f=a[3]}d(this,b,c,e,f)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){y(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){q(a,!0),d(this,a,0,a,T(a))},selectNode:function(a){q(a,!1),r(a,Y);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:D(l,d),deleteContents:D(k,d),canSurroundContents:function(){y(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},splitBoundaries:function(){z(this)},splitBoundariesPreservingPositions:function(a){z(this,a)},normalizeBoundaries:function(){y(this);var a,b=this.startContainer,c=this.startOffset,e=this.endContainer,f=this.endOffset,g=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(e=a,f=a.length,a.appendData(b.data),X(b))},h=function(a){var d=a.previousSibling;if(d&&d.nodeType==a.nodeType){b=a;var g=a.length;if(c=d.length,a.insertData(0,d.data),X(d),b==e)f+=c,e=b;else if(e==a.parentNode){var h=N(a);f==h?(e=a,f=g):f>h&&f--}}},i=!0;if(M(e))f==e.length?g(e):0==f&&(a=e.previousSibling,a&&a.nodeType==e.nodeType&&(f=a.length,b==e&&(i=!1),a.appendData(e.data),X(e),e=a));else{if(f>0){var j=e.childNodes[f-1];j&&M(j)&&g(j)}i=!this.collapsed}if(i){if(M(b))0==c?h(b):c==b.length&&(a=b.nextSibling,a&&a.nodeType==b.nodeType&&(e==a&&(e=b,f+=b.length),b.appendData(a.data),X(a)));else if(c<b.childNodes.length){var k=b.childNodes[c];k&&M(k)&&h(k)}}else b=e,c=f;d(this,b,c,e,f)},collapseToPoint:function(a,b){q(a,!0),s(a,b),this.setStartAndEnd(a,b)}}),C(c)}function F(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:I.getCommonAncestor(a.startContainer,a.endContainer)}function G(a,b,c,d,e){a.startContainer=b,a.startOffset=c,a.endContainer=d,a.endOffset=e,a.document=I.getDocument(b),F(a)}function H(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,F(this)}var I=a.dom,J=a.util,K=I.DomPosition,L=a.DOMException,M=I.isCharacterDataNode,N=I.getNodeIndex,O=I.isOrIsAncestorOf,P=I.getDocument,Q=I.comparePoints,R=I.splitDataNode,S=I.getClosestAncestorIn,T=I.getNodeLength,U=I.arrayContains,V=I.getRootContainer,W=a.features.crashyTextNodes,X=I.removeNode;o.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,M(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!M(c)||c!==this.sc&&c!==this.ec?c.parentNode&&X(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return b(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new H(c(this.range));var b=this._current,d=b,e=0,f=b,g=T(b);O(b,this.sc)&&(d=this.sc,e=this.so),O(b,this.ec)&&(f=this.ec,g=this.eo),G(a,d,e,f,g)}return new o(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var Y=[1,3,4,5,7,8,10],Z=[2,9,11],$=[5,6,10,12],_=[1,3,4,5,7,8,10,11],ab=[1,3,4,5,7,8],bb=p([9,11]),cb=p($),db=p([6,10,12]),eb=document.createElement("style"),fb=!1;try{eb.innerHTML="<b>x</b>",fb=3==eb.firstChild.nodeType}catch(gb){}a.features.htmlParsingConforms=fb;var hb=fb?function(a){var b=this.startContainer,c=P(b);if(!b)throw new L("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:M(b)&&(d=I.parentElement(b)),d=null===d||"HTML"==d.nodeName&&I.isHtmlNamespace(P(d).documentElement)&&I.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,I.fragmentFromNodeChildren(d)}:function(a){var b=c(this),d=b.createElement("body");return d.innerHTML=a,I.fragmentFromNodeChildren(d)},ib=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],jb=0,kb=1,lb=2,mb=3,nb=0,ob=1,pb=2,qb=3;J.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){y(this),t(this.startContainer,b.startContainer);var c,d,e,f,g=a==mb||a==jb?"start":"end",h=a==kb||a==jb?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],Q(c,d,e,f)},insertNode:function(a){if(y(this),r(a,_),u(this.startContainer),O(a,this.startContainer))throw new L("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){y(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&M(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;var d=new o(this,!0);return a=i(d),d.detach(),a},canSurroundContents:function(){y(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(r(a,ab),!this.canSurroundContents())throw new L("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){y(this);for(var a,b=new H(c(this)),d=ib.length;d--;)a=ib[d],b[a]=this[a];return b},toString:function(){y(this);var a=this.startContainer;if(a===this.endContainer&&M(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new o(this,!0);return j(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){y(this);var b=a.parentNode,c=N(a);if(!b)throw new L("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?pb:nb:e>0?ob:qb},comparePoint:function(a,b){return y(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)<0?-1:Q(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:hb,toHtml:function(){return A(this)},intersectsNode:function(a,b){if(y(this),V(a)!=d(this))return!1;var c=a.parentNode,e=N(a);if(!c)return!0;var f=Q(c,e,this.endContainer,this.endOffset),g=Q(c,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return y(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)>=0&&Q(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=Q(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=Q(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==Q(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==Q(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new L("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==qb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,T(a))<=0},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();return b.setEnd(d,d.length),this.containsRange(b)}return this.containsNodeContents(a)},getNodes:function(a,b){return y(this),m(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var d=c(this),e=a.createRange(d);b=b||I.getBody(d),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);for(var d,e,f,g,h=[b],i=!1,j=!1;!j&&(d=h.pop());)if(3==d.nodeType)e=c+d.length,!i&&a.start>=c&&a.start<=e&&(this.setStart(d,a.start-c),i=!0),i&&a.end>=c&&a.end<=e&&(this.setEnd(d,a.end-c),j=!0),c=e;else for(g=d.childNodes,f=g.length;f--;)h.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return H.rangesEqual(this,a)},isValid:function(){return x(this)},inspect:function(){return n(this)},detach:function(){}}),E(H,G),J.extend(H,{rangeProperties:ib,RangeIterator:o,copyComparisonConstants:C,createPrototypeRange:E,inspect:n,toHtml:A,getRangeDocument:c,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=H}),I.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;if(a.features.implementsDomRange&&!function(){function d(a){for(var b,c=m.length;c--;)b=m[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function g(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);(f||g||h)&&(a.setEnd(d,e),a.setStart(b,c))}var k,l,m=h.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,d(this)},h.createPrototypeRange(c,g),k=c.prototype,k.selectNode=function(a){this.nativeRange.selectNode(a),d(this)},k.cloneContents=function(){return this.nativeRange.cloneContents()},k.surroundContents=function(a){this.nativeRange.surroundContents(a),d(this)},k.collapse=function(a){this.nativeRange.collapse(a),d(this)},k.cloneRange=function(){return new c(this.nativeRange.cloneRange())},k.refresh=function(){d(this)},k.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");i(document).appendChild(n);var o=document.createRange();o.setStart(n,0),o.setEnd(n,0);try{o.setStart(n,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b),d(this)},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b),d(this)},l=function(a){return function(b){this.nativeRange[a](b),d(this)}}}catch(p){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}d(this)},l=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(e){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}k.setStartBefore=l("setStartBefore","setEndBefore"),k.setStartAfter=l("setStartAfter","setEndAfter"),k.setEndBefore=l("setEndBefore","setStartBefore"),k.setEndAfter=l("setEndAfter","setStartAfter"),k.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},o.selectNodeContents(n),o.setEnd(n,3);var q=document.createRange();q.selectNodeContents(n),q.setEnd(n,4),q.setStart(n,2),k.compareBoundaryPoints=-1==o.compareBoundaryPoints(o.START_TO_END,q)&&1==o.compareBoundaryPoints(o.END_TO_START,q)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var r=document.createElement("div");r.innerHTML="123";var s=r.firstChild,t=i(document);t.appendChild(r),o.setStart(s,1),o.setEnd(s,2),o.deleteContents(),"13"==s.data&&(k.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},k.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a}),t.removeChild(r),t=null,f.isHostMethod(o,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(n),k.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return 0==a.compareEndPoints("StartToEnd",a)},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();if(e.isOrIsAncestorOf(b,i)||(i=b),!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&e.removeNode(l);for(var m,n,o,p,q,r=c?"StartToStart":"StartToEnd",s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;;){if(v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),m=h.compareEndPoints(r,a),0==m||s==u)break;if(-1==m){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}if(q=l.nextSibling,-1==m&&q&&k(q)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(q.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;for(w=x.moveStart("character",y);-1==(m=x.compareEndPoints("StartToEnd",x));)w++,x.moveStart("character",1)}else w=h.text.length;p=new g(q,w)}else n=(d||!c)&&l.previousSibling,o=(d||c)&&l.nextSibling,p=o&&k(o)?new g(o,0):n&&k(n)?new g(n,n.data.length):new g(i,e.getNodeIndex(l));return e.removeNode(l),{boundaryPosition:p,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f,g,h=a.offset,j=e.getDocument(a.node),l=i(j).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(g=a.node.childNodes,c=h<g.length?g[h]:null,d=a.node),f=j.createElement("span"),f.innerHTML="&#feff;",c?d.insertBefore(f,c):d.appendChild(f),l.moveToElementText(f),l.collapse(!b),d.removeChild(f),m&&l[b?"moveStart":"moveEnd"]("character",h),l
};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d};if(d.rangeToTextRange=p,d.prototype.toTextRange=function(){return p(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var q=function(a){return a("return this;")()}(Function);"undefined"==typeof q.Range&&(q.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},f.createAliasForDeprecatedMethod(a,"createIframeRange","createRange"),f.createAliasForDeprecatedMethod(a,"createIframeRangyRange","createRangyRange"),a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),I.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof r)return a.win;var d=C.getContentDocument(a,b,c);return C.getWindow(d)}return window}function e(a){return d(a,"getWinSelection").getSelection()}function f(a){return d(a,"getDocSelection").document.selection}function g(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function h(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function i(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function j(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function k(b){var c;return b instanceof F?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof G?c=b.nativeRange:J.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function l(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!C.isAncestorOf(a[0],a[b]))return!1;return!0}function m(a){var c=a.getNodes();if(!l(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function o(a,b){var c=new G(b);a._ranges=[c],h(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function p(b){if(b._ranges.length=0,"None"==b.docSelection.type)j(b);else{var c=b.docSelection.createRange();if(n(c))o(b,c);else{b.rangeCount=c.length;for(var d,e=L(c.item(0)),f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,h(b,b._ranges[b.rangeCount-1],!1)}}}function q(a,c){for(var d=a.docSelection.createRange(),e=m(c),f=L(d.item(0)),g=M(f).createControlRange(),h=0,i=d.length;i>h;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),p(a)}function r(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function s(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function t(a,b){for(var c,d,e=bb.length;e--;)if(c=bb[e],d=c.selection,"deleteAll"==b)s(d);else if(c.win==a)return"delete"==b?(bb.splice(e,1),!0):d;return"deleteAll"==b&&(bb.length=0),null}function u(a,c){for(var d,e=L(c[0].startContainer),f=M(e).createControlRange(),g=0,h=c.length;h>g;++g){d=m(c[g]);try{f.add(d)}catch(i){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}f.select(),p(a)}function v(a,b){if(a.win.document!=L(b))throw new H("WRONG_DOCUMENT_ERR")}function w(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function x(a){var b=[],c=new I(a.anchorNode,a.anchorOffset),d=new I(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=F.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var y,z,A="boolean",B="number",C=a.dom,D=a.util,E=D.isHostMethod,F=a.DomRange,G=a.WrappedRange,H=a.DOMException,I=C.DomPosition,J=a.features,K="Control",L=C.getDocument,M=C.getBody,N=F.rangesEqual,O=E(window,"getSelection"),P=D.isHostObject(document,"selection");J.implementsWinGetSelection=O,J.implementsDocSelection=P;var Q=P&&(!O||a.config.preferTextRange);if(Q)y=f,a.isSelectionValid=function(a){var b=d(a,"isSelectionValid").document,c=b.selection;return"None"!=c.type||L(c.createRange().parentElement())==b};else{if(!O)return b.fail("Neither document.selection or window.getSelection() detected."),!1;y=e,a.isSelectionValid=function(){return!0}}a.getNativeSelection=y;var R=y();if(!R)return b.fail("Native selection was null (possibly issue 138?)"),!1;var S=a.createNativeRange(document),T=M(document),U=D.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=U;var V=E(R,"extend");J.selectionHasExtend=V;var W=typeof R.rangeCount==B;J.selectionHasRangeCount=W;var X=/firefox/i.test(navigator.userAgent)?!0:!1,Y=!0,Z=V?function(b,c){var d=F.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.addRange(k(e)),b.extend(c.startContainer,c.startOffset)}:null;J.selectionSupportsMultipleRanges=X,J.collapsedNonEditableSelectionsSupported=Y;var $,_=!1;T&&E(T,"createControlRange")&&($=T.createControlRange(),D.areHostProperties($,["item","add"])&&(_=!0)),J.implementsControlRange=_,z=U?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ab;E(R,"getRangeAt")?ab=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:U&&(ab=function(b){var c=L(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d}),r.prototype=a.selectionPrototype;var bb=[],cb=function(a){if(a&&a instanceof r)return a.refresh(),a;a=d(a,"getNativeSelection");var b=t(a),c=y(a),e=P?f(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh()):(b=new r(c,e,a),bb.push({win:a,selection:b})),b};a.getSelection=cb,D.createAliasForDeprecatedMethod(a,"getIframeSelection","getSelection");var db=r.prototype;if(!Q&&U&&D.areHostMethods(R,["removeAllRanges","addRange"])){db.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),j(this)};var eb=function(a,b){Z(a.nativeSelection,b),a.refresh()};db.addRange=W?function(b,d){if(_&&P&&this.docSelection.type==K)q(this,b);else if(c(d)&&V)eb(this,b);else{var e;X?e=this.rangeCount:(this.removeAllRanges(),e=0);var f=k(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1){if(a.config.checkSelectionRanges){var i=ab(this.nativeSelection,this.rangeCount-1);i&&!N(i,b)&&(b=new G(i))}this._ranges[this.rangeCount-1]=b,h(this,b,hb(this.nativeSelection)),this.isCollapsed=z(this)}else this.refresh()}}:function(a,b){c(b)&&V?eb(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())},db.setRanges=function(a){if(_&&P&&a.length>1)u(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(E(R,"empty")&&E(S,"select")&&_&&Q))return b.fail("No means of selecting a Range or TextRange was found"),!1;db.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if(this.docSelection.type==K){var b=this.docSelection.createRange();b.length&&(a=L(b.item(0)))}if(a){var c=M(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}j(this)},db.addRange=function(b){this.docSelection.type==K?q(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},db.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?u(this,a):b&&this.addRange(a[0])}}db.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new H("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var fb;if(Q)fb=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=M(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==K?p(b):n(c)?o(b,c):j(b)};else if(E(R,"getRangeAt")&&typeof R.rangeCount==B)fb=function(b){if(_&&P&&b.docSelection.type==K)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],hb(b.nativeSelection)),b.isCollapsed=z(b)}else j(b)};else{if(!U||typeof R.isCollapsed!=A||typeof S.collapsed!=A||!J.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;fb=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=ab(c,0),a._ranges=[b],a.rangeCount=1,i(a),a.isCollapsed=z(a)):j(a)}}db.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(fb(this),a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;e--;)if(!N(b[e],this._ranges[e]))return!0;return!1}};var gb=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,e=c.length;e>d;++d)N(b,c[d])||a.addRange(c[d]);a.rangeCount||j(a)};db.removeRange=_&&P?function(a){if(this.docSelection.type==K){for(var b,c=this.docSelection.createRange(),d=m(a),e=L(c.item(0)),f=M(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),p(this)}else gb(this,a)}:function(a){gb(this,a)};var hb;!Q&&U&&J.implementsDomRange?(hb=g,db.isBackward=function(){return hb(this)}):hb=db.isBackward=function(){return!1},db.isBackwards=db.isBackward,db.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},db.collapse=function(b,c){v(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},db.collapseToStart=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},db.collapseToEnd=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},db.selectAllChildren=function(b){v(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.setSingleRange(c)},db.deleteFromDocument=function(){if(_&&P&&this.docSelection.type==K){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),C.removeNode(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}}},db.eachRange=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(a(this.getRangeAt(c)))return b},db.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},db.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},db.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b||[]))}),c},db.setStart=w(!0),db.setEnd=w(!1),a.rangePrototype.select=function(a){cb(this.getDocument()).setSingleRange(this,a)},db.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)},db.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1},db.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},db.moveToBookmark=function(b){for(var c,d,e=[],f=0;c=b.rangeBookmarks[f++];)d=a.createRange(this.win),d.moveToBookmark(c),e.push(d);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)},db.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},db.restoreRanges=function(a){this.removeAllRanges();for(var b,c=0;b=a.ranges[c];++c)this.addRange(b,a.backward&&0==c)},db.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(F.toHtml(b))}),a.join("")},J.implementsTextRange&&(db.getNativeTextRange=function(){var c;if(c=this.docSelection){var d=c.createRange();if(n(d))return d;throw b.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range")}),db.getName=function(){return"WrappedSelection"},db.inspect=function(){return x(this)},db.detach=function(){t(this.win,"delete"),s(this)},r.detachAll=function(){t(null,"deleteAll")},r.inspect=x,r.isDirectionBackward=c,a.Selection=r,a.selectionPrototype=db,a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return cb(a)}),a=null})});var N=!1,O=function(){N||(N=!0,!I.initialized&&I.config.autoInitialize&&m())};G&&("complete"==document.readyState?O():(b(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",O,!1),K(window,"load",O))),a.rangy=I}(this),function(a){return a.createModule("SaveRestore",["WrappedRange"],function(a,b){function c(a,b){return(b||document).getElementById(a)}function d(a,b){var c,d="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),e=o.getDocument(a.startContainer),f=a.cloneRange();return f.collapse(b),c=e.createElement("span"),c.id=d,c.style.lineHeight="0",c.style.display="none",c.className="rangySelectionBoundary",c.appendChild(e.createTextNode(r)),f.insertNode(c),c}function e(a,d,e,f){var g=c(e,a);g?(d[f?"setStartBefore":"setEndBefore"](g),p(g)):b.warn("Marker element has been removed. Cannot restore selection.")}function f(a,b){return b.compareBoundaryPoints(a.START_TO_START,a)}function g(b,c){var e,f,g=a.DomRange.getRangeDocument(b),h=b.toString(),i=q(c);return b.collapsed?(f=d(b,!1),{document:g,markerId:f.id,collapsed:!0}):(f=d(b,!1),e=d(b,!0),{document:g,startMarkerId:e.id,endMarkerId:f.id,collapsed:!1,backward:i,toString:function(){return"original text: '"+h+"', new text: '"+b.toString()+"'"}})}function h(d,f){var g=d.document;"undefined"==typeof f&&(f=!0);var h=a.createRange(g);if(d.collapsed){var i=c(d.markerId,g);if(i){i.style.display="inline";var j=i.previousSibling;j&&3==j.nodeType?(p(i),h.collapseToPoint(j,j.length)):(h.collapseBefore(i),p(i))}else b.warn("Marker element has been removed. Cannot restore selection.")}else e(g,h,d.startMarkerId,!0),e(g,h,d.endMarkerId,!1);return f&&h.normalizeBoundaries(),h}function i(b,d){var e,h,i=[],j=q(d);b=b.slice(0),b.sort(f);for(var k=0,l=b.length;l>k;++k)i[k]=g(b[k],j);for(k=l-1;k>=0;--k)e=b[k],h=a.DomRange.getRangeDocument(e),e.collapsed?e.collapseAfter(c(i[k].markerId,h)):(e.setEndBefore(c(i[k].endMarkerId,h)),e.setStartAfter(c(i[k].startMarkerId,h)));return i}function j(c){if(!a.isSelectionValid(c))return b.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var d=a.getSelection(c),e=d.getAllRanges(),f=1==e.length&&d.isBackward(),g=i(e,f);return f?d.setSingleRange(e[0],f):d.setRanges(e),{win:c,rangeInfos:g,restored:!1}}function k(a){for(var b=[],c=a.length,d=c-1;d>=0;d--)b[d]=h(a[d],!0);return b}function l(b,c){if(!b.restored){var d=b.rangeInfos,e=a.getSelection(b.win),f=k(d),g=d.length;1==g&&c&&a.features.selectionHasExtend&&d[0].backward?(e.removeAllRanges(),e.addRange(f[0],!0)):e.setRanges(f),b.restored=!0}}function m(a,b){var d=c(b,a);d&&p(d)}function n(a){for(var b,c=a.rangeInfos,d=0,e=c.length;e>d;++d)b=c[d],b.collapsed?m(a.doc,b.markerId):(m(a.doc,b.startMarkerId),m(a.doc,b.endMarkerId))}var o=a.dom,p=o.removeNode,q=a.Selection.isDirectionBackward,r="﻿";a.util.extend(a,{saveRange:g,restoreRange:h,saveRanges:i,restoreRanges:k,saveSelection:j,restoreSelection:l,removeMarkerElement:m,removeMarkers:n})}),a}(this.rangy),function(a){return a.createModule("TextRange",["WrappedSelection"],function(a,b){function c(a,b){function c(a,b,c){h.push({start:a,end:b,isWord:c})}for(var d,e,f,g=a.join(""),h=[],i=0;d=b.wordRegex.exec(g);){if(e=d.index,f=e+d[0].length,e>i&&c(i,e,!1),b.includeTrailingSpace)for(;_.test(a[f]);)++f;c(e,f,!0),i=f}return i<a.length&&c(i,a.length,!1),h}function d(a,b){for(var c=a.slice(b.start,b.end),d={isWord:b.isWord,chars:c,toString:function(){return c.join("")}},e=0,f=c.length;f>e;++e)c[e].token=d;return d}function e(a,b,c){for(var e,f=c(a,b),g=[],h=0;e=f[h++];)g.push(d(a,e));return g}function f(a){var b=a||"",c="string"==typeof b?b.split(""):b;return c.sort(function(a,b){return a.charCodeAt(0)-b.charCodeAt(0)}),c.join("").replace(/(.)\1+/g,"$1")}function g(a){var b,c;return a?(b=a.language||ab,c={},V(c,hb[b]||hb[ab]),V(c,a),c):hb[ab]}function h(a,b){var c=W(a,b);return b.hasOwnProperty("wordOptions")&&(c.wordOptions=g(c.wordOptions)),b.hasOwnProperty("characterOptions")&&(c.characterOptions=W(c.characterOptions,fb)),c}function i(a,b){var c=mb(a,"display",b),d=a.tagName.toLowerCase();return"block"==c&&P&&nb.hasOwnProperty(d)?nb[d]:c}function j(a){for(var b=o(a),c=0,d=b.length;d>c;++c)if(1==b[c].nodeType&&"none"==i(b[c]))return!0;return!1}function k(a){var b;return 3==a.nodeType&&(b=a.parentNode)&&"hidden"==mb(b,"visibility")}function l(a){return a&&(1==a.nodeType&&!/^(inline(-block|-table)?|none)$/.test(i(a))||9==a.nodeType||11==a.nodeType)}function m(a){return T.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function n(a){for(var b=[];a.parentNode;)b.unshift(a.parentNode),a=a.parentNode;return b}function o(a){return n(a).concat([a])}function p(a){for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null}function q(a,b){return!b&&a.hasChildNodes()?a.firstChild:p(a)}function r(a){var b=a.previousSibling;if(b){for(a=b;a.hasChildNodes();)a=a.lastChild;return a}var c=a.parentNode;return c&&1==c.nodeType?c:null}function s(a){if(!a||3!=a.nodeType)return!1;var b=a.data;if(""===b)return!0;var c=a.parentNode;if(!c||1!=c.nodeType)return!1;var d=mb(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&"pre-line"==d}function t(a){if(""===a.data)return!0;if(!s(a))return!1;var b=a.parentNode;return b?j(a)?!0:!1:!0}function u(a){var b=a.nodeType;return 7==b||8==b||j(a)||/^(script|style)$/i.test(a.nodeName)||k(a)||t(a)}function v(a,b){var c=a.nodeType;return 7==c||8==c||1==c&&"none"==i(a,b)}function w(){this.store={}}function x(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return ob++,e[a];pb++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function y(a,b){this.node=a,this.session=b,this.cache=new w,this.positions=new w}function z(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new w}function A(){return"[Position("+T.inspectNode(this.node)+":"+this.offset+")]"}function B(){return D(),Cb=new Db}function C(){return Cb||B()}function D(){Cb&&Cb.detach(),Cb=null}function E(a,c,d,e){function f(){var a=null;return c?(a=h,i||(h=h.previousVisible(),i=!h||d&&h.equals(d))):i||(a=h=h.nextVisible(),i=!h||d&&h.equals(d)),i&&(h=null),a}d&&(c?u(d.node)&&(d=a.previousVisible()):u(d.node)&&(d=d.nextVisible()));var g,h=a,i=!1,j=!1;return{next:function(){if(j)return j=!1,g;for(var a,b;a=f();)if(b=a.getCharacter(e))return g=a,a;return null},rewind:function(){if(!g)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function F(a,b,c){function d(a){for(var b,c,d=[],e=a?f:g,h=!1,i=!1;b=e.next();){if(c=b.character,$.test(c))i&&(i=!1,h=!0);else{if(h){e.rewind();break}i=!0}d.push(b)}return d}var f=E(a,!1,null,b),g=E(a,!0,null,b),h=c.tokenizer,i=d(!0),j=d(!1).reverse(),k=e(j.concat(i),c,h),l=i.length?k.slice(Eb(k,i[0].token)):[],m=j.length?k.slice(0,Eb(k,j.pop().token)+1):[];return{nextEndToken:function(){for(var a,b;1==l.length&&!(a=l[0]).isWord&&(b=d(!0)).length>0;)l=e(a.chars.concat(b),c,h);return l.shift()},previousStartToken:function(){for(var a,b;1==m.length&&!(a=m[0]).isWord&&(b=d(!1)).length>0;)m=e(b.reverse().concat(a.chars),c,h);return m.pop()},dispose:function(){f.dispose(),g.dispose(),l=m=null}}}function G(a,b,c,d,e){var f,g,h,i,j=0,k=a,l=Math.abs(c);if(0!==c){var m=0>c;switch(b){case R:for(g=E(a,m,null,d);(f=g.next())&&l>j;)++j,k=f;h=f,g.dispose();break;case S:for(var n=F(a,d,e),o=m?n.previousStartToken:n.nextEndToken;(i=o())&&l>j;)i.isWord&&(++j,k=m?i.chars[0]:i.chars[i.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}m?(k=k.previousVisible(),j=-j):k&&k.isLeadingSpace&&!k.isTrailingSpace&&(b==S&&(g=E(a,!1,null,d),h=g.next(),g.dispose()),h&&(k=h.previousVisible()))}return{position:k,unitsMoved:j}}function H(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return E(g,!!d,h,c)}function I(a,b,c){for(var d,e=[],f=H(a,b,c);d=f.next();)e.push(d);return f.dispose(),e}function J(b,c,d){var e=a.createRange(b.node);return e.setStartAndEnd(b.node,b.offset,c.node,c.offset),!e.expand("word",{wordOptions:d})}function K(a,b,c,d,e){function f(a,b){var c=p[a].previousVisible(),d=p[b-1],f=!e.wholeWordsOnly||J(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}for(var g,h,i,j,k,l,m=bb(e.direction),n=E(a,m,a.session.getRangeBoundaryPosition(d,m),e.characterOptions),o="",p=[],q=null;g=n.next();)if(h=g.character,c||e.caseSensitive||(h=h.toLowerCase()),m?(p.unshift(g),o=h+o):(p.push(g),o+=h),c){if(k=b.exec(o))if(i=k.index,j=i+k[0].length,l){if(!m&&j<o.length||m&&i>0){q=f(i,j);break}}else l=!0}else if(-1!=(i=o.indexOf(b))){q=f(i,i+b.length);break}return l&&(q=f(i,j)),n.dispose(),q}function L(a){return function(){var b=!!Cb,c=C(),d=[c].concat(U.toArray(arguments)),e=a.apply(this,d);return b||D(),e}}function M(a,b){return L(function(c,d,e,f){typeof e==Q&&(e=d,d=R),f=h(f,jb);var g=a;b&&(g=e>=0,this.collapse(!g));var i=G(c.getRangeBoundaryPosition(this,g),d,e,f.characterOptions,f.wordOptions),j=i.position;return this[g?"setStart":"setEnd"](j.node,j.offset),i.unitsMoved})}function N(a){return L(function(b,c){c=W(c,fb);for(var d,e=H(b,this,c,!a),f=0;(d=e.next())&&$.test(d.character);)++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function O(a){return L(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}var P,Q="undefined",R="character",S="word",T=a.dom,U=a.util,V=U.extend,W=U.createOptions,X=T.getBody,Y=/^[ \t\f\r\n]+$/,Z=/^[ \t\f\r]+$/,$=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,_=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,ab="en",bb=a.Selection.isDirectionBackward,cb=(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?!0:!1,!1),db=!1,eb=!0,fb={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},gb={includeBlockContentTrailingSpace:!eb,includeSpaceBeforeBr:!cb,includeSpaceBeforeBlock:!db,includePreLineTrailingSpace:!0},hb={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:c}},ib={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},jb={wordOptions:null,characterOptions:null},kb={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},lb={wordOptions:null,characterOptions:null,direction:"forward"},mb=T.getComputedStyleProperty;!function(){var a=document.createElement("table"),b=X(document);b.appendChild(a),P="block"==mb(a,"display"),b.removeChild(a)}();var nb={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};w.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var ob=0,pb=0,qb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new z(this,a))},toString:function(){return"[NodeWrapper("+T.inspectNode(this.node)+")]"}};y.prototype=qb;var rb="EMPTY",sb="NON_SPACE",tb="UNCOLLAPSIBLE_SPACE",ub="COLLAPSIBLE_SPACE",vb="TRAILING_SPACE_BEFORE_BLOCK",wb="TRAILING_SPACE_IN_BLOCK",xb="TRAILING_SPACE_BEFORE_BR",yb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",zb="TRAILING_LINE_BREAK_AFTER_BR",Ab="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";V(qb,{isCharacterDataNode:x("isCharacterDataNode",T.isCharacterDataNode,"node"),getNodeIndex:x("nodeIndex",T.getNodeIndex,"node"),getLength:x("nodeLength",T.getNodeLength,"node"),containsPositions:x("containsPositions",m,"node"),isWhitespace:x("isWhitespace",s,"node"),isCollapsedWhitespace:x("isCollapsedWhitespace",t,"node"),getComputedDisplay:x("computedDisplay",i,"node"),isCollapsed:x("collapsed",u,"node"),isIgnored:x("ignored",v,"node"),next:x("nextPos",q,"node"),previous:x("previous",r,"node"),getTextNodeInfo:x("textNodeInfo",function(a){var b=null,c=!1,d=mb(a.parentNode,"whiteSpace"),e="pre-line"==d;return e?(b=Z,c=!0):("normal"==d||"nowrap"==d)&&(b=Y,c=!0),{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:x("hasInnerText",function(a,b){for(var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;f!==g;){if(f.prepopulateChar(),f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),isRenderedBlock:x("isRenderedBlock",function(a){for(var b=a.getElementsByTagName("br"),c=0,d=b.length;d>c;++c)if(!u(b[c]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:x("trailingSpace",function(a){if("br"==a.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var b=a.lastChild;b;){if(!v(b))return 1==b.nodeType?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:x("leadingSpace",function(){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var Bb={character:"",characterType:rb,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=rb,f=!1;if(c>0)if(3==b.nodeType){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&"\n"===g.charAt(c)?(d=" ",e=yb):(d=" ",e=ub)):(d=h,e=sb,f=!0):(d=h,e=tb,f=!0)}else{var k=b.childNodes[c-1];if(k&&1==k.nodeType&&!u(k)&&("br"==k.tagName.toLowerCase()?(d="\n",a.isBr=!0,e=ub,f=!1):a.checkForTrailingSpace=!0),!d){var l=b.childNodes[c];l&&1==l.nodeType&&!u(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==sb||a==tb},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=ub),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=ub),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){for(var b,c=this;c=c.previousVisible();)if(b=c.getCharacter(a),""!==b)return c;return null},getCharacter:function(a){function b(){return n||(k=o.getPrecedingUncollapsedPosition(a),n=!0),k}this.resolveLeadingAndTrailingSpaces();var c,d=this.character,e=f(a.ignoreCharacters),g=""!==d&&e.indexOf(d)>-1;if(this.isCharInvariant)return c=g?"":d;var h=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace,e].join("_"),i=this.cache.get(h);if(null!==i)return i;var j,k,l="",m=this.characterType==ub,n=!1,o=this;return m&&(this.type==Ab?l="\n":" "==d&&(!b()||k.isTrailingSpace||"\n"==k.character||" "==k.character&&k.characterType==ub)||("\n"==d&&this.isLeadingSpace?b()&&"\n"!=k.character&&(l="\n"):(j=this.nextUncollapsed(),j&&(j.isBr?this.type=xb:j.isTrailingSpace&&"\n"==j.character?this.type=wb:j.isLeadingSpace&&"\n"==j.character&&(this.type=vb),"\n"==j.character?(this.type!=xb||a.includeSpaceBeforeBr)&&(this.type!=vb||a.includeSpaceBeforeBlock)&&(this.type==wb&&j.isTrailingSpace&&!a.includeBlockContentTrailingSpace||(this.type!=yb||j.type!=sb||a.includePreLineTrailingSpace)&&("\n"==d?j.isTrailingSpace?this.isTrailingSpace||this.isBr&&(j.type=zb,b()&&k.isLeadingSpace&&!k.isTrailingSpace&&"\n"==k.character?j.character="":j.type=Ab):l="\n":" "==d&&(l=" "))):l=d)))),e.indexOf(l)>-1&&(l=""),this.cache.set(h,l),l},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:A,toString:function(){return this.character}};z.prototype=Bb,V(Bb,{next:x("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:x("previous",function(a){var b,c,d,e=a.nodeWrapper,f=a.node,g=a.offset,h=e.session;return 0==g?(b=f.parentNode,c=b?e.getNodeIndex():0):e.isCharacterDataNode()?(b=f,c=g-1):(d=f.childNodes[g-1],h.getNodeWrapper(d).containsPositions()?(b=d,c=T.getNodeLength(d)):(b=f,c=g-1)),b?h.getPosition(b,c):null}),nextVisible:x("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:x("nextUncollapsed",function(a){for(var b=a;b=b.nextVisible();)if(b.resolveLeadingAndTrailingSpaces(),""!==b.character)return b;return null}),previousVisible:x("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var Cb=null,Db=function(){function a(a){var b=new w;
return{get:function(c){var d=b.get(c[a]);if(d)for(var e,f=0;e=d[f++];)if(e.node===c)return e;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function b(){this.initCaches()}var c=U.isHostProperty(document.documentElement,"uniqueID");return b.prototype={initCaches:function(){this.elementCache=c?function(){var a=new w;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new y(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},b}();V(T,{nextNode:q,previousNode:r});var Eb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;d>c;++c)if(a[c]===b)return c;return-1};V(a.rangePrototype,{moveStart:M(!0,!1),moveEnd:M(!1,!1),move:M(!0,!0),trimStart:N(!0),trimEnd:N(!1),trim:L(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:L(function(a,b,c){var d=!1;c=h(c,kb);var e=c.characterOptions;if(b||(b=R),b==S){var f,g,i=c.wordOptions,j=a.getRangeBoundaryPosition(this,!0),k=a.getRangeBoundaryPosition(this,!1),l=F(j,e,i),m=l.nextEndToken(),n=m.chars[0].previousVisible();if(this.collapsed)f=m;else{var o=F(k,e,i);f=o.previousStartToken()}return g=f.chars[f.chars.length-1],n.equals(j)||(this.setStart(n.node,n.offset),d=!0),g&&!g.equals(k)&&(this.setEnd(g.node,g.offset),d=!0),c.trim&&(c.trimStart&&(d=this.trimStart(e)||d),c.trimEnd&&(d=this.trimEnd(e)||d)),d}return this.moveEnd(R,1,c)}),text:L(function(a,b){return this.collapsed?"":I(a,this,W(b,fb)).join("")}),selectCharacters:L(function(a,b,c,d,e){var f={characterOptions:e};b||(b=X(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:L(function(a,b,c){b||(b=X(this.getDocument()));var d,e,f=b.parentNode,g=T.getNodeIndex(b),h=-1==T.comparePoints(this.startContainer,this.endContainer,f,g),i=this.cloneRange();return h?(i.setStartAndEnd(this.startContainer,this.startOffset,f,g),d=-i.text(c).length):(i.setStartAndEnd(f,g,this.startContainer,this.startOffset),d=i.text(c).length),e=d+this.text(c).length,{start:d,end:e}}),findText:L(function(b,c,d){d=h(d,ib),d.wholeWordsOnly&&(d.wordOptions.includeTrailingSpace=!1);var e=bb(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,i=!1;"string"==typeof g?d.caseSensitive||(g=g.toLowerCase()):i=!0;var j=b.getRangeBoundaryPosition(this,!e),k=f.comparePoint(j.node,j.offset);-1===k?j=b.getRangeBoundaryPosition(f,!0):1===k&&(j=b.getRangeBoundaryPosition(f,!1));for(var l,m=j,n=!1;;)if(l=K(m,g,i,f,d)){if(l.valid)return this.setStartAndEnd(l.startPos.node,l.startPos.offset,l.endPos.node,l.endPos.offset),!0;m=e?l.startPos:l.endPos}else{if(!d.wrap||n)return!1;f=f.cloneRange(),m=b.getRangeBoundaryPosition(f,!e),f.setBoundary(j.node,j.offset,e),n=!0}}),pasteHtml:function(a){if(this.deleteContents(),a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),V(a.selectionPrototype,{expand:L(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:L(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=W(d.characterOptions,gb),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:O("trimStart"),trimEnd:O("trimEnd"),trim:O("trim"),selectCharacters:L(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:L(function(a,b,c){for(var d=this.getAllRanges(),e=d.length,f=[],g=1==e&&this.isBackward(),h=0,i=d.length;i>h;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:L(function(b,c,d){this.removeAllRanges();for(var e,f,g,h=0,i=d.length;i>h;++h)f=d[h],g=f.characterRange,e=a.createRange(c),e.selectCharacters(c,g.start,g.end,f.characterOptions),this.addRange(e,f.backward)}),text:L(function(a,b){for(var c=[],d=0,e=this.rangeCount;e>d;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return e},a.createWordIterator=function(a,b,c){var d=C();c=h(c,lb);var e=d.getPosition(a,b),f=F(e,c.characterOptions,c.wordOptions),g=bb(c.direction);return{next:function(){return g?f.previousStartToken():f.nextEndToken()},dispose:function(){f.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=C();a(b),D()},a.noMutation.createEntryPointFunction=L,a.textRange={isBlockNode:l,isCollapsedWhitespaceNode:t,createPosition:L(function(a,b,c){return a.getPosition(b,c)})}}),a}(this.rangy)},WEBSPELLCHECKER.rangy(),function(global){var _$=window.$,_jquip=window.jquip;window.$=window.jquip=function(){function a(a,b){for(var c,d=0,e=Pb.length;e>d;d++)if(Pb[d].apply(this,arguments))return this;return a?E(a)?(U?a():bb.push(a),this):F(a)?this.make(a):a.nodeType||H(a)?this.make([a]):"body"==a&&!b&&_.body?(this.context=a.context,this[0]=_.body,this.length=1,this.selector=a,this):void 0!==a.selector?(this.context=a.context,this.selector=a.selector,this.make(a)):(a=C(a)&&"<"===a.charAt(0)?(c=pb.exec(a))?[_.createElement(c[1])]:N(a).childNodes:k(this.selector=a,b),this.make(a),J(b)&&this.attr(b),this):this}function b(b,c){return new a(b,c)}function c(a){return!a||!a.parentNode||11==a.parentNode.nodeType}function d(a,c,d){if(c=c||0,E(c))return v(a,function(a,b){return!!c.call(a,b,a)===d});if(c.nodeType)return v(a,function(a){return a===c===d});if(C(c)){var e=":"==c.charAt(0)&&b.Expr[c.substring(1)];return v(a,function(a){var b,d=a.parentNode,f=!d;return f&&(d=Nb,d.appendChild(a)),b=e?e(a):a.parentNode&&q(k(c,a.parentNode),a)>=0,f&&d.removeChild(a),b})}return v(a,function(a){return q(c,a)>=0===d})}function e(a,b,c){var d=a[Mb];return B(c)?(d||(d=a[Mb]=Rb++),(Sb[d]||(Sb[d]={}))[b]=c):d&&Sb[d]&&(b?Sb[d][b]:Sb[d])}function f(a){if(!Tb[a]){var c=b("<"+a+">").appendTo(_.body),d=b.css&&b.css(c[0],"display")||c[0].style.display;c.remove(),Tb[a]=d}return Tb[a]}function g(a,b){if(a.length=b&&b.length||0,0===a.length)return a;for(var c=0,d=b.length;d>c;c++)a[c]=b[c];return a}function h(a,b){b=" "+b+" ";for(var c=0,d=a.length;d>c;c++)if(i(a[c],b))return!0;return!1}function i(a,b){return 1===a.nodeType&&(" "+a.className+" ").replace(hb," ").indexOf(b)>-1}function j(a,b,c){b=b||_,c=c||[],1==b.nodeType&&a(b)&&c.push(b);for(var d=b.childNodes,e=0,f=d.length;f>e;e++){var g=d[e];1==g.nodeType&&j(a,g,c)}return c}function k(a,c,d){if(a&&C(a)){c instanceof b&&(c=c[0]),c=c||_,d=d||b.query;var e,f=a.substring(1);return jb.test(a)&&c===_?(e=_.getElementById(f))?[e]:[]:M(kb.test(a)&&c.getElementsByClassName?c.getElementsByClassName(f):ib.test(a)?c.getElementsByTagName(a):d(a,c))}return 1==a.nodeType||9==a.nodeType?[a]:[]}function l(a,b,c){var d,e=_.head||_.getElementsByTagName("head")[0]||ab,f=_.createElement("script");c&&(f.async="async"),f.onreadystatechange=function(){(d=f.readyState)&&"loaded"!=d&&"complete"!=d||(f.onload=f.onreadystatechange=null,e&&f.parentNode&&e.removeChild(f),f=void 0,b&&b())},f.onload=b,f.src=a,e.insertBefore(f,e.firstChild)}function m(){Y.console&&Y.console.warn(arguments)}function n(a,b,c){if(null!=a)if(Jb&&a.forEach===Jb)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(d in a&&b.call(c,a[d],d,a)===Cb)return}else for(var f in a)if(Fb.call(a,f)&&b.call(c,a[f],f,a)===Cb)return}function o(a,b){if(a&&a.getAttribute&&b){var c=a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):a[b];return null===c?void 0:c}}function p(a,c){return B(a)?b(c).filter(a):b(c)}function q(a,b){if(null==a)return-1;var c,d;if(Lb&&a.indexOf===Lb)return a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function r(a,b,c){var d=[];return null==a?d:Kb&&a.filter===Kb?a.filter(b,c):(n(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)}function s(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(void 0===d||1!==f.nodeType||!b(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e}function t(a,b,c){b=b||1;for(var d=0;a&&(1!==a.nodeType||++d!==b);a=a[c]);return a}function u(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}function v(a,b,c){var d,e=[];c=!!c;for(var f=0,g=a.length;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e}function w(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof b||"number"==typeof i&&(i>0&&a[0]&&a[i-1]||0===i||F(a));if(j)for(;i>h;h++)e=c(a[h],h,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)}function x(a,b,c){if(!a)return{};var d=e(a,b,c);return d||y(a)["data-"+b]}function y(a){var b={};if(1==a.nodeType)for(var c=0,d=a.attributes,e=d.length;e>c;c++)b[d.item(c).nodeName]=d.item(c).nodeValue;return b}function z(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a==b}function A(a){return null==a?String(a):yb[xb.call(a)]||"object"}function B(a){return void 0!==a}function C(a){return"string"==typeof a}function D(a){return"object"==typeof a}function E(a){return"function"==typeof a||"function"===A(a)}function F(a){return"array"===A(a)}function G(a){return!C(a)&&"number"==typeof a.length}function H(a){return a&&"object"==typeof a&&"setInterval"in a}function I(a){return null==a||!mb.test(a)||isNaN(a)}function J(a){if(!a||"object"!==A(a)||a.nodeType||H(a))return!1;try{if(a.constructor&&!Fb.call(a,"constructor")&&!Fb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;for(c in a);return void 0===c||Fb.call(a,c)}function K(a,b){var c=a.length,d=0;if("number"==typeof b.length)for(var e=b.length;e>d;d++)a[c++]=b[d];else for(;void 0!==b[d];)a[c++]=b[d++];return a.length=c,a}function L(){var a,b,c,d,e,f,g=arguments,h=g[0]||{},i=1,j=g.length,k=!1;for("boolean"==typeof h&&(k=h,h=g[1]||{},i=2),"object"==typeof h||E(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=g[i]))for(b in a)c=h[b],d=a[b],h!==d&&(k&&d&&(J(d)||(e=F(d)))?(e?(e=!1,f=c&&F(c)?c:[]):f=c&&J(c)?c:{},h[b]=L(k,f,d)):void 0!==d&&(h[b]=d));return h}function M(a,b){var c=b||[];if(null!=a){var d=A(a);null==a.length||"string"==d||"function"==d||"regexp"===d||H(a)?Hb.call(c,a):K(c,a)}return c}function N(a,b,c){if(b=b||_||b.ownerDocument||b[0]&&b[0].ownerDocument||_,c=c||b.createDocumentFragment(),G(a))return P(a,b,c)&&c;for(var d=O(a);d.firstChild;)c.appendChild(d.firstChild);return c}function O(a,b){var c=(b||_).createElement("div"),d=(gb.exec(a)||["",""])[1].toLowerCase(),e=Bb[d]||Bb._default,f=e[0];for(c.innerHTML=e[1]+a+e[2];f--;)c=c.lastChild;return c}function P(a,b,c){var d,e,f=[];for(d=0;null!=(e=a[d]);d++)C(e)&&(e=O(e,b)),e.nodeType?f.push(e):f=K(f,e);if(c)for(d=0;d<f.length;d++)f[d].nodeType&&c.appendChild(f[d]);return f}function Q(a){if(X&&(zb=Ab,a.sort(X),zb))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a}function R(){if(!_.body)return null;var a=_.createElement("div");_.body.appendChild(a),a.style.width="20px",a.style.padding="10px";var b=a.offsetWidth;return _.body.removeChild(a),40==b}function S(a,b){cb.push({url:a,cb:b})}function T(){n(bb,function(a){a()}),U=!0}var U,V,W,X,Y=window,Z="http://cdnjs.cloudflare.com/ajax/libs/sizzle/1.4.4/sizzle.min.js",$=function(){return Y.Sizzle||Y.qwery},_=document,ab=_.documentElement,bb=[],cb=[],db=/Until$/,eb=/,/,fb=/^(?:parents|prevUntil|prevAll)/,gb=/<([\w:]+)/,hb=/[\n\t\r]/g,ib=/^[\w-]+$/,jb=/^#[\w-]+$/,kb=/^\.[\w-]+$/,lb=/\s+/,mb=/\d/,nb=/\S/,ob=/\r\n/g,pb=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,qb=/\r?\n/g,rb=/^(?:select|textarea)/i,sb=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,tb=String.prototype.trim,ub=/^\s+/,vb=/\s+$/,wb={children:!0,contents:!0,next:!0,prev:!0},xb=Object.prototype.toString,yb={},zb=!1,Ab=!0,Bb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Cb={},Db=Array.prototype,Eb=Object.prototype,Fb=Eb.hasOwnProperty,Gb=Db.slice,Hb=Db.push,Ib=Db.indexOf,Jb=Db.forEach,Kb=Db.filter,Lb=Db.indexOf,Mb="jq-"+ +new Date,Nb=_.createElement("p");nb.test(" ")&&(ub=/^[\s\xA0]+/,vb=/[\s\xA0]+$/);var Ob,Pb=[],Qb={},Rb=1,Sb={_id:0},Tb={};Ob=a.prototype=b.prototype=b.fn={constructor:b,selector:"",length:0,dm:function(a,b,c){var d,e,f,g,h,i=a[0];if(i&&this[0]){if(!(e=(1===i.nodeType||3===i.nodeType)&&i)&&(d=i&&i.parentNode,e=d&&11===d.nodeType&&d.childNodes.length===this.length?d:N(i),f=e.firstChild,1===e.childNodes.length&&(e=f),!f))return this;for(h=0,g=this.length;g>h;h++)c.call(this[h],0==h?e:e.cloneNode(!0))}return this},ps:function(a,b,c){var d=this.constructor();return F(a)?Hb.apply(d,a):K(d,a),d.prevObject=this,d.context=this.context,"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d}},Ob.make=function(a){return g(this,a),this},Ob.toArray=function(){return Gb.call(this,0)},Ob.get=function(a){return B(a)?0>a?this[this.length+a]:this[a]:this.toArray()},Ob.add=function(a,d){var e="string"==typeof a?b(a,d):M(a&&a.nodeType?[a]:a),f=K(this.get(),e);return this.ps(c(e[0])||c(f[0])?f:Q(f))},Ob.each=function(a){if(!E(a))return this;for(var b=0,c=this.length;c>b&&a.call(this[b],b,this[b])!==!1;b++);return this},Ob.attr=function(a,b){var c=this[0];return C(a)&&void 0===b?o(c,a):this.each(function(c){var d=this.nodeType;if(3!==d&&8!==d&&2!==d)if(D(a))for(var e in a)null===b?this.removeAttribute(a):this.setAttribute(e,a[e]);else this.setAttribute(a,E(b)?b.call(this,c,this.getAttribute(a)):b)})},Ob.removeAttr=function(a){return this.each(function(){1==this.nodeType&&this.removeAttribute(a)})},Ob.data=function(a,b){return void 0===b?x(this[0],a):this.each(function(){x(this,a,b)})},Ob.append=function(){return this.dm(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},Ob.prepend=function(){return this.dm(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},Ob.before=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this)}):this},Ob.after=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)}):this},Ob.replaceWith=function(a){var c=this,d=E(a);return this.each(function(e){var f=this.nextSibling,g=this.parentNode,h=d?a.call(this,e,this):a;g&&11!=g.nodeType?(g.removeChild(this),f?b(f).before(h):b(g).append(h)):c[e]=b(h).clone()[0]})},Ob.hide=function(){return this.each(function(){"none"!=this.style.display&&(e(this,"display",this.style.display),this.style.display="none")})},Ob.show=function(){return this.each(function(){this.style.display=e(this,"display")||f(this.tagName)})},Ob.toggle=function(){return this.each(function(){var a=b(this);b.Expr.hidden(this)?a.show():a.hide()})},Ob.eq=function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},Ob.first=function(){return this.eq(0)},Ob.last=function(){return this.eq(-1)},Ob.slice=function(){return this.ps(Gb.apply(this,arguments),"slice",Gb.call(arguments).join(","))},Ob.map=function(a){return this.ps(w(this,function(b,c){return a.call(b,c,b)}))},Ob.find=function(a){var c,d,e=this;if(!C(a))return b(a).filter(function(){for(c=0,d=e.length;d>c;c++)if(W(e[c],this))return!0});var f,g,h,i=this.ps("","find",a);for(c=0,d=this.length;d>c;c++)if(f=i.length,K(i,b(a,this[c])),0===c)for(g=f;g<i.length;g++)for(h=0;f>h;h++)if(i[h]===i[g]){i.splice(g--,1);break}return i},Ob.not=function(a){return this.ps(d(this,a,!1),"not",a)},Ob.filter=function(a){return this.ps(d(this,a,!0),"filter",a)},Ob.indexOf=function(a){return q(this,a)},Ob.is=function(a){return this.length>0&&b(this[0]).filter(a).length>0},Ob.remove=function(){for(var a,b=0;B(a=this[b]);b++)a.parentNode&&a.parentNode.removeChild(a);return this},Ob.closest=function(a,b){var c,d,e,f=[];for(c=0,d=this.length;d>c;c++)for(e=this[c];e;){if(p(a,[e]).length>0){f.push(e);break}if(e=e.parentNode,!e||!e.ownerDocument||e===b||11===e.nodeType)break}return f=f.length>1?Q(f):f,this.ps(f,"closest",a)},Ob.val=function(a){return B(a)?this.each(function(){this.value=a}):this[0]&&this[0].value||""},Ob.html=function(a){return B(a)?C(a)?this.each(function(){this.innerHTML=a}):this.empty().append(a):this[0]&&this[0].innerHTML||""},Ob.text=function(a){var b,c=this[0];return B(a)?this.empty().append((c&&c.ownerDocument||_).createTextNode(a)):c&&(b=c.nodeType)?1===b||9===b?C(c.textContent)?c.textContent:c.innerText.replace(ob,""):3===b||4===b?c.nodeValue:null:null},Ob.empty=function(){var a,b;for(a=0;B(b=this[a]);a++)for(;b.firstChild;)b.removeChild(b.firstChild);return this},Ob.addClass=function(a){var c,d,e,f,g,h,i;if(E(a))return this.each(function(c){b(this).addClass(a.call(this,c,this.className))});if(a&&C(a))for(c=a.split(lb),d=0,e=this.length;e>d;d++)if(f=this[d],f&&1===f.nodeType)if(f.className||1!==c.length){for(g=" "+f.className+" ",h=0,i=c.length;i>h;h++)~g.indexOf(" "+c[h]+" ")||(g+=c[h]+" ");f.className=V(g)}else f.className=a;return this},Ob.removeClass=function(a){var c,d,e,f,g,h,i;if(E(a))return this.each(function(c){b(this).removeClass(a.call(this,c,this.className))});if(a&&C(a)||void 0===a)for(c=(a||"").split(lb),d=0,e=this.length;e>d;d++)if(f=this[d],1===f.nodeType&&f.className)if(a){for(g=(" "+f.className+" ").replace(hb," "),h=0,i=c.length;i>h;h++)g=g.replace(" "+c[h]+" "," ");f.className=V(g)}else f.className="";return this},Ob.hasClass=function(a){return h(this,a)},Ob.fadeIn=function(){this.each(function(){b(this).show()})},Ob.fadeOut=function(){this.each(function(){b(this).hide()})},Ob.serializeArray=function(){return this.map(function(){return this.elements?M(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rb.test(this.nodeName)||sb.test(this.type))}).map(function(a,c){var d=b(this).val();return null==d||F(d)?w(d,function(a){return{name:c.name,value:a.replace(qb,"\r\n")}}):{name:c.name,value:d.replace(qb,"\r\n")}}).get()},Ob.wrap=function(a){return this.each(function(){var c=b(b(a)[0].cloneNode(!1));b(this).before(c),c.append(b(this))})},Ob.prop=function(a,b){return B(b)?this.each(function(){this[a]=b}):this[0]&&this[0][a]},Ob.clone=function(){return b(this.map(function(){return this.cloneNode(!0)}))},Ob.toggleClass=function(a,c){return this.each(function(){var d=b(this);(B(c)?c:!d.hasClass(a))?d.addClass(a):d.removeClass(a)})},b.Expr={hidden:function(a){return"none"===(b.css&&b.css(a,"display")||a.style.display)},visible:function(a){return!b.Expr.hidden(a)}},b.hasClass=h,b.walk=j,b.$$=k,b.setQuery=function(a){b.query=function(b,c){return k(b,c,a||function(a,b){return b.querySelectorAll(a)})}};var Ub=$();b.setQuery(Ub||function(a,b){return(b=b||_).querySelectorAll?M(b.querySelectorAll(a)):[]}),b.loadScript=l,b.each=function(a,b,c){var d,e=0,f=a.length,g=void 0===f||E(a);if(c)if(g){for(d in a)if(b.apply(a[d],c)===!1)break}else for(;f>e&&b.apply(a[e++],c)!==!1;);else if(g){for(d in a)if(b.call(a[d],d,a[d])===!1)break}else for(;f>e&&b.call(a[e],e,a[e++])!==!1;);return a},b._each=n,b.filter=p,b._indexOf=q,b._defaults=function(a){return n(Gb.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},b._filter=r,b.proxy=function(a,b){if("string"==typeof b){var c=a[b];b=a,a=c}if(E(a)){var d=Gb.call(arguments,2),e=function(){return a.apply(b,d.concat(Gb.call(arguments)))};return e.guid=a.guid=a.guid||e.guid||Rb++,e}},b.dir=s,b.nth=t,b.sibling=u,b.grep=v,b.map=w,b.data=x,b.attrs=y,b.eqSI=z,V=tb?function(a){return null==a?"":tb.call(a)}:function(a){return null==a?"":a.toString().replace(ub,"").replace(vb,"")},b.trim=V,b.indexOf=b.inArray=function(a,b){if(!b)return-1;if(Ib)return Ib.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c;return-1},n("Boolean Number String Function Array Date RegExp Object".split(" "),function(a){return yb["[object "+a+"]"]=a.toLowerCase(),this}),b.type=A,b.isFunction=E,b.isArray=Array.isArray||F,b.isWindow=H,b.isNaN=I,b.merge=K,b.extend=b.fn.extend=L,b.makeArray=M,b.htmlFrag=N;var Vb=function(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1};return W=b.contains=ab.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:function(){return!1},X=ab.compareDocumentPosition?(W=function(a,b){return!!(16&a.compareDocumentPosition(b))})&&function(a,b){return a===b?(zb=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){if(a===b)return zb=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h)return Vb(a,b);if(!g)return-1;if(!h)return 1;for(;i;)e.unshift(i),i=i.parentNode;for(i=h;i;)f.unshift(i),i=i.parentNode;c=e.length,d=f.length;for(var j=0;c>j&&d>j;j++)if(e[j]!==f[j])return Vb(e[j],f[j]);return j===c?Vb(a,f[j],-1):Vb(e[j],b,1)},b.unique=Q,n({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return s(a,"parentNode")},parentsUntil:function(a,b,c){return s(a,"parentNode",c)},next:function(a){return t(a,2,"nextSibling")},prev:function(a){return t(a,2,"previousSibling")},nextAll:function(a){return s(a,"nextSibling")},prevAll:function(a){return s(a,"previousSibling")},nextUntil:function(a,b,c){return s(a,"nextSibling",c)},prevUntil:function(a,b,c){return s(a,"previousSibling",c)},siblings:function(a){return u(a.parentNode.firstChild,a)},children:function(a){return u(a.firstChild)},contents:function(a){return"iframe"===a.nodeName?a.contentDocument||a.contentWindow["document "]:M(a.childNodes)}},function(a,c){b.fn[c]=function(b,d){var e=w(this,a,b),f=Gb.call(arguments);return db.test(c)||(d=b),C(d)&&(e=M(p(d,e))),e=this.length>1&&!wb[c]?Q(e):e,(this.length>1||eb.test(d))&&fb.test(c)&&(e=e.reverse()),this.ps(e,c,f.join(","))}}),n({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after"},function(a,c){b.fn[c]=function(d){var e,f,g,h=[],i=b(d),j=1===this.length&&this[0].parentNode;if(j&&11===j.nodeType&&1===j.childNodes.length&&1===i.length)return i[a](this[0]),this;for(e=0,g=i.length;g>e;e++)f=(e>0?this.clone(!0):this).get(),b(i[e])[a](f),h=h.concat(f);return this.ps(h,c,i.selector)}}),function(){var a=document.createElement("div");a.style.display="none",a.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var c=a.getElementsByTagName("a")[0];b.support={boxModel:null,opacity:/^0.55$/.test(c.style.opacity),cssFloat:!!c.style.cssFloat};var d,e=/(webkit)[ \/]([\w.]+)/,f=/(opera)(?:.*version)?[ \/]([\w.]+)/,g=/(msie) ([\w.]+)/,h=/(mozilla)(?:.*? rv:([\w.]+))?/,i=navigator.userAgent.toLowerCase(),j=e.exec(i)||f.exec(i)||g.exec(i)||i.indexOf("compatible")<0&&h.exec(i)||[];d=b.browser={version:j[2]||"0"},d[j[1]||""]=!0}(),b.scriptsLoaded=function(a){E(a)&&bb.push(a)},b.loadAsync=S,Ub||_.querySelectorAll||S(Z,function(){b.setQuery($())}),b.init=!1,b.onload=function(){if(!b.init)try{b.support.boxModel=R();var a=0;n(cb,function(b){a++,l(b.url,function(){try{b.cb&&b.cb()}catch(c){}--a||T()})}),b.init=!0,a||T()}catch(c){m(c)}},_.body&&!b.init&&setTimeout(b.onload,1),b.hook=function(a){Pb.push(a)},b.plug=function(a,c){var d=C(a)?a:a.name;if(c=E(a)?a:c,!E(c))throw"Plugin fn required";d&&c&&(Qb[d]=c),c(b)},b}(),$.plug("ajax",function($){function _xhr(){if(null!=_xhrf)return _xhrf();for(var a=0,b=xhrs.length;b>a;a++)try{var c=xhrs[a],d=c();if(null!=d)return _xhrf=c,d}catch(e){}return function(){}}function _xhrResp(xhr,dataType){if(dataType=(dataType||xhr.getResponseHeader("Content-Type").split(";")[0]).toLowerCase(),dataType.indexOf("json")>=0){var j=!1;return j=window.JSON?window.JSON.parse(xhr.responseText):eval(xhr.responseText)}return dataType.indexOf("script")>=0?eval(xhr.responseText):dataType.indexOf("xml")>=0?xhr.responseXML:xhr.responseText}function ajax(a,b){var c,d=_xhr(),e=0;"object"==typeof a?b=a:b.url=a,b=$._defaults(b,{userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,contentType:"application/x-www-form-urlencoded",dataType:null,processData:!0,headers:{"X-Requested-With":"XMLHttpRequest"},cache:!0}),b.timeout&&(c=setTimeout(function(){d.abort(),b.timeoutFn&&b.timeoutFn(b.url)},b.timeout));var f=$(b.context||document),g=f;d.onreadystatechange=function(){if(4==d.readyState){if(c&&clearTimeout(c),d.status<300){var a,h=!0,i=b.dataType||"";try{a=_xhrResp(d,i,b)}catch(j){h=!1,b.error&&b.error(d,d.status,d.statusText),g.trigger(f,"ajaxError",[d,d.statusText,b])}b.success&&h&&(i.indexOf("json")>=0||a)&&b.success(a),g.trigger(f,"ajaxSuccess",[d,a,b])}else b.error&&b.error(d,d.status,d.statusText),g.trigger(f,"ajaxError",[d,d.statusText,b]);b.complete&&b.complete(d,d.statusText),g.trigger(f,"ajaxComplete",[d,b])}else b.progress&&b.progress(++e)};var a=b.url,h=null,i=1==b.cache,j="POST"==b.type||"PUT"==b.type;b.data&&b.processData&&"object"==typeof b.data&&(h=$.formData(b.data)),!j&&h&&(a+="?"+h,h=null,i||(a=a+"&_="+(new Date).getTime())),a=a+"?_="+(new Date).getTime(),i=null,d.open(b.type,a);try{for(var k in b.headers)d.setRequestHeader(k,b.headers[k])}catch(l){console.log(l)}j&&(b.contentType.indexOf("json")>=0&&(h=b.data),d.setRequestHeader("Content-Type",b.contentType)),d.send(h)}var xhrs=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")}],_xhrf=null;$.xhr=_xhr,$._xhrResp=_xhrResp,$.formData=function(a){var b=[],c=/%20/g;for(var d in a)b.push(encodeURIComponent(d).replace(c,"+")+"="+encodeURIComponent(a[d].toString()).replace(c,"+"));return b.join("&")},$.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){$.fn[b]=function(a){return this.bind(b,a)}}),$.ajax=ajax,$.getJSON=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,data:b,success:c,dataType:"json"})},$.get=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,type:"GET",data:b,success:c,dataType:d||"text/plain"})},$.post=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,type:"POST",data:b,success:c,dataType:d||"text/plain"})},$.getScript=function(a,b){return $.get(a,void 0,b,"script")},window.JSON||$.loadAsync("http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js")}),$.plug("css",function(a){function b(b,c,e){var f="width"===c?b.offsetWidth:b.offsetHeight,g="width"===c?v:w;return f>0?("border"!==e&&a.each(g,function(){e||(f-=parseFloat(d(b,"padding"+this))||0),"margin"===e?f+=parseFloat(d(b,e+this))||0:f-=parseFloat(d(b,"border"+this+"Width"))||0}),f+"px"):""}function c(b,c,d,e){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var g,h=f(c),i=b.style,j=a.cssHooks[h];if(c=a.cssProps[h]||h,void 0===d)return j&&"get"in j&&void 0!==(g=j.get(b,!1,e))?g:i[c];if(!("number"==typeof d&&isNaN(d)||null==d||("number"!=typeof d||a.cssNumber[h]||(d+="px"),j&&"set"in j&&void 0===(d=j.set(b,d)))))try{i[c]=d}catch(k){}}}function d(b,c,d){var e,g=f(c),h=a.cssHooks[g];return c=a.cssProps[g]||g,h&&"get"in h&&void 0!==(e=h.get(b,!0,d))?e:i?i(b,c,g):void 0}function e(a,b,c){var d,e={};for(var d in b)e[d]=a.style[d],a.style[d]=b[d];c.call(a);for(d in b)a.style[d]=e[d]}function f(a){return a.replace(p,x)}function g(b,c,d,e,f,h){var i=b.length;if("object"==typeof c){for(var j in c)g(b,j,c[j],e,f,d);return b}if(void 0!==d){e=!h&&e&&a.isFunction(d);for(var k=0;i>k;k++)f(b[k],c,e?d.call(b[k],k,f(b[k],c)):d,h);return b}return i?f(b[0],c):void 0}function h(b){return a.isWindow(b)?b:9===b.nodeType?b.defaultView||b.parentWindow:!1}var i,j,k,l=document,m=l.documentElement,n=/alpha\([^)]*\)/i,o=/opacity=([^)]*)/,p=/-([a-z])/gi,q=/([A-Z])/g,r=/^-?\d+(?:px)?$/i,s=/^-?\d/,t=/^(?:body|html)$/i,u={position:"absolute",visibility:"hidden",display:"block"},v=["Left","Right"],w=["Top","Bottom"],x=function(a,b){return b.toUpperCase()};a.cssHooks={opacity:{get:function(a,b){if(!b)return a.style.opacity;var c=i(a,"opacity","opacity");return""===c?"1":c}}},a._each(["height","width"],function(c){a.cssHooks[c]={get:function(a,d,f){var g;return d?0!==a.offsetWidth?b(a,c,f):(e(a,u,function(){g=b(a,c,f)}),g):void 0},set:function(a,b){return r.test(b)?(b=parseFloat(b),b>=0?b+"px":void 0):b}}}),a.support.opacity||(a.support.opacity={get:function(a,b){return o.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(b,c){var d=b.style;d.zoom=1;var e=a.isNaN(c)?"":"alpha(opacity="+100*c+")",f=d.filter||"";d.filter=n.test(f)?f.replace(n,e):d.filter+" "+e}}),l.defaultView&&l.defaultView.getComputedStyle&&(j=function(b,c,d){var e,f,g;return d=d.replace(q,"-$1").toLowerCase(),(f=b.ownerDocument.defaultView)?((g=f.getComputedStyle(b,null))&&(e=g.getPropertyValue(d),""!==e||a.contains(b.ownerDocument.documentElement,b)||(e=a.style(b,d))),e):void 0}),l.documentElement.currentStyle&&(k=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;return!r.test(d)&&s.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e)),""===d?"auto":d}),i=j||k,a.fn.css=function(a,b){return 2===arguments.length&&void 0===b?this:g(this,a,b,!0,function(a,b,e){return void 0!==e?c(a,b,e):d(a,b)})},a.cssNumber={zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0},a.cssProps={"float":a.support.cssFloat?"cssFloat":"styleFloat"},a.style=c,a.css=d,a.swap=e,a.camelCase=f;var y,z,A,B,C,D,E=function(){if(!y){var b,c,e,f=l.body,g=l.createElement("div"),h=parseFloat(d(f,"marginTop"))||0,i="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.extend(g.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),g.innerHTML=i,f.insertBefore(g,f.firstChild),b=g.firstChild,c=b.firstChild,e=b.nextSibling.firstChild.firstChild,C=5!==c.offsetTop,D=5===e.offsetTop,c.style.position="fixed",c.style.top="20px",B=20===c.offsetTop||15===c.offsetTop,c.style.position=c.style.top="",b.style.overflow="hidden",b.style.position="relative",A=-5===c.offsetTop,z=f.offsetTop!==h,f.removeChild(g),y=!0}},F=function(a){var b=a.offsetTop,c=a.offsetLeft;return E(),z&&(b+=parseFloat(d(a,"marginTop"))||0,c+=parseFloat(d(a,"marginLeft"))||0),{top:b,left:c}};a.fn.offset=function(){var b,c=this[0];if(!c||!c.ownerDocument)return null;if(c===c.ownerDocument.body)return F(c);try{b=c.getBoundingClientRect()}catch(d){}if(!b||!a.contains(m,c))return b?{top:b.top,left:b.left}:{top:0,left:0};var e=l.body,f=h(l),g=m.clientTop||e.clientTop||0,i=m.clientLeft||e.clientLeft||0,j=f.pageYOffset||a.support.boxModel&&m.scrollTop||e.scrollTop,k=f.pageXOffset||a.support.boxModel&&m.scrollLeft||e.scrollLeft,n=b.top+j-g,o=b.left+k-i;return{top:n,left:o}},a.fn.position=function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),e=t.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(d(a,"marginTop"))||0,c.left-=parseFloat(d(a,"marginLeft"))||0,e.top+=parseFloat(d(b[0],"borderTopWidth"))||0,e.left+=parseFloat(d(b[0],"borderLeftWidth"))||0,{top:c.top-e.top,left:c.left-e.left}
},a.fn.offsetParent=function(){return this.map(function(){for(var a=this.offsetParent||l.body;a&&!t.test(a.nodeName)&&"static"===d(a,"position");)a=a.offsetParent;return a})},a._each(["Height","Width"],function(b){var c=b.toLowerCase();a.fn["inner"+b]=function(){var a=this[0];return a&&a.style?parseFloat(d(a,c,"padding")):null},a.fn["outer"+b]=function(a){var b=this[0];return b&&b.style?parseFloat(d(b,c,a?"margin":"border")):null},a.fn[c]=function(e){var f=this[0];if(!f)return null==e?null:this;if(a.isFunction(e))return this.each(function(b){var d=a(this);d[c](e.call(this,b,d[c]()))});if(a.isWindow(f)){var g=f.document.documentElement["client"+b],h=f.document.body;return"CSS1Compat"===f.document.compatMode&&g||h&&h["client"+b]||g}if(9===f.nodeType)return Math.max(f.documentElement["client"+b],f.body["scroll"+b],f.documentElement["scroll"+b],f.body["offset"+b],f.documentElement["offset"+b]);if(void 0===e){var i=d(f,c),j=parseFloat(i);return a.isNaN(j)?i:j}return this.css(c,"string"==typeof e?e:e+"px")}}),a._each(["Left","Top"],function(b,c){var d="scroll"+b;a.fn[d]=function(b){var e,f;return void 0===b?(e=this[0])?(f=h(e),f?"pageXOffset"in f?f[c?"pageYOffset":"pageXOffset"]:a.support.boxModel&&f.document.documentElement[d]||f.document.body[d]:e[d]):null:this.each(function(){f=h(this),f?f.scrollTo(c?a(f).scrollLeft():b,c?b:a(f).scrollTop()):this[d]=b})}})}),$.plug("custom",function(a){for(var b=window,c={},d=b.location.search.substring(1).split("&"),e=a.Key=function(a){this.keyCode=a},f=0;f<d.length;f++){var g=d[f].split("=");c[g[0]]=unescape(g[1])}a.queryString=function(a){return c[a]},e.namedKeys={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,Capslock:20,Escape:27,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46},a._each(e.namedKeys,function(a,b){var c=a;e.prototype["is"+b]=function(){return this.keyCode===c}}),a.key=function(a){return a=a||window.event,new e(a.keyCode||a.which)},a.cancelEvent=function(a){return a||(a=window.event),a.cancelBubble=!0,a.returnValue=!1,a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),!1},a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},a._template=function(b,c){var d=a.templateSettings,e="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",f=new Function("obj","$",e);return c?f(c,a):function(b){return f(b,a)}}}),$.plug("docready",function(a){function b(){if(!i){try{g.documentElement.doScroll("left")}catch(a){return void setTimeout(b,1)}c()}}function c(b){if(b===!0&&j--,!j||b!==!0&&!i){if(!g.body)return setTimeout(e,1);if(i=!0,b!==!0&&--j>0)return;if(h){var c,d=0,e=h;for(h=null;c=e[d++];)c.call(g,a);a.fn.trigger&&a(g).trigger("ready").unbind("ready")}}}var d,e,f=window,g=document,h=[],i=!1,j=1;a.hook(function(a){return"function"==typeof a?(this.ready(a),!0):void 0}),a.ready=c,d=g.addEventListener?function(){g.removeEventListener("DOMContentLoaded",d,!1),c()}:function(){"complete"===g.readyState&&(g.detachEvent("onreadystatechange",d),c())},a.bindReady=function(){if(!e){if(e=!0,"complete"===g.readyState)return setTimeout(c,1);if(g.addEventListener)g.addEventListener("DOMContentLoaded",d,!1),f.addEventListener("load",c,!1);else if(g.attachEvent){g.attachEvent("onreadystatechange",d),f.attachEvent("onload",c);var a=!1;try{a=null==window.frameElement}catch(h){}g.documentElement.doScroll&&a&&b()}}},a.fn.ready=function(b){return a.bindReady(),i?b.call(g,a):h&&h.push(b),this},a.init||a(document).ready(a.onload)}),$.plug("events",function(a){function b(a){return a._jquid||(a._jquid=m++)}function c(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):(n[b+c]=function(){c(window.event)},a.attachEvent("on"+b,n[b+c]))}function d(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):(a.detachEvent("on"+b,n[b+c]),n[b+c]=null)}function e(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function f(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function g(c,d,g,h){if(d=e(d),d.ns)var i=f(d.ns);return a._filter(l[b(c)]||[],function(a){return!(!a||d.e&&a.e!=d.e||d.ns&&!i.test(a.ns)||g&&a.fn!=g||h&&a.sel!=h)})}function h(d,f,g,h,i){var j=b(d),k=l[j]||(l[j]=[]);a._each(f.split(/\s/),function(b){var f=a.extend(e(b),{fn:g,sel:h,del:i,i:k.length});k.push(f),c(d,f.e,i||g)}),d=null}function i(c,e,f,h){var i=b(c);a._each((e||"").split(/\s/),function(b){a._each(g(c,b,f,h),function(a){delete l[i][a.i],d(c,a.e,a.del||a.fn)})})}function j(b){var c=a.extend({originalEvent:b},b);return a._each(o,function(a){b[a]&&(c[a]=function(){return b[a].apply(b,arguments)})}),c}var k=document,l={},m=1,n={};a.bind=c,a.unbind=d;var o=["preventDefault","stopImmediatePropagation","stopPropagation"],p=a.fn;a._each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a){p[a]=function(b,c){return arguments.length>0?this.bind(a,b,c):this.trigger(a)}}),p.bind=function(a,b){return this.each(function(){h(this,a,b)})},p.unbind=function(a,b){return this.each(function(){i(this,a,b)})},p.one=function(a,b){return this.each(function(){var c=this;h(this,a,function(){b.apply(c,arguments),i(c,a,arguments.callee)})})},p.delegate=function(b,c,d){return this.each(function(e,f){h(f,c,d,b,function(c){for(var e=c.target||c.srcElement,g=a.$$(b,f);e&&a._indexOf(g,e)<0;)e=e.parentNode;e&&e!==f&&e!==document&&d.call(e,a.extend(j(c||window.event),{currentTarget:e,liveFired:f}))})})},p.undelegate=function(a,b,c){return this.each(function(){i(this,b,c,a)})},p.live=function(b,c){return a(k.body).delegate(this.selector,b,c),this},p.die=function(b,c){return a(k.body).undelegate(this.selector,b,c),this},p.on=function(a,b,c){return"function"==typeof b?this.bind(a,b):this.delegate(b,a,c)},p.off=function(a,b,c){return"string"==typeof b?this.undelegate(b,a,c):this.unbind(a,c)},p.trigger=function(a){return this.each(function(){if("click"==a&&this[a])return this[a]();if(k.createEvent){var b=k.createEvent("Events");this.dispatchEvent(b,b.initEvent(a,!0,!0))}else if(this.fireEvent)try{"ready"!==a&&this.fireEvent("on"+a)}catch(b){}})},a.init||a(window).bind("load",a.onload)}),global.jquip=window.jquip||jquip,window.$=_$,window.jquip=_jquip}(WEBSPELLCHECKER),window.WEBSPELLCHECKER=window.WEBSPELLCHECKER||{},function(a){var b,c,d,e,f=a.CORE,g=a.OptionsManager,h=g.optionTypes,i=g.importOptionsTemplate("WebApiTemplate");g.extendOptionTypes([{name:"htmlContainer",validate:function(a){var b=["email","password","submit","reset","radio","checkbox","button","color","date","datetime","datetime-local","month","number","range","tel","time","week","file","image","hidden"],c=!1;return a&&a.type&&(c=b.includes(a.type)),a.nodeType&&1===a.nodeType&&!c}},{name:"localization",validate:function(a){var b=["af","ar","bg","bn","bs","ca","cs","cy","da","de","el","en-us","en-au","en-ca","en-gb","en","eo","es","et","eu","fa","fi","fo","fr-ca","fr","gl","gu","he","hi","hr","hu","is","it","ja","ka","km","ko","lt","lv","mk","mn","ms","nb","nl","no","pl","pt-br","pt","ro","ru","sk","sl","sr-latn","sr","sv","th","tr","ug","uk","ku","vi","zh-cn","zh"];return b.includes(a)}}]),b={debug:{defaultValue:!1,type:h.boolean},focused:{defaultValue:!1,type:h.boolean},suggestionsCount:{defaultValue:3,type:h.positive},moreSuggestionsCount:{defaultValue:5,type:h.positive},localization:{defaultValue:"en",type:h.string},languageNodeName:{defaultValue:"span",type:h.string},languageAttributeName:{defaultValue:"lang",type:h.string},data_attribute_name:{defaultValue:"data-spelling-word",type:h.string},data_lang_attribute:{defaultValue:"data-wsc-lang",type:h.string},misspelled_word_class:{defaultValue:"spelling-problem",type:h.string},instance_class:{defaultValue:"wsc-instance",type:h.string},iframe_quirks_class:{defaultValue:"wsc-iframe-quirks",type:h.string},problem_grammar_node:{defaultValue:"span",type:h.string},misspelled_word_node:{defaultValue:"span",type:h.string},problem_grammar_data_attribute:{defaultValue:"data-grammar-phrase",type:h.string},problem_grammar_data_attribute_rule:{defaultValue:"data-grammar-rule",type:h.string},problem_grammar_class:{defaultValue:"grammar-problem",type:h.string},originalContainer:{defaultValue:null,type:h.defaultValue},documentContainer:{defaultValue:null,type:h.defaultValue},focusContainer:{defaultValue:null,type:h.defaultValue},currentDocument:{defaultValue:null,type:h.defaultValue},leftMouseButtonPressed:{defaultValue:!1,type:h.defaultValue},deleteKeyButtonPressed:{defaultValue:!1,type:h.defaultValue},backspaceKeyButtonPressed:{defaultValue:!1,type:h.defaultValue},spaceKeyButtonPressed:{defaultValue:!1,type:h.defaultValue},enterKeyButtonPressed:{defaultValue:!1,type:h.defaultValue},isTextBasedContainer:{defaultValue:!1,type:h.defaultValue},isTouchDevice:{defaultValue:!1,type:h.defaultValue},isIframe:{defaultValue:!1,type:h.defaultValue},freeze:{defaultValue:!1,type:h.defaultValue},banner:{defaultValue:!1,type:h.defaultValue},supportLocale:{defaultValue:!0,type:h.defaultValue},isServiceHostDefault:{defaultValue:!0,type:h.defaultValue},isMutationObserver:{defaultValue:"MutationObserver"in window?!0:!1,type:h.boolean},paused:{defaultValue:!1,type:h.defaultValue},appStarted:{defaultValue:!1,type:h.defaultValue},wordsLimit:{defaultValue:5,type:h.defaultValue},maxLength:{defaultValue:-1,type:h.defaultValue},numberOfFailedRequest:{defaultValue:0,type:h.defaultValue},spellCheckDelay:{defaultValue:700,type:h.defaultValue},mainWSCdomain:{defaultValue:"webspellchecker.net",type:h.defaultValue},userDictionaryKey:{defaultValue:"wsc_user_dictionary",type:h.defaultValue},userDictionaryNameKey:{defaultValue:"wsc_user_dictionary_name",type:h.defaultValue},wscLogo:{defaultValue:"css/logo.gif",type:h.defaultValue},cssPath:{defaultValue:"css/wsc.css",type:h.defaultValue},wscVersion:{defaultValue:"3.1.2364 master:6f5c7c97 #180",type:h.defaultValue},wscSupportUrl:{defaultValue:"http://www.webspellchecker.net/support",type:h.defaultValue},moreLangUrl:{defaultValue:"http://www.webspellchecker.net/additional-languages-support.html",type:h.defaultValue},ECUserManual:{defaultValue:"https://webspellchecker.net/user_manuals/webspellchecker_proofreader_for_editable_controls_user_manual.pdf",type:h.defaultValue},CKUserManual:{defaultValue:"http://scayt.com/user_manual/scayt_plugin_for_ckeditor4_user_manual.pdf",type:h.defaultValue},uid:{defaultValue:"",type:h.defaultValue},multiLanguageStyles:{defaultValue:{},type:h.object},detectLocalizationLanguage:{defaultValue:"",type:h.defaultValue},styles:{defaultValue:"",type:h.defaultValue},localizationPath:{defaultValue:"local/",type:h.defaultValue},eventsBlockedState:{defaultValue:{},type:h.defaultValue},spellingLangList:{defaultValue:{},type:h.defaultValue},grammarLangList:{defaultValue:{},type:h.defaultValue},modifierKeys:{defaultValue:{},type:h.defaultValue},shortcutsList:{defaultValue:[],type:h.array},permanentMinWordLength:{defaultValue:{th_TH:2,ko_KR:2},type:h.defaultValue},languagesMap:{defaultValue:{sw:"sw_TZ",zu:"zu_ZA",sq:"sq_AL",ar:"ar_SA",es:"es_ES",de:"de_DE",wa:"wa_BE",qu:"qu_EC",bg:"bg_BG",hr:"hr_HR",sr:"sr_LT",cs:"cs_CZ",ln:"ln_CD",hy:"hy_AM",en:"en_US",et:"et_EE",ti:"ti_ER",om:"om_ET",fo:"fo_FO",fj:"fj_FJ",sv:"sv_SE",br:"br_FR",gd:"gd_GB",ht:"ht_HT",he:"he_HE",hi:"hi_IN",hu:"hu_HU",is:"is_IS",as:"as_IN",or:"or_IN",id:"id_ID",tet:"tet_ID",fa:"fa_IR",ga:"ga_IE",gv:"gv_GB",kk:"kk_KZ",ky:"ky_KG",lv:"lv_LV",lt:"lt_LT",lb:"lb_LU",mi:"mi_NZ",mg:"mg_MG",ms:"ms_MY",mn:"mn_MN",ha:"ha_GH",ur:"ur_PK",tl:"tl_PH",pl:"pl_PL",csb:"csb_PL",ro:"ro_RO",ru:"ru_RU",cv:"cv_RU",rw:"rw_RW",sk:"sk_SK",sl:"sl_SI",so:"so_SO",cy:"cy_GB",af:"af_ZA",ss:"ss_ZA",ts:"ts_ZA",ve:"ve_ZA",xh:"xh_ZA",an:"an_ES",ast:"ast_ES",ca:"ca_ES",gl:"gl_ES",si:"si_LK",tt:"tt_RU",tpi:"tpi_PG",th:"th_TH",tr:"tr_TR",ku:"ku_TR",tk:"tk_TM",uk:"uk_UA",uz:"uz_UZ",vi:"vi_VN",sn:"sn_ZW",eo:"eo_EO",da:"da_DK",fi:"fi_FI",fr:"fr_FR",it:"it_IT",nl:"nl_NL",pt:"pt_PT",shs:"shs_CA",mos:"mo_BF",gsc:"gsc_FR",fur:"fu_IT",hil:"hl_PH",sh:"sh_YU",nso:"ns_ZA",tn:"tn_ZA",az:"az_AZ",oc:"oc_FR",grc:"grc_GR",smj:"smj_NO",fy:"fy_NL",nn:"nn_NO",se:"se_NO",nr:"nr_ZA",st:"st_ZA",ia:"ia_XR",el:"el_GR",nb:"nb_NO",ko:"ko_KR",la:"la_VA",mr:"mr_IN",son:"son_ML",bn:"bn_IN",mk:"mk_MK",be:"be_BY",dsb:"dsb_DE",hsb:"hsb_DE",sa:"sa_IN",te:"te_IN",ta:"ta_IN",ne:"ne_NP",yi:"yi_YI"},type:h.defaultValue},container:{required:!0,type:h.htmlContainer},ignoreGrammarElements:{defaultValue:"",type:h.boolean},ignoreAllCapsWords:{defaultValue:!1,type:h.boolean},ignoreDomainNames:{defaultValue:!0,type:h.boolean},ignoreWordsWithMixedCases:{defaultValue:!1,type:h.boolean},ignoreWordsWithNumbers:{defaultValue:!1,type:h.boolean},ignoreElements:{defaultValue:"",type:h.string},"options-to-restore":{defaultValue:["lang","ignoreAllCapsWords","ignoreDomainNames","ignoreWordsWithMixedCases","ignoreWordsWithNumbers"],type:h.array},undoDataSize:{defaultValue:20,type:h.number},enableOnTouchDevices:{defaultValue:!1,type:h.boolean},enableBadgeButton:{defaultValue:!1,type:h.boolean},actionItems:{defaultValue:["problemdescription","ignoreall","addword","undo","redo","cut","copy","paste","settings","toggle"],type:h.array},settingsSections:{defaultValue:["options","languages","dictionaries","about"],type:h.array},actionItemsSections:{defaultValue:["probleminfo","suggest","moresuggest","control","options"],type:h.array},additionalActionItems:{defaultValue:null,type:h.object},multiLanguageMode:{defaultValue:!1,type:h.boolean},contextMenuByMouseover:{defaultValue:!1,type:h.boolean},mirrorBasedInstance:{defaultValue:!1,type:h.boolean},enableCache:{defaultValue:!1,type:h.boolean}},b=g.mergeOptionsTemplates(b,i),g.exportOptionsTemplate("CoreTemplate",b);var f=function(a){function b(a){var b,c=a;if(c.decorator){if(b=l[c.decoratorFor],void 0===b)throw new Error(moduleID+" try to decorate undefined module "+c.decoratorFor+".");if(void 0===c.decorate)throw new Error(moduleID+" should define decorate method.");l[c.decoratorFor].instance=c.decorate(b.instance)}}function h(a){a.forEach(function(a){var c,d,e=a.name,f=a.module;n._register(e,f),n._start(e),d=l[e].instance,c=l[e].creator,d.initialized||(d.init&&d.init(),d.ready=!c.async,d.initialized=!0,b(d))})}function i(a){var b=[],c=[],d=function(){n.getService("Communication").fire({moduleID:"CORE",eventType:"allModulesReady"}),n.allModulesReady=!0},e=function(){h(b),d(),n.getService("Communication").unsubscribe({moduleID:"CORE",eventType:"asyncModulesReady",handler:e})};a.forEach(function(a){a.module.async?c.push(a):b.push(a)}),0!==c.length?(n.getService("Communication").subscribe({moduleID:"CORE",eventType:"asyncModulesReady",handler:e}),h(c)):(h(b),d())}function j(a,b){var c=function(){try{l[a].instance=new l[a].creator(a,new f.Sandbox(a,b))}catch(c){throw new Error("Could not create Module instance with id: "+a+" : "+c.message)}};return l[a].instance?!1:(c(a,b),!0)}function k(a){var b,c;for(var d in l){if(b=l[d].instance,c=l[d].creator,!b)return;if(c.async&&b.ready===!1)return!1}a.getService("Communication").fire({moduleID:"CORE",eventType:"asyncModulesReady"})}var l={},m="",n=this;if("string"==typeof a.container&&(a.container=document.getElementById(a.container)),e=g.createOptions(a,"CoreTemplate",function(a){a.reports.forEach(function(a){a.critical&&(m+=a.message)},this)}),""!==m)return new Error(m);e.modifierKeys={ALT:f.ALT,CTRL:f.CTRL,SHIFT:f.SHIFT},e.documentContainer=e.container,e.isIframe="iframe"==e.documentContainer.nodeName.toLowerCase()?!0:!1,e.currentDocument=e.isIframe===!0?e.documentContainer.contentWindow.document:document,e.cssPath=this.Utils.getUrl(e.cssPath,e.basePath),e.isServiceHostDefault=e.serviceHost.includes(e.mainWSCdomain),e.isIframe&&(e.container=e.documentContainer.contentDocument?e.documentContainer.contentDocument.getElementsByTagName("body")[0]:e.documentContainer.contentWindow.document.getElementsByTagName("body")[0]),e.originalContainer=e.container,e.focusContainer=e.documentContainer.contentWindow||e.container,e.uid=this.instanceManager.getUniqueId(e.documentContainer);for(var o=0;o<e["options-to-restore"].length;o++)c=e["options-to-restore"][o],"undefined"!=typeof e[c]&&(d=this.DataStorage.getData(e.uid+"_"+c),"undefined"!=typeof d&&null!==d?e[c]=d:this.DataStorage.setData(e.uid+"_"+c,e[c]));for(var p in e)e["options-to-restore"].includes(p)===!1&&this.DataStorage.deleteData(e.uid+"_"+p);this.options=e;var q=[{name:"Communication",module:f.Communication},{name:"DOMCommunication",module:f.DOMCommunication},{name:"WebApiAdapter",module:f.WebApiAdapter},{name:"RegExpressions",module:f.RegExpressions},{name:"RangeCreator",module:f.RangeCreator},{name:"Deferred",module:f.Deferred},{name:"StateController",module:f.StateController}];this.allModulesReady=!1,this._register=function(a,b){l[a]=l[a]||{creator:b,instance:null}},this.getService=function(a){return l[a]?l[a].instance:void 0},this._start=function(a){var b,c="";c=j(a,this)?a+" started.":a+" already started.",b=this.getService("Communication"),b.initialized&&b.fire({moduleID:"CORE",eventType:"moduleStarted",data:{statusMessage:c}})},this.initModules=function(a){i(a),k(this)},this.destroyModules=function(a){a=a||l;for(var b in a)l[b].instance.destroy&&l[b].instance.destroy();for(var b in a)l[b].instance=null},h(q,!0),this.getService("Communication").subscribe({moduleID:"CORE",eventType:"moduleReady",handler:function(a){l[a.moduleID].instance.ready=!0,k(this)},context:this})};f.prototype.Utils=a.Utils,f.prototype.OptionsManager=a.OptionsManager,f.prototype.RegularsManager=a.RegularsManager,f.prototype.IO=a.IO,f.prototype.initWebApi=a.initWebApi,f.prototype.logger=a.logger,f.signals=a.signals,f.jquip=a.jquip,f.rangy=a.rangy,a.CORE=f}(WEBSPELLCHECKER||{}),WEBSPELLCHECKER.CORE.Sandbox=function(a,b){function c(a,b){var c={};for(var d in a)a.hasOwnProperty(d)&&-1===b.indexOf(d)&&(c[d]=a[d].bind(a));return c}function d(a,c){var d={};return c=b.Utils.ArrayUtils.argumentsToArray(c),d=b.Utils.is(c[0],"Object")?c[0]:b.Utils.ArrayUtils.zipArraysToObject(a,c)}function e(){var a,b=this.getOption("leftMouseButtonPressed"),c=this.Utils.Browser.ie;return a=c&&b?!1:!0}this.getCommunication=function(){return b.getService("Communication")},this.getContextMenu=function(){var a=b.getService("ContextMenu"),c={addItems:a.addItems,getItem:a.getItem,addItem:a.addItem,addGroup:a.addGroup,getDOMElement:a.getDOMElement};for(var d in c)c.hasOwnProperty(d)&&(c[d]=c[d].bind(a));return c},this.getBadge=function(){return b.getService("Badge")},this.createRange=function(){var c=b.getService("RangeCreator").createRange();return b.logger.log({name:a,msg:"Create the range",data:c,type:"range"}),c},this.getSelection=function(c){var d=b.getService("RangeCreator").getSelection(c);return b.logger.log({name:a,msg:"Get the selection",data:d,type:"selection"}),d},this.saveSelection=function(){var c;return e.apply(this)&&!this.getOption("mirrorBasedInstance")?(this.fireInAllApps("lockMutationsListener",{lock:!0}),c=b.getService("RangeCreator").getSelectionManager().saveSelection(),b.logger.log({name:a,msg:"Save the selection",data:c,type:"selection"}),this.fireInAllApps("lockMutationsListener",{lock:!1}),c):void 0},this.restoreSelection=function(c){var d;return c&&e.apply(this)?(this.fireInAllApps("lockMutationsListener",{lock:!0}),d=b.getService("RangeCreator").getSelectionManager().restoreSelection(c),b.logger.log({name:a,msg:"Restore the selection",data:d,type:"selection"}),this.fire("selectionIsChanged",{action:"restoreSelection"}),this.fireInAllApps("lockMutationsListener",{lock:!1}),d):void 0},this.deleteStoredSelection=function(a){var b,c=!1;return a&&(b=this.saveSelection(),this.restoreSelection(a),this.restoreSelection(b),c=!0),c},this.removeMarkers=function(c){var d=b.getService("RangeCreator").getSelectionManager().removeMarkers(c);return b.logger.log({name:a,msg:"Removes the hidden marker",data:d,type:"selection"}),d},this.getBookmark=function(){var c,d,e;return e=b.getService("RangeCreator").getSelection(),e.rangeCount()?(d=e.getRangeAt(0),c=d.getBookmark(this.getOption("container")),b.logger.log({name:a,msg:"Save the bookmark",data:c,type:"range"}),c):void 0},this.moveToBookmark=function(c){var d;return c?(d=b.getService("RangeCreator").createRange(),d=d.moveToBookmark(c),b.logger.log({name:a,msg:"Move to bookmark",data:d,type:"range"}),d):void 0},this.getCaretRangeFromEvent=function(a){var b,c,d,e=a.clientX,f=a.clientY,g="wsc-caret-"+(new Date).getTime(),h=this.createRange(),i=this.getSelection(),j=(i.rangeCount()>0?i.getRangeAt(0):void 0,this.Utils.getCurrentDocument(this.getOption("documentContainer"))),k=this.getOption("container");if(j.caretPositionFromPoint)d=j.caretPositionFromPoint(e,f),h.setStart(d.offsetNode,d.offset),h.collapse(!0);else if(j.caretRangeFromPoint)d=j.caretRangeFromPoint(e,f),h.setStart(d.startContainer,d.startOffset),h.collapse(!0);else if(j.body.createTextRange){this.fire({element:k,eventType:"focus"}),b=j.body.createTextRange();try{b.moveToPoint(e,f),b.pasteHTML('<span id="'+g+'">​</span>'),c=this.UILib.find("#"+g,k)[0],h.setStartBefore(c),h.collapse(!0),this.UILib.remove(c)}catch(l){return null}}return h},this.IO=Object.assign({},b.IO),this.OptionsManager=b.OptionsManager,this.RegularsManager=b.RegularsManager,this.initWebApi=b.initWebApi,this.Utils=b.Utils,this.logger=b.logger.log,b.logger.isON(b.options.debug),this.console=b.logger.console,this.Localization=b.Localization,this.Template=b.Template,this.clipboardManager=b.clipboardManager,this.DataStorage=b.DataStorage,this.FullUILib=b.UILib;var f=["cancelEvent","preventDefault","stopPropagation","stopImmediatePropagation","focus","blur","contextmenu","on","one","off","trigger"];this.UILib=c(this.FullUILib,f),this.DataProcessor=b.DataProcessor,this.UIMetrics=WEBSPELLCHECKER.CORE.UIMetrics,this.getHtmlWithoutSpellingNodes=function(a){return this.DataProcessor.getHtmlWithoutSpellingNodes(a,this.getOption("misspelled_word_node"),this.getOption("misspelled_word_class"))},this.getHtmlWithoutGrammarNodes=function(a){return this.DataProcessor.getHtmlWithoutGrammarNodes(a,this.getOption("problem_grammar_node"),this.getOption("problem_grammar_class"))},this.getWordsFromString=function(a){return b.getService("WebApiAdapter").getWordsFromString(a)},this.replaceSepatators=function(a){return b.getService("WebApiAdapter").replaceSepatators(a)},this.removeSpecialCharacters=function(a){return b.getService("WebApiAdapter").removeSpecialCharacters(a)},this.blockEvents=function(a){for(var b=this.getOption("eventsBlockedState"),c=0;c<a.length;c++)b[a[c]]=!0;this.setOption("eventsBlockedState",b)},this.unblockEvents=function(a){for(var b=this.getOption("eventsBlockedState"),c=0;c<a.length;c++)b[a[c]]=!1;this.setOption("eventsBlockedState",b)},this.setPaused=function(a){return b.options.paused=a},this.fire=function(){var c=this.getOption("eventsBlockedState"),e=d(["eventType","data","instance","DOMElement"],arguments);return e.moduleID=a,b.logger.log({name:a,msg:"Fired event: "+e.eventType+" with such data -> ",data:e.data,type:"signals"}),b.options.paused===!0||c[e.eventType]?void 0:this.getCommunication().fire(e)},this.subscribe=function(){var c=d(["eventType","handler","context","priority","instance","element"],arguments);c.context=c.context||b.getService(a),c.moduleID=a;return this.getCommunication().subscribe(c)},this.unsubscribe=function(){var c=d(["eventType","context","context","instance","DOMElement"],arguments);return c.context=c.context||b.getService(a),c.moduleID=a,b.logger.log({name:a,msg:"Unsubscribe to the event: "+c.eventType,type:"signals"}),this.getCommunication().unsubscribe(c)},this.addEventProxy=function(c){return b.logger.log({name:a,msg:"Set event proxy between elements",data:c,type:"signals"}),b.getService("DOMCommunication").EventProxy.addEventProxy(c)},this.removeEventProxy=function(c){return b.logger.log({name:a,msg:"Remove event proxy between elements",data:c,type:"signals"}),b.getService("DOMCommunication").EventProxy.removeEventProxy(c)},this.fireInAllApps=function(a,c){b.instanceManager.notifyAll(a,c)},this._getCoreOptionObject=function(){return b.options},this.getOption=function(c){for(var d="[object String]"==Object.prototype.toString.call(c)?[c]:c,e={},f=0;f<d.length;f++)e[d[f]]=b.options[d[f]];var g=1==d.length?e[d[0]]:e;return b.logger.log({name:a,msg:'Get the "'+d+'" option with value -> ',data:g,type:"options"}),g},this.isOriginalContainerTextBased=function(){return this.getOption("isTextBasedContainer")},this.getDefaultOption=function(a){for(var c="[object String]"==Object.prototype.toString.call(a)?[a]:a,d={},e=0;e<c.length;e++)d[c[e]]=b.options[c[e]].defaultValue;return 1==c.length?d[c[0]]:d},this.getLocal=function(a){return this.Localization.getLocal(a,this.getOption("localization"))},this.setOption=function(c,d){c in b.options&&(b.options[c]=d,this.getOption("options-to-restore").includes(c)!==!1&&(b.logger.log({name:a,msg:'Set the "'+c+'" option with value -> ',data:d,type:"options"}),this.DataStorage.setData(this.getOption("uid")+"_"+c,d)))},this.addDeferredFunction=function(a,c){b.getService("Deferred").register(a,c)},this.removeAllDeferredFunctions=function(){b.getService("Deferred").unregisterAll()},this.setFocused=function(a){return b.options.focused=a},this.getFocused=function(){return b.options.focused},this.isFocused=function(){var a=this.getFocused(),b=this.getOption("documentContainer"),c=b===document.activeElement,d=b.contains(document.activeElement);return a||c||d},this.setContainer=function(a){return b.options.container=a},this.removeMarkupFromString=function(a){var b=this,c=document.createElement("div"),d=b.getOption("misspelled_word_node"),e=b.getOption("data_attribute_name"),f=b.getOption("problem_grammar_node"),g=b.getOption("problem_grammar_data_attribute");c.innerHTML=a;for(var h=b.UILib.findNodeChildren(c,d,e),i=b.UILib.findNodeChildren(c,f,g);h.length>0;){for(var j=h.shift(),k=document.createDocumentFragment();j.childNodes.length>0;)k.appendChild(j.childNodes.item(0));j.parentNode.insertBefore(k,j),j.parentNode.removeChild(j)}for(;i.length>0;){for(var l=i.shift(),k=document.createDocumentFragment();l.childNodes.length>0;)k.appendChild(l.childNodes.item(0));l.parentNode.insertBefore(k,l),l.parentNode.removeChild(l)}return c.innerHTML},this.getProblemNodeFromSelection=function(a){var b,c,d,e,f,g,h,i,j,k,l=this.getSelection(),m=l.isBackwards(),n=l.rangeCount()?l.getRangeAt(0):null,o=n?n.collapsed():!0,p=l.anchorNode();switch(a){case"spelling":i=this.getOption("misspelled_word_node"),j=this.getOption("data_attribute_name"),k=this.getOption("misspelled_word_class");break;case"grammar":i=this.getOption("problem_grammar_node"),j=this.getOption("problem_grammar_data_attribute"),k=this.getOption("problem_grammar_class")}if(h=this.Utils.isEqualNode(p,j)?p:this.UILib.findNodeParents(p,i,j)[0],!h&&!o){b=this.removeSpecialCharacters(n.toString()),b=m?b.split("").reverse().join(""):b,c=n.getNodes(),c=m?c.reverse():c;for(var q=0,r=c.length;r>q;q++)if(d=c[q],1===d.nodeType&&this.UILib.hasClass(d,k)){e=this.UILib.attr(d,j),e=m?e.split("").reverse().join(""):e,f=e.length>=b.length&&0===e.indexOf(b),g=e.length<b.length&&0===b.indexOf(e),(f||g)&&(h=d);break}}return h},this.getSpellingNodeFromSelection=function(){return this.getProblemNodeFromSelection("spelling")},this.getGrammarNodeFromSelection=function(){return this.getProblemNodeFromSelection("grammar")},this.getSpellingNodesInElement=function(a){var b=a?a:this.getOption("container"),c="."+this.getOption("misspelled_word_class");return this.UILib.find(c,b)},this.getGrammarNodesInElement=function(a){var b=a?a:this.getOption("container"),c="."+this.getOption("problem_grammar_class");return this.UILib.find(c,b)},this.getSavedSelectionParentContainer=function(a){var b=null,c=this.Utils.getCurrentDocument(this.getOption("documentContainer"));return a&&a.rangeInfos[0]&&(b=a.rangeInfos[0].collapsed?this.getParentBlockElement(c.getElementById(a.rangeInfos[0].markerId)):this.getOption("container")),b},this.getParentBlockElement=function(a){for(var b=this.RegularsManager.blockElementsRegex,c=this.getOption("container");a!==c;){if(-1!==b.search(a.nodeName))return a;a=a.parentNode}return a},this.getOffsetParent=function(a){var b=this.Utils.getCurrentDocument(this.getOption("documentContainer")),c=a.offsetParent||b.documentElement;return c===b.body&&"static"===this.Utils.getComputedStyle(c).position&&(c=c.parentNode),c},this.getPrevSymbol=function(a,b){var c,d,e=this.createRange(),f=document.createElement("div");return e.setStart(a,0),e.setEndBefore(b),c=e.cloneContents(),f.appendChild(c),d=f.textContent||f.innerText,d=this.removeSpecialCharacters(d),d[d.length-1]},this.getNextSymbol=function(a,b){var c,d,e=this.createRange(),f=document.createElement("div");return e.setStartAfter(b),e.setEnd(a,a.childNodes.length),c=e.cloneContents(),f.appendChild(c),d=f.textContent||f.innerText,d=this.removeSpecialCharacters(d),d[0]},this.getTextBeforeCursor=function(){var a,b,c=this.createRange(),d=document.createElement("div"),e=this.getSelection();return 0===e.rangeCount()?null:(c.setStart(this.getOption("container"),0),c.setEnd(e.anchorNode(),e.anchorOffset()),a=c.cloneContents(),d.appendChild(a),b=d.textContent||d.innerText,b=this.removeSpecialCharacters(b))},this.isNodeContentBroken=function(a,b){var c=a.getAttribute(b),d=a.textContent||a.innerText;return d=this.removeSpecialCharacters(d),c!==d},this.getBrokenProblemNodes=function(a,b){var c,d,e,f,g=this.getOption("focused"),h=this.getSelection(),i=this.RegularsManager.wordBoundaryRegex,j=this;switch(a){case"spelling":f=this.getOption("data_attribute_name"),d="getSpellingNodesInElement";break;case"grammar":f=this.getOption("problem_grammar_data_attribute"),d="getGrammarNodesInElement"}return b?c=b:g&&(c=h.anchorNode()),c?(c=this.getParentBlockElement(c),e=this[d](c),e=e.filter(function(a){if(j.isNodeContentBroken(a,f))return!0;var b=j.getPrevSymbol(c,a);if(b&&!i.test(b))return!0;var d=j.getNextSymbol(c,a);return d&&!i.test(d)?!0:void 0})):void 0},this.getBrokenSpellingNodes=function(a){return this.getBrokenProblemNodes("spelling",a)},this.getBrokenGrammarNodes=function(a){return this.getBrokenProblemNodes("spelling",a)},this.getProblemsCount=function(){for(var a=this.getSpellingNodesInElement(),b=this.getGrammarNodesInElement(),c=a.concat(b),d=0,e=0,f=c.length;f>e;e++)c[e].innerHTML&&d++;return d},this.isCaretInStartOfMisspelledWord=function(){var a,b,c,d=this.getSelection(),e=d.rangeCount()?d.getRangeAt(0):null,f=this.getOption("data_attribute_name"),g=this.getOption("container"),h=this.RegularsManager.blockElementsRegex,i=this.RegularsManager.wordBoundaryRegex;if(!e||!e.collapsed())return!1;if(a=this.getSpellingNodeFromSelection())return 0===e.startOffset()?a:!1;b=new this.Utils.Walker(e.startContainer(),e.startOffset(),!0,g);do{if(b.siblingNode&&h.test(b.siblingNode.nodeName.toLowerCase()))break;if(this.Utils.isEqualNode(b.currentNode,f)){a=b.currentNode;break}if(c=this.replaceSepatators(b.textWalkedThrough),i.test(c))break}while(b.getNext());return a},this.isCaretInEndOfMisspelledWord=function(){var a,b,c,d,e,f=this.getSelection(),g=f.rangeCount()?f.getRangeAt(0):null,h=this.getOption("data_attribute_name"),i=this.getOption("container");if(!g||!g.collapsed())return!1;if(a=this.getSpellingNodeFromSelection()){if(b=g.startContainer(),g.startOffset()===b.length&&a.childNodes[a.childNodes.length-1]===b)return!0}else{if(c=g.startContainer(),c.childNodes&&c.childNodes.length>0){if(c=c.childNodes[g.startOffset()],!c)return!0
}else if(0!==g.startOffset())return!1;d=new this.Utils.Walker(c,0,!1,i);do if(this.Utils.isEqualNode(d.currentNode,h)&&d.textWalkedThrough.length>0){a=d.currentNode,a=this.getLatestTextNodeFromSpellingNode(a);break}while(d.getNext());if(!a)return!1;if(e=this.createRange(),e.setStart(a,a.nodeValue.length),e.setEnd(c,0),0===e.toString().length)return!0}return!1},this.getLatestTextNodeFromSpellingNode=function(a){for(;a.childNodes.length;)a=a.childNodes[a.childNodes.length-1];return a},this.saveRange=function(c,d){var e;return e=b.getService("RangeCreator").getRangeManager().saveRange(c,d),b.logger.log({name:a,msg:"Save the range",data:e,type:"range"}),e},this.restoreRange=function(c,d){var e;return c?(e=b.getService("RangeCreator").getRangeManager().restoreRange(c,d),b.logger.log({name:a,msg:"Restore the range",data:e,type:"range"}),e):void 0},this.getMainContainer=function(){return this.getOption(this.getOption("isIframe")?"documentContainer":"container")}},function(a){"use strict";function b(){function a(a){return function(){return e||(e=WEBSPELLCHECKER.CORE.jquip),a.apply(f,arguments)}}for(var b in f)f.hasOwnProperty(b)&&"function"==typeof f[b]&&(f[b]=a(f[b]))}var c,d,e;d=function(){function a(a){var b=a,c=Object.prototype.toString.call(a).slice(8,-1).toLowerCase();return a&&"object"===c&&"undefined"!=typeof a.toArray&&(b=a.toArray()),b}function b(a){var b=[],c=Object.prototype.toString.call(a).slice(8,-1).toLowerCase();if(a&&("htmlcollection"===c||"nodelist"===c||"object"===c&&"undefined"!=typeof a.length&&"undefined"!=typeof a[0]&&"undefined"==typeof a.nodeType)){for(var d=0;d<a.length;b.push(a[d]),d++);a=b}return e(a)}this.find=function(c,d){var e;return e="undefined"==typeof d?b(c):b(d).find(c),a(e)},this.parent=function(c,d){var e=b(c).parent(d);return a(e)},this.parents=function(c,d){var e=b(c).parents(d);return a(e)},this.is=function(c,d){var e=b(c).is(d);return a(e)},this.each=function(a,c){b(a).each(c)},this.filter=function(c,d){var e=b(c).filter(d);return a(e)},this.create=function(b){return a(e(b))},this.remove=function(b){return a(e(b).remove())},this.appendTo=function(b,c){return a(e(b).appendTo(e(c)))},this.prependTo=function(b,c){return a(e(b).prependTo(e(c)))},this.append=function(b,c){return a(e(b).append(e(c)))},this.prepend=function(b,c){return a(e(b).prepend(e(c)))},this.insertAfter=function(b,c){return a(e(b).insertAfter(e(c)))},this.insertBefore=function(b,c){return a(e(b).insertBefore(e(c)))},this.attr=function(b,c,d){return a(e(b).attr(c,d))},this.removeAttr=function(b,c){return a(e(b).removeAttr(c))},this.addClass=function(b,c){return a(e(b).addClass(c))},this.removeClass=function(b,c){return a(e(b).removeClass(c))},this.hasClass=function(b,c){return a(e(b).hasClass(c))},this.css=function(b,c){return a(e(b).css(c))},this.show=function(b){return a(e(b).show())},this.hide=function(b){return a(e(b).hide())},this.html=function(b,c){return a(e(b).html(c))},this.val=function(b,c){return a(e(b).val(c))},this.text=function(b,c){return a(e(b).text(c))},this.empty=function(b){return a(e(b).empty())},this.domReady=function(a){e(a)},this.on=function(a,b,c,d){e(b).on(a,c,d)},this.off=function(a,b,c,d){e(b).off(a,c,d)},this.one=function(a,b,c){e(b).one(a,c)},this.trigger=function(a,b){return e(b).trigger(a)},this.getEventTarget=function(a){var b=a.target;return b||(b=a.srcElement||document),3===b.nodeType&&(b=b.parentNode),b},this.cancelEvent=function(a){return e.cancelEvent(a)},this.preventDefault=function(a){a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},this.defaultPrevented=function(a){return a?void 0!==a.defaultPrevented?a.defaultPrevented:a.returnValue===!1?!0:!1:a.defaultPrevented},this.stopPropagation=function(a){a&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())},this.stopImmediatePropagation=function(a){a&&(a.isImmediatePropagationStopped=function(){return!0},this.stopPropagation(a),a.stopImmediatePropagation&&a.stopImmediatePropagation())},this.focus=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.focus.apply(b,c))},this.blur=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.blur.apply(b,c))},this.contextmenu=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.contextmenu.apply(b,c))},this.proxy=function(a,b){return e.proxy(a,b)},this.width=function(a,b){return e(a).width(b)},this.height=function(a,b){return e(a).height(b)},this.outerWidth=function(a,b){return e(a).outerWidth(b)},this.outerHeight=function(a,b){return e(a).outerHeight(b)},this.scrollLeft=function(a,b){return e(a).scrollLeft(b)},this.scrollTop=function(a,b){return e(a).scrollTop(b)},this.offset=function(a){return e(a).offset()},this.extend=function(){return e.extend.apply(e,arguments)}},c=new d;var f={find:function(){return c.find.apply(c,arguments)},parent:function(){return c.parent.apply(c,arguments)},parents:function(){return c.parents.apply(c,arguments)},is:function(){return c.is.apply(c,arguments)},each:function(){c.each.apply(c,arguments)},filter:function(){return c.filter.apply(c,arguments)},create:function(){return c.create.apply(c,arguments)},remove:function(){return c.remove.apply(c,arguments)},appendTo:function(){return c.appendTo.apply(c,arguments)},prependTo:function(){return c.prependTo.apply(c,arguments)},append:function(){return c.append.apply(c,arguments)},prepend:function(){return c.prepend.apply(c,arguments)},insertAfter:function(){return c.insertAfter.apply(c,arguments)},insertBefore:function(){return c.insertBefore.apply(c,arguments)},attr:function(){return c.attr.apply(c,arguments)},removeAttr:function(){return c.removeAttr.apply(c,arguments)},addClass:function(){return c.addClass.apply(c,arguments)},removeClass:function(){return c.removeClass.apply(c,arguments)},hasClass:function(){return c.hasClass.apply(c,arguments)},css:function(){return c.css.apply(c,arguments)},show:function(){return c.show.apply(c,arguments)},hide:function(){return c.hide.apply(c,arguments)},html:function(){return c.html.apply(c,arguments)},val:function(){return c.val.apply(c,arguments)},text:function(){return c.text.apply(c,arguments)},empty:function(){return c.empty.apply(c,arguments)},domReady:function(a){c.domReady(a)},on:function(a,b,d,e){void 0===e&&(e=d,d=void 0),c.on.apply(c,[a,b,d||e,e])},off:function(b,d,e,f){a.Utils;void 0===f&&"function"==typeof e&&(f=e,e=void 0),c.off.apply(c,[b,d,e,f])},one:function(){c.one.apply(c,arguments)},trigger:function(a,b,d){return d?(b=this.find(b)[0],b.dispatchEvent?b.dispatchEvent(d):b.fireEvent?b.fireEvent("on"+a,d):void 0):c.trigger.apply(c,arguments)},getEventTarget:function(){return c.getEventTarget.apply(c,arguments)},cancelEvent:function(){return c.cancelEvent.apply(c,arguments)},createEvent:function(){var a;return document.createEvent?a=document.createEvent("Event"):document.createEventObject&&(a=document.createEventObject()),a},preventDefault:function(a){c.preventDefault(a)},stopPropagation:function(a){c.stopPropagation(a)},stopImmediatePropagation:function(a){c.stopImmediatePropagation(a)},isDefaultPrevented:function(a){return c.defaultPrevented(a)},focus:function(){return c.focus.apply(c,arguments)},blur:function(){return c.blur.apply(c,arguments)},contextmenu:function(){return c.contextmenu.apply(c,arguments)},proxy:function(){return c.proxy.apply(c,arguments)},width:function(){return c.width.apply(c,arguments)},height:function(){return c.height.apply(c,arguments)},outerWidth:function(){return c.outerWidth.apply(c,arguments)},outerHeight:function(){return c.outerHeight.apply(c,arguments)},scrollLeft:function(){return c.scrollLeft.apply(c,arguments)},scrollTop:function(){return c.scrollTop.apply(c,arguments)},offset:function(){return c.offset.apply(c,arguments)},extend:function(){return c.extend.apply(c,arguments)},setPosition:function(a,b,c){"number"==typeof b&&"number"==typeof c&&this.css(a,{left:b,top:c})},query:function(a,b){return this.find(b,a)},findNodeChildren:function(a,b,c){return this.find(b+"["+c+"]",a)},findNodeParents:function(a,b,c){return this.parents(a,b+"["+c+"]")}};b(),a.UILib=f}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";if(!a.instanceManager){var b=[],c={add:function(a){b.push(a)},remove:function(a){for(var c=0;c<b.length;c++)b[c].getOption("uid")===a&&b.splice(c,1)},notifyAll:function(a,c){for(var d=0;d<b.length;d++)b[d].fire(a,c)},getUniqueId:function(c){var d=a.Utils.hashCode(location.href);return c.id?c.id+"_"+d:"wsc_"+b.length+"_"+d},getControlById:function(a){for(var c=null,d=0,e=b.length;e>d;d++)if(b[d].originalElementId&&b[d].originalElementId===a){c=b[d].instance;break}return c}};a.instanceManager=c}}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=Object.assign({objectIsEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},Walker:function(a,b,c,d){var e=c?"nextSibling":"previousSibling",f=3===a.nodeType?c?a.nodeValue.substr(b,a.nodeValue.length):a.nodeValue.substr(0,b):"";this.textWalkedThrough=f,this.currentNode=a,this.previousNode=null,this.siblingNode=null,this.getNext=function(){if(this.currentNode.childNodes.length>0&&this.previousNode&&this.currentNode.childNodes[c*(this.currentNode.childNodes.length-1)]!==this.previousNode?(this.previousNode=this.currentNode,this.currentNode=this.currentNode.childNodes[!c*(this.currentNode.childNodes.length-1)],this.siblingNode=null):this.currentNode.childNodes.length>0&&!this.previousNode&&this.currentNode.childNodes[b-!c]?(this.previousNode=this.currentNode,this.currentNode=this.currentNode.childNodes[b-!c],this.siblingNode=null):this.currentNode[e]?(this.previousNode=this.currentNode,this.currentNode=this.currentNode[e],this.siblingNode=this.currentNode):(this.previousNode=this.currentNode,this.currentNode=this.currentNode.parentNode,this.siblingNode=null),this.currentNode)switch(this.currentNode.nodeType){case 1:this.currentNode===d&&(this.currentNode=null);break;case 3:if(/\n+\s*/.test(this.currentNode.nodeValue))break;c?this.textWalkedThrough+=this.currentNode.nodeValue:this.textWalkedThrough=this.currentNode.nodeValue+this.textWalkedThrough}return this.currentNode},this.reset=function(){this.textWalkedThrough=f,this.currentNode=a,this.previousNode=null,this.siblingNode=null}},findFirstNodeWithString:function(a,b){for(var c=[a],d=c.shift();d;){switch(d.nodeType){case 3:if(-1!==d.nodeValue.indexOf(b))return d;break;case 1:for(var e=0;e<d.childNodes.length;e++)c.splice(e,0,d.childNodes[e]);c.length>d.childNodes.length&&c.splice(e,0,document.createTextNode(" "))}d=c.shift()}return null},isEqualNode:function(a,b){var c=!1;return a&&(c=a.getAttribute&&a.getAttribute(b)?!0:!1),c},isLocalStorageSupported:function(){try{return window.localStorage.setItem("_localStorageSupported",1),window.localStorage.removeItem("_localStorageSupported"),!0}catch(a){return!1}},removeFillingCharacter:function(a){return a=a.replace(new RegExp(String.fromCharCode(8204),"g"),"")},removeGlobal:function(a,b){b=b||window;try{delete b.variable}catch(c){b.variable=void 0}},sortRangesForMurkup:function(a,b){var c=b.compareBoundaryPoints(0,a);return c},getCurrentDocument:function(a){var b;return b="iframe"==a.nodeName.toLowerCase()&&a.contentWindow&&a.contentWindow.document?a.contentWindow.document:document},getComputedStyle:function(a){return window.getComputedStyle?window.getComputedStyle(a):a.currentStyle},getScrollWidth:function(){var a,b=document.createElement("div");return b.style.overflowY="scroll",b.style.width="50px",b.style.height="50px",b.style.visibility="hidden",document.body.appendChild(b),a=b.offsetWidth-b.clientWidth,document.body.removeChild(b),a},getScrollBarsState:function(a){return{vertical:a.scrollHeight>a.clientHeight,horizontal:a.scrollWidth>a.clientWidth}},getScrollLeftForInput:function(a){var b,c,d,e,f,g,h;return a.createTextRange?(f=a.createTextRange(),g=f.getBoundingClientRect(),h=a.getBoundingClientRect(),c=this.getComputedStyle(a),d=parseFloat(c.paddingLeft),e=a.clientLeft,b=h.left+e+d-g.left):b=a.scrollLeft,b},getScrollWidthForInput:function(a){var b,c,d;return a.createTextRange?(c=a.createTextRange(),d=c.getBoundingClientRect(),b=d.width+30):b=a.scrollWidth,b},elementsFromPoint:function(a,b,c){var d,e=[],f=[];if(c.elementsFromPoint||c.msElementsFromPoint)return c.elementsFromPoint?c.elementsFromPoint(a,b):c.msElementsFromPoint(a,b);for(;(d=c.elementFromPoint(a,b))&&-1===e.indexOf(d)&&"HTML"!==d.tagName;)e.push(d),f.push(d.style.pointerEvents),d.style.pointerEvents="none";for(var g=0;g<e.length;g++)e[g].style.pointerEvents=f[g]?f[g]:"";return e},escapeHTML:function(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;")},unescapeProblemTags:function(a){return a=a.replace(/@lt;/g,"<"),a=a.replace(/@gt;/g,">"),a=a.replace(/@quot;/g,'"')},getVisibilityApiData:function(){var a={};return"undefined"!=typeof document.hidden?(a.hidden="hidden",a.visibilityChangeEvent="visibilitychange"):"undefined"!=typeof document.webkitHidden&&(a.hidden="webkitHidden",a.visibilityChangeEvent="webkitvisibilitychange"),a},getWindowByDocument:function(a){return"defaultView"in a?a.defaultView:a.parentWindow},fixRangeBoundaryPoints:function(a){var b={startNode:a.startContainer(),endNode:a.endContainer(),startOffset:a.startOffset(),endOffset:a.endOffset()};if(b.startNode.parentNode!=b.endNode.parentNode){var c=a.commonAncestorContainer(),d=b.startNode;if(0===b.startOffset){for(;d.parentNode!=c&&d.parentNode.firstChild==d;)d=d.parentNode;b.startBeforeNode=d}if(b.startNode=d,d=b.endNode,d.length==b.endOffset){for(;d.parentNode!=c&&d.parentNode.lastChild==d;)d=d.parentNode;b.endAfterNode=d}}return a.setStart(b.startNode,b.startOffset),a.setEnd(b.endNode,b.endOffset),b.startBeforeNode&&a.setStartBefore(b.startBeforeNode),b.endAfterNode&&a.setEndAfter(b.endAfterNode),a},extendOptions:function(a,b){for(var c in b)a[c]=b[c]},getUrl:function(a,b){return-1==a.indexOf(":/")&&0!==a.indexOf("/")&&(a=b+a),a},is:function(a,b){var c=Object.prototype.toString.call(a).slice(8,-1);return void 0!==a&&null!==a&&c===b},getLocationInfo:function(a){var b=document.createElement("a");return b.href=a,{protocol:b.protocol.replace(/:/,""),host:b.host.split(":")[0],port:"0"==b.port||""==b.port?"80":b.port,pathname:b.pathname.replace(/^\//,"")}},extend:function(a,b){var c,d;if(a=a||Object,c=function(){},c.prototype=a.prototype,"function"!=typeof b&&(d=b,b=function(){}),b.prototype=Object.assign(new c,b.prototype||{}),b.prototype.parent=a.prototype,b.prototype.constructor=b,d&&null!==d&&"object"==typeof d)for(var e in d)d.hasOwnProperty(e)&&(b.prototype[e]=d[e]);return b},hashCode:function(a){var b,c=0;if(0===a.length)return c;for(var d=0,e=a.length;e>d;d++)b=a.charCodeAt(d),c=(c<<5)-c+b,c&=c;return c},trunc:function(a,b){return a.length>b?a.substr(0,b)+"&hellip;":a},copyStyles:function(b,c){var d=null,e=a.UILib,f={};if(d=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(b,null):b.currentStyle,!d)return null;for(var g in d)f[d[g]]=d[d[g]];e.css(c,f)},getBaseData:function(a){var b,c,d,e="/",f=".js";if(document.currentScript&&!a&&(c=document.currentScript,d=c.src,a=d.substring(d.lastIndexOf(e)+e.length,d.lastIndexOf(f)+f.length)),b=new RegExp("(^|.*[\\\\/])"+a+"(?:\\?.*)?$","i"),d)d=d.match(b)[1];else for(var g=document.getElementsByTagName("script"),h=0;h<g.length;h++){var i=g[h].src.match(b);if(i){c=g[h],d=i[1];break}}return d&&-1==d.indexOf(":/")&&(d=0===d.indexOf("/")?window.location.href.match(/^.*?:\/\/[^\/]*/)[0]+d:window.location.href.match(/^[^\?]*\/(?:)/)[0]+d),{path:d,script:c}},getOptionsFromDataAttrs:function(a,b){for(var c=a.attributes,d=["autocreate"],e={},f="",g="",h="",i=0;i<c.length;i++)if(f=c[i].name,0===f.indexOf(b)){if(h=f.substring(b.length,f.length),d.includes(h))continue;g=a.getAttribute(b+h),g="true"===g?!0:g,g="false"===g?!1:g,e[h]=g}return e},isTextBased:function(a){var b=["textarea","text","search","url"];return a?this.indexOf(b,a.type)>=0:!1},isInputBased:function(a){var b=["text","search","url"];return a?this.indexOf(b,a.type)>=0:!1},isHidden:function(a){return!a.offsetWidth&&!a.offsetHeight},isInPage:function(a){return document.getElementsByTagName("body")[0].contains(a)},isNodeAvailable:function(a){return this.isInPage(a)&&!this.isHidden(a)},isTouchDevice:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch},HTMLCollectionToArray:function(a){var b,c=a.length,d=new Array(c);for(b=c-1;b>=0;b-=1)d[b]=a[b];return d},isUppercaseLetter:function(a){var b=a.charAt(0);return b===b.toUpperCase()&&b!==b.toLowerCase()?!0:!1},startsWithSpaceAndUppercaseLetter:function(a){var b,c=/^[\s\xA0]+(?=\S{1})/g.exec(a);return c?(b=a.charAt(c[0].length),this.isUppercaseLetter(b)):!1},hasUppercaseLetter:function(a){for(var b=0;b<a.length;b++)if(this.isUppercaseLetter(a[b]))return!0;return!1}},a.Utils);a.Utils=b}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b={},c=function f(a,c){var d=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):b[a]=b[a]||f(document.getElementById(a).innerHTML.replace(/\r\n/,""));return c?d(c):d},d=a.UILib,e={create:function(a,b){var c;document.getElementById(a)||(c=document.createElement("script"),c.type="text/html",c.id=a,c.text=b,d.appendTo(c,"body"))},remove:function(a){d.remove("body #"+a),delete b[a]},render:function(a,b){return c(a,b)}};a.Template=e}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b={separator:"<$>",getDataType:function(a){var b;return b="undefined"==typeof a?"undefined":null===a?"null":Object.prototype.toString.call(a).slice(8,-1)},convertDataToString:function(a){var b,c=this.getDataType(a).toLowerCase();return b=c+this.separator+a},restoreDataFromString:function(a){var b,c,d=a;if(a=this.backCompatibility(a),"string"==typeof a)switch(c=a.indexOf(this.separator),b=a.substring(0,c),d=a.substring(c+this.separator.length),b){case"boolean":d="true"===d;break;case"number":d=parseFloat(d);break;case"array":d=""===d?[]:d.split(",");break;case"null":d=null;break;case"undefined":d=void 0}return d},backCompatibility:function(a){var b,c,d=a;return"string"==typeof a&&(c=a.indexOf(this.separator),0>c&&(b=parseFloat(a),isNaN(b)&&("["===a[0]&&"]"===a[a.length-1]?(a=a.replace("[",""),a=a.replace("]",""),b=""===a?[]:a.split(",")):b="true"===a||"false"===a?"true"===a:a),d=this.convertDataToString(b))),d}},c={get:function(a){var c=b.restoreDataFromString(window.localStorage.getItem(a));return c},set:function(a,c){var d=b.convertDataToString(c);window.localStorage.setItem(a,d)},del:function(a){window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()}},d={expiration:function(){return 31622400}(),get:function(a){var c=b.restoreDataFromString(this.getCookie(a));return c},set:function(a,c){var d=b.convertDataToString(c);this.setCookie(a,d,{expires:this.expiration})},del:function(a){this.deleteCookie(a)},getCookie:function(a){"string"!=typeof a&&(a="");var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0},setCookie:function(a,b,c){c=c||{};var d=c.expires;if("number"==typeof d&&d){var e=new Date;e.setTime(e.getTime()+1e3*d),d=c.expires=e}d&&d.toUTCString&&(c.expires=d.toUTCString()),b=encodeURIComponent(b);var f=a+"="+b;for(var g in c){var h=c[g];f+="; "+g,h!==!0&&(f+="="+h)}document.cookie=f},deleteCookie:function(a){this.setCookie(a,null,{expires:-1})},clear:function(){for(var a=document.cookie.split(";"),b=0;b<a.length;b++){var c=a[b],d=c.indexOf("="),e=d>-1?c.substr(0,d):c;this.deleteCookie(e)}}},e=function(){try{var a="localStorage"in window&&null!==window.localStorage;return a?(window.localStorage.setItem("_localStorageSupported",1),window.localStorage.removeItem("_localStorageSupported"),!0):!1}catch(b){return!1}},f=e()?c:d,g={getData:function(a){return f.get(a)},setData:function(a,b){f.set(a,b)},deleteData:function(a){f.del(a)},clear:function(){f.clear()}};a.DataStorage=g}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b,c,d=function(a,d){this.name=a,this.sandbox=d,b=d.Utils,c=d.UILib};d.prototype={init:function(){var a=this,b=this.sandbox.RegularsManager;this.sandbox.subscribe({eventType:"allModulesReady",handler:function(){a.documentContainer=a.sandbox.getOption("documentContainer")}}),this.documentContainer=this.sandbox.getOption("documentContainer"),this.blockElementsRegex=b.blockElementsRegex,this.ignoreElementsRegex=b.ignoreElementsRegex,this.libAdapter=d.RangyAdapter,this.rangyOptions={nonWhiteSpaceExtendedGlobal:b.nonWhiteSpaceExtended.g(),tokenizer:function(b,c){function d(a,c,d){for(var e=b.slice(a,c),f={isWord:d,chars:e,toString:function(){return e.join("")}},g=0,h=e.length;h>g;++g)e[g].token=f;j.push(f)}var e,f,g,h=b.join(""),i=0,j=[];for(h=a.sandbox.replaceSepatators(h);g=c.nonWhiteSpaceExtendedGlobal.exec(h);)e=g.index,f=e+g[0].length,e>i&&d(i,e,!1),d(e,f,!0),i=f;return i<b.length&&d(i,b.length,!1),j}}},getDocumentContainer:function(){return b.isInPage(this.documentContainer)?this.documentContainer:null},createRange:function(){return new d.Range(new this.libAdapter(this.getDocumentContainer(),this.blockElementsRegex,this.ignoreElementsRegex,this.rangyOptions))},getSelection:function(a){return new d.Selection(new this.libAdapter(this.getDocumentContainer(),this.blockElementsRegex,this.ignoreElementsRegex,this.rangyOptions),a)},getSelectionManager:function(){return new d.SelectionManager(new this.libAdapter(this.getDocumentContainer(),this.blockElementsRegex,this.ignoreElementsRegex,this.rangyOptions))},getRangeManager:function(){return new d.RangeManager(new this.libAdapter(this.getDocumentContainer(),this.blockElementsRegex,this.ignoreElementsRegex,this.rangyOptions))},comparisonType:{START_TO_START:0,START_TO_END:1,END_TO_START:3,END_TO_END:2}},d.Range=function(a){var b=a.range;b.createRange(),this.collapsed=function(){return b.collapsed()},this.commonAncestorContainer=function(){return b.commonAncestorContainer()},this.endContainer=function(){return b.endContainer()},this.endOffset=function(){return b.endOffset()},this.startContainer=function(){return b.startContainer()},this.startOffset=function(){return b.startOffset()},this.setStart=function(a,c){return b.setStart(a,c)},this.setEnd=function(a,c){return b.setEnd(a,c)},this.setStartBefore=function(a){return b.setStartBefore(a)},this.setStartAfter=function(a){return b.setStartAfter(a)},this.setEndBefore=function(a){return b.setEndBefore(a)},this.setEndAfter=function(a){return b.setEndAfter(a)},this.selectNode=function(a){return b.selectNode(a)},this.selectNodeContents=function(a){return b.selectNodeContents(a)},this.collapse=function(a){return b.collapse(a)},this.cloneContents=function(){return b.cloneContents()},this.deleteContents=function(){return b.deleteContents()},this.extractContents=function(){return b.extractContents()},this.insertNode=function(a){return b.insertNode(a)},this.surroundContents=function(a){return b.surroundContents(a)},this.compareBoundaryPoints=function(a,b){return b.compareBoundaryPoints(a,b)},this.cloneRange=function(){return b.cloneRange()},this.detach=function(){return b.detach()},this.toString=function(){return b.toString()},this.createContextualFragment=function(a){return b.createContextualFragment(a)},this.move=function(a,c,d){return b.move(a,c,d)},this.expand=function(a,c){return b.expand(a,c)},this.getNodes=function(){return b.getNodes()},this.moveEnd=function(a,c,d){return b.moveEnd(a,c,d)},this.moveStart=function(a,c,d){return b.moveStart(a,c,d)},this.getBookmark=function(a){return b.getBookmark(a)},this.moveToBookmark=function(a){return b.moveToBookmark(a)},this.containsRange=function(a){return b.containsRange(a._getRangyRange())},this._getRangyRange=function(){return b._getRangyRange()}},d.RangeManager=function(a){var b=a.rangeManager;return{saveRange:function(a,c){return b.saveRange(a,c)},restoreRange:function(a,c){return b.restoreRange(a,c)}}},d.RangeManager.prototype={},d.Selection=function(a,b){var c=a.selection;c.getSelection(b),this.rangeCount=function(){return c.rangeCount()},this.getRangeAt=function(a){return c.getRangeAt(a)},this.removeAllRanges=function(){return c.removeAllRanges()},this.addRange=function(a){return c.addRange(a)},this.anchorNode=function(){return c.anchorNode()},this.anchorOffset=function(){return c.anchorOffset()},this.focusNode=function(){return c.focusNode()},this.focusOffset=function(){return c.focusOffset()},this.move=function(a,b,d){return c.move(a,b,d)},this.expand=function(a,b){return c.expand(a,b)},this.isBackwards=function(){return c.isBackwards()}},d.SelectionManager=function(a){var b=a.selectionManager;return{saveSelection:function(){return b.saveSelection()},restoreSelection:function(a){return b.restoreSelection(a)},removeMarkers:function(a){return b.removeMarkers(a)}}},d.SelectionManager.prototype={},d.RangyAdapter=function(e,f,g,h){d.Lib=d.Lib||a.rangy||window.rangy,d.Lib.initialized===!1&&d.Lib.init();var i,j=null,k={range:{createRange:function(){return i=d.Lib.createRange(e)},collapsed:function(){return i.collapsed},commonAncestorContainer:function(){return i.commonAncestorContainer},endContainer:function(){return i.endContainer},endOffset:function(){return i.endOffset},startContainer:function(){return i.startContainer},startOffset:function(){return i.startOffset},setStart:function(a,b){return i.setStart(a,b)},setEnd:function(a,b){return i.setEnd(a,b)},setStartBefore:function(a){return i.setStartBefore(a)},setStartAfter:function(a){return i.setStartAfter(a)},setEndBefore:function(a){return i.setEndBefore(a)},setEndAfter:function(a){return i.setEndAfter(a)},selectNode:function(a){return i.selectNode(a)},selectNodeContents:function(a){return i.selectNodeContents(a)},collapse:function(a){return i.collapse(a)},cloneContents:function(){return i.cloneContents()},deleteContents:function(){return i.deleteContents()},extractContents:function(){return i.extractContents()},insertNode:function(a){return i.insertNode(a)},surroundContents:function(a){return i.surroundContents(a)},compareBoundaryPoints:function(a,b){var c=d.Lib.createRange(e);return c.setStart(b.startContainer(),b.startOffset()),c.setEnd(b.endContainer(),b.endOffset()),i.compareBoundaryPoints(a,c)},cloneRange:function(){var a=new d.Range(new d.RangyAdapter(e,f,g,h));return a.setStart(this.startContainer(),this.startOffset()),a.setEnd(this.endContainer(),this.endOffset()),a},detach:function(){return i.detach()},toString:function(){for(var a="",b=i.cloneContents(),c=[b],d=c.shift();d;){switch(d.nodeType){case 3:a+=d.nodeValue;break;case 1:case 11:if(g.match(d.nodeName))a+=" ";else{for(var e=0;e<d.childNodes.length;e++)c.splice(e,0,d.childNodes[e]);f.match(d.nodeName)&&(c.length>d.childNodes.length&&c.splice(e,0,document.createTextNode(" ")),a.length>0&&" "!=a[a.length-1]&&c.splice(0,0,document.createTextNode(" ")))}}d=c.shift()}return a},createContextualFragment:function(a){return i.createContextualFragment(a)},move:function(a,b,c){return i.move(a,b,"word"!==a||c?c:h)},expand:function(a,b){return i.expand(a,"word"!==a||b?b:h)},getNodes:function(){return i.getNodes()},moveEnd:function(a,b,c){return i.moveEnd(a,b,"word"!==a||c?c:h)},moveStart:function(a,b,c){return i.moveStart(a,b,"word"!==a||c?c:h)},getBookmark:function(a){return i.getBookmark(a)},moveToBookmark:function(a){var b=!1;return a&&(i.moveToBookmark(a),b=new d.Range(new d.RangyAdapter(e,f,g,h)),b.setStart(i.startContainer,i.startOffset),b.setEnd(i.endContainer,i.endOffset)),b},containsRange:function(a){return i.containsRange(a)},_getRangyRange:function(){return i}},selection:{getSelection:function(a){var b=function(){j="boolean"==typeof a&&a||"iframe"!==e.nodeName.toLowerCase()?d.Lib.getSelection():d.Lib.getSelection(e)};null!==j&&this.detach();try{b()}catch(c){this.detach(),b()}return j},rangeCount:function(){return j.rangeCount},getRangeAt:function(a){var b=j.getRangeAt(a),c=new d.Range(new d.RangyAdapter(e,f,g,h));return c.setStart(b.startContainer,b.startOffset),c.setEnd(b.endContainer,b.endOffset),c},removeAllRanges:function(){return j.removeAllRanges()},addRange:function(a){var b=d.Lib.createRange(e);return b.setStart(a.startContainer(),a.startOffset()),b.setEnd(a.endContainer(),a.endOffset()),j.addRange(b)},anchorNode:function(){return j.anchorNode},anchorOffset:function(){return j.anchorOffset},focusNode:function(){return j.focusNode},focusOffset:function(){return j.focusOffset},move:function(a,b,c){return j.move(a,b,c)},expand:function(a,b){return j.expand(a,b)},detach:function(){d.Lib.Selection.detachAll()},isBackwards:function(){return j.isBackwards()}},selectionManager:{saveSelection:function(){var a;try{c.is(e,":visible")&&(a="iframe"==e.nodeName.toLowerCase()?d.Lib.saveSelection(e):d.Lib.saveSelection(),a.doc=b.getCurrentDocument(e))}catch(f){}return a},restoreSelection:function(a){function b(a){for(var b=[],c=a.length,e=c-1;e>=0;e--)b[e]=d.Lib.restoreRange(a[e],!1);return b}if(!a.restored){var c=a.rangeInfos,e=k.selection.getSelection(a.win),f=b(c),g=c.length;1==g&&d.Lib.features.selectionHasExtend&&c[0].backward?(e.removeAllRanges(),e.addRange(f[0],!0)):e.setRanges(f),a.restored=!0}return a.restored},removeMarkers:function(a){d.Lib.removeMarkers(a)}},rangeManager:{saveRange:function(a,b){var c,f;return f=d.Lib.createRange(e),f.setStart(a.startContainer(),a.startOffset()),a.collapsed()||f.setEnd(a.endContainer(),a.endOffset()),c=d.Lib.saveRange(f,b)},restoreRange:function(a,b){var c,i=!1;return a&&(c=d.Lib.restoreRange(a,b),i=new d.Range(new d.RangyAdapter(e,f,g,h)),i.setStart(c.startContainer,c.startOffset),i.setEnd(c.endContainer,c.endOffset)),i}}};return k},d.TestAdapter=function(){d.Lib=d.Lib||window.TestLib,b.removeGlobal(window.TestLib);return{createRange:function(){return d.Lib.createRange()},selectNodeContents:function(a){return d.Lib.selectNodeContents(a)},collapse:function(a){return d.Lib.collapse(a)},createContextualFragment:function(a){return d.Lib.createContextualFragment(a)},insertNode:function(a){return d.Lib.insertNode(a)}}},a.RangeCreator=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.documentContainer=this.sandbox.getOption("focusContainer")};b.prototype={init:function(){var a=this;this.sandbox.subscribe({eventType:"allModulesReady",handler:function(){a.removeBindings(),a.documentContainer=a.sandbox.getOption("focusContainer"),a.container=this.sandbox.getOption("container"),a.addBindings()}}),this.addBindings()},destroy:function(){this.removeBindings()},addBindings:function(){this.sandbox.subscribe({eventType:"focus",element:this.documentContainer,handler:this.focusHandler}),this.sandbox.subscribe({eventType:"blur",element:this.documentContainer,handler:this.blurHandler}),this.sandbox.subscribe({eventType:"mousedown",element:this.container,handler:this.mouseDownHandler}),this.sandbox.subscribe({eventType:"mouseup",element:this.container,handler:this.mouseUpHandler}),this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:this.keydownHandler,priority:2e3,context:this}),this.sandbox.subscribe({eventType:"keyup",element:this.container,handler:this.keyupHandler,priority:2e3,context:this})},removeBindings:function(){this.sandbox.unsubscribe({eventType:"focus",element:this.documentContainer,handler:this.focusHandler}),this.sandbox.unsubscribe({eventType:"blur",element:this.documentContainer,handler:this.blurHandler}),this.sandbox.unsubscribe({eventType:"mousedown",element:this.container,handler:this.mouseDownHandler}),this.sandbox.unsubscribe({eventType:"mouseup",element:this.container,handler:this.mouseUpHandler}),this.sandbox.unsubscribe({eventType:"keydown",element:this.container,handler:this.keydownHandler,context:this}),this.sandbox.unsubscribe({eventType:"keyup",element:this.container,handler:this.keyupHandler,context:this})
},focusHandler:function(){this.sandbox.setFocused(!0)},blurHandler:function(){this.sandbox.setFocused(!1)},mouseDownHandler:function(){this.sandbox.setOption("leftMouseButtonPressed",!0)},mouseUpHandler:function(){this.sandbox.setOption("leftMouseButtonPressed",!1)},keydownHandler:function(a){switch(a.keyCode){case 46:this.sandbox.setOption("deleteKeyButtonPressed",!0);break;case 8:this.sandbox.setOption("backspaceKeyButtonPressed",!0);break;case 32:this.sandbox.setOption("spaceKeyButtonPressed",!0);break;case 13:this.sandbox.setOption("enterKeyButtonPressed",!0)}},keyupHandler:function(a){switch(a.keyCode){case 46:this.sandbox.setOption("deleteKeyButtonPressed",!1);break;case 8:this.sandbox.setOption("backspaceKeyButtonPressed",!1);break;case 32:this.sandbox.setOption("spaceKeyButtonPressed",!1);break;case 13:this.sandbox.setOption("enterKeyButtonPressed",!1)}}},a.StateController=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d=function(c,e){this.name=c,this.sandbox=e,b=e.Utils,this.events={},d.Signal=d.Signal||a.signals};d.prototype={init:function(){c=["toggleApp","startSpellCheck","moduleStarted","selectionIsChanged","saveSelection","restoreSelection","periodicalChecking","loadTheme","localizationLoaded","collectWords","wordsCollected","misspelledWordsFound","replaceWord","sentWordsCount","getWordsLimit","getUserActions","freeze","startGrammarCheck","collectSentences","sentencesCollected","getGrammarSuggestionsList","problemSentencesFound","markupPhrase","ignorePhrase","ignoreAllPhrases","replacePhrase","removeMarkupFromPhrases","removeGrammarMarkupInSelectionNode","updateSentencesCache","enableGrammarChanged","markupWords","getSuggestionsList","suggestionListSend","ignoreWord","ignoreAllWords","removeMarkupInDocument","removeMarkupFromWords","removeMarkupInSelectionNode","textReplaced","taskEnded","spellCheckStarted","spellCheckEnded","beforemanualcontrolblur","showBanner","hideBanner","openWSCwindow","documentReadyForSpelling","suggestionListRendered","commitOptions","getUserDictionaryName","getUserDictionary","createUserDictionary","renameUserDictionary","restoreUserDictionary","removeUserDictionary","disconnectFromUserDictionary","setUserDictionaryName","addWordToUserDictionary","deleteWordFromUserDictionary","userDictionaryChanged","userDictionaryStateChanged","userDictionaryStateRestored","userDictionaryAction","keydownCharLengthOnFakeElement","cutProcessed","copyProcessed","pasteProcessed","afterPaste","beforeContextMenuShow","contextMenuHide","dialogDefinition","openDialog","onLoad","onShow","onHide","onClose","onSubmit","onCancel","afterTabShow","appReady","calculateWords","dictionaryChanged","defaultTextchanged","backgroundColorChanged","asyncModulesReady","allModulesReady","moduleReady","markupedNode","removedMarkupInContainer","removeMarkup","setShortcuts","removeShortcuts","undo","redo","executeUndo","executeRedo","checkUndoRedoPosibility","undoRedoPosibility","dropProcessed","crossContainerDrop","afterDrop","remoteAction","fixBrokenNodes","lockMutationsListener","garbageCollected"],this.addEvents(c)},destroy:function(){this.unsubscribe({eventType:c.join(", ")})},addEvents:function(a){for(var b=0;b<a.length;b+=1){var c=a[b];this.events[c]=this.createSignal()}},createSignal:function(){return new d.Signal},fire:function(a){a=a||{};for(var b,c,e=(a.moduleID,a.data||{}),f=a.eventType.split(","),g="",h=[],i=0;i<f.length;i++)g=f[i].trim(),b=this.events[g],c=new d.Event(g,e,b),b.dispatch(c),h.push(c.aggregateEventData());return h.length>1?h:h[0]},subscribe:function(a){a=a||{};for(var b=(a.moduleID,a.eventType,a.handler),c=a.context,d=a.priority||0,e=a.eventType.split(","),f="",g=0;g<e.length;g++)f=e[g].trim(),this.events[f].add(b,c,d)},unsubscribe:function(a){a=a||{};for(var b,c,d=(a.moduleID,a.eventType,a.context),e=a.eventType.split(","),f=0,g=0;g<e.length;g++)if(c=e[g].trim(),b=this.events[c],d)for(;b._bindings[f];)b._bindings[f].context===d?b.remove(b._bindings[f]._listener,d):f++;else b.removeAll()}},d.Event=function(a,b,c){Object.assign(this,b),this._type=a,this._eventData=[],this._signal=c,this._propagationStopped=!1,this._defaultPrevented=!1,this._immediatePropagationStopped=!1},d.Event.prototype={constructor:d.Event,setReturnedData:function(a){if(!b.is(a,"Object"))throw new TypeError("data is not a object");this._eventData.push(a)},preventDefault:function(){this._defaultPrevented=!0},isDefaultPrevented:function(){return this._defaultPrevented},stopPropagation:function(){this._propagationStopped=!0},stopImmediatePropagation:function(){this._immediatePropagationStopped=!0,this._signal.halt()},isEventDataEmpty:function(){return this._eventData.length>0?!1:!0},isPropagationStopped:function(){return this._propagationStopped},aggregateEventData:function(a){var b=this._eventData,c={};a=a||Object.assign;for(var d=0;d<b.length;d+=1)a(c,b[d]);return c}},a.Communication=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d,e=function(a,e){this.name=a,this.sandbox=e,this.decorator=!0,this.decoratorFor="Communication",b=this.UILib=this.sandbox.FullUILib,c=this.Utils=this.sandbox.Utils,d=this.logger=this.sandbox.console,this.events={}};e.prototype={constructor:e,init:function(){this.eventsNames=["click","dblclick","contextmenu","mousedown","mouseup","mouseout","mousemove","mouseover","mouseenter","mouseleave","focus","blur","keydown","keypress","keyup","cut","copy","beforepaste","paste","drop","drag","dragover","dragstart","dragend","dragenter","dragleave","change","resize","orientationchange","select","compositionstart","compositionend","selectionchange","scroll","mousewheel","input","visibilitychange","webkitvisibilitychange","unload","touchstart","touchmove","touchend"],this.EventProxy=new e.EventProxy(this)},destroy:function(){this.wrapMethod("unsubscribe")({eventType:this.eventsNames.join(", ")}),this.EventProxy.removeAllEventProxy()},decorate:function(a){this.communication=a,this.addEvents(this.eventsNames),this.communication.addEvents(this.eventsNames);var b={fire:this.wrapMethod("fire"),subscribe:this.wrapMethod("subscribe"),unsubscribe:this.wrapMethod("unsubscribe")};for(var c in this.communication)b[c]=b[c]?b[c]:this.communication[c];return b},addEvents:function(a){for(var b=0;b<a.length;b+=1){var c=a[b];this.events[c]=new e.UISignal(c,this.communication,this.name)}},checkOnEventSupport:function(a){return!(!a||!a.addEventListener&&!a.attachEvent)},validateListener:function(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));return a},setEventData:function(a,b){var c=["target","srcElement","currentTarget"];a.initEvent&&a.initEvent(b.type,!0,!0);for(var d in b)if(-1===c.indexOf(d)&&"_"!==d[0]&&"function"!=typeof b[d])try{a[d]=b[d]}catch(e){}return a},checkEventTypes:function(a){for(var b,c=0;c<a.length;c+=1)if(b=a[c].trim(),-1===this.eventsNames.indexOf(b))return!1;return!0},dispatchEvent:function(a,c,d){var e=this.setEventData(b.createEvent(c),d);return!this.UILib.trigger(c,a,e)},fireBeforeEventsForContainer:function(a,b){var c=this.sandbox.getOption("container"),d=this.sandbox.getOption("documentContainer"),e=(this.Utils.getCurrentDocument(d),"beforemanualcontrol");("focus"===a&&b.element!==c&&document.activeElement===d||"blur"===a&&b.element===c)&&this.communication.fire({eventType:e+"blur"})},fire:function(a,c){var d,e,f=c.element,g=this.events[a],h=["click","focus","blur"],i={};return-1!==h.indexOf(a)?(e=function(a){d=b.isDefaultPrevented(a)},b.on(a,f,e),this.fireBeforeEventsForContainer(a,c),f[a](),b.off(a,f,e)):(c.data=c.data||{},c.data.type||(c.data.type=a),d=this.dispatchEvent(f,a,c.data)),null===g.lastSystemFireResult?i.defaultPrevented=d:(i=g.lastSystemFireResult,g.lastSystemFireResult=null),i},subscribe:function(a,b){var c=this,d=c.events[a],f={element:b.element,userContext:b.context,userHandler:c.validateListener(b.handler,"subscribe")};d.addSubscription(f),b.userContext=b.context,b.context=f,b.handler=function(a){if(a.constructor!==e.UIEventDecorator){if(void 0===a.nativeEvent)return;a=new e.UIEventDecorator(a)}a.currentTarget===this.element&&this.userHandler.call(this.userContext,a)},c.communication.subscribe(b)},unsubscribe:function(a,b){function c(a,c){f.removeSubscription(a,c),e.communication.unsubscribe(b)}for(var d,e=this,f=e.events[a],g=b.handler,h=b.element,i=f.subscribers.length-1;i>=0;i-=1)d=f.subscribers[i],b.userContext=b.userContext||b.context,b.context=d,b.userContext&&b.userContext!==d.userContext||(h?d.element===h&&(g?(g=e.validateListener(b.handler,"unsubscribe"),g===d.userHandler&&c(d,i)):c(d,i)):c(d,i),b.context=b.userContext)},prepareOption:function(a,b){return b.element===this.sandbox.getOption("container")&&"focus"===a&&this.Utils.Browser.gecko&&this.sandbox.getOption("isIframe")===!0&&(b.element=this.sandbox.getOption("focusContainer"),b.eventType.split(",").length>1&&d.warn("You can't call focus event with another events in one fire/subscribe method with another events. For this case focus event should be one in 'eventType'")),b},wrapMethod:function(a){var b=this;return function(c){var e,f,g,h=c.eventType.split(","),i=[];if(b.checkEventTypes(h)){if(b.checkOnEventSupport(c.element)===!1&&"unsubscribe"!==a)return d.warn(c.eventType+" event/s defined in "+b.name+" module. For "+a+" DOM events you should set (HTMLElement | document) in method params"),null;for(var j=0;j<h.length;j+=1)e=h[j].trim(),c=b.prepareOption(e,c),g=c,h.length>1&&(g=Object.assign({},c)),f=b[a].call(b,e,g),f&&i.push(f);return i.length>1?i:i[0]}return b.communication[a](c)}}},e.EventProxy=function(a){this.DOMCommunication=a,this.proxyElements=[]},e.EventProxy.prototype={constructor:e.EventProxy,addEventProxy:function(a){var c=this.DOMCommunication;c.checkOnEventSupport(a.from)&&c.checkOnEventSupport(a.to)||d.warn("for eventProxy you should provide 2 elements: 'from' and 'to'");var e=Object.assign({},a);e.eventsNames=a.eventsNames||c.eventsNames,e.handler=function(a){c.dispatchEvent(this.to,a.type,a)},e.handler=e.handler.bind(e),this.proxyElements.push(e);for(var f=0;f<e.eventsNames.length;f+=1)b.on(e.eventsNames[f],e.from,e.handler)},removeAllEventProxy:function(){for(var a=0;a<this.proxyElements.length;a+=1)this.removeEventProxy(this.proxyElements[a])},removeEventProxy:function(a){for(var c,d=0;d<this.proxyElements.length;d+=1)if(a.from===this.proxyElements[d].from&&a.to===this.proxyElements[d].to){c=this.proxyElements[d];break}for(d=0;d<a.eventsNames.length;d+=1)b.off(c.eventsNames[d],c.from,c.handler)}},e.UIEventDecorator=function(a){this.eventPrototype=a.constructor.prototype,this.event=a,this.nativeEvent=a.nativeEvent;var c=b.isDefaultPrevented(this.nativeEvent);c&&this.event.preventDefault(),a.setReturnedData({defaultPrevented:c});for(var d in this.nativeEvent)void 0!==this.nativeEvent[d]&&"function"!=typeof this.nativeEvent[d]&&(a[d]=this.nativeEvent[d]);for(d in this.constructor.prototype)a[d]=this.constructor.prototype[d].bind(this);return a.constructor=this.constructor,a.target=b.getEventTarget(this.nativeEvent),delete a.nativeEvent,a},e.UIEventDecorator.prototype={constructor:e.UIEventDecorator,preventDefault:function(){this.eventPrototype.isDefaultPrevented.call(this.event)===!1&&(b.preventDefault(this.nativeEvent),this.eventPrototype.setReturnedData.call(this.event,{defaultPrevented:!0}),this.eventPrototype.preventDefault.call(this.event))},stopPropagation:function(){b.stopPropagation(this.nativeEvent),this.eventPrototype.stopPropagation.call(this.event)},stopImmediatePropagation:function(){b.stopImmediatePropagation(this.nativeEvent),this.eventPrototype.stopImmediatePropagation.call(this.event)}},e.UISignal=function(a,b,c){var d=this;this.subscribers=[],this.registredElements=[],this.eventType=a,this.emmiter=b,this.moduleID=c,this.lastSystemFireResult=null,this.handler=function(a){d.lastSystemFireResult=d.emmiter.fire({moduleID:d.moduleID,eventType:d.eventType,data:{nativeEvent:a}})}},e.UISignal.prototype={constructor:e.UISignal,addSubscription:function(a){this.subscribers.push(a),-1===this.findElementIndex(a.element,this.registredElements)&&this.registerElement(a.element)},removeSubscription:function(a,b){var c=this.subscribers;if("undefined"==typeof b)for(var d=0;d<c.length;d+=1)if(c[d]===a){b=d;break}c.splice(b,1),-1===this.findElementIndex(a.element,c)&&this.unregisterElement(a.element)},registerElement:function(a){var d,e=this;d=c.Browser.ie&&c.Browser.version<9?function(b){null===b&&(b=c.getWindowByDocument(a.document).event),b.currentTarget=a,e.handler(b)}:this.handler,this.registredElements.push({element:a,handler:d}),b.on(this.eventType,a,d)},unregisterElement:function(a){var c=this.findElementIndex(a,this.registredElements),d=this.registredElements[c];this.registredElements.splice(c,1),b.off(this.eventType,a,d.handler)},findElementIndex:function(a,b){for(var c=0;c<b.length;c+=1)if(b[c].element===a)return c;return-1}},a.DOMCommunication=e}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={constructor:b,init:function(){var a=this,b=this.sandbox._getCoreOptionObject();this.parametersMap={onSuccess:"success",onError:"error"},this.webApi=new this.sandbox.initWebApi(b),this.sandbox.subscribe("remoteAction",function(b){var c,d=a.adapter[b.actionMethod];if(!d)throw new Error("Web api action method "+d+" not supported.");c=this.mapWebApiParameters(b),d.call(a,c)})},mapWebApiParameters:function(a){var b,c={};for(var d in a)a.hasOwnProperty(d)&&(b=this.parametersMap[d],void 0!==b?c[b]=a[d]:c[d]=a[d]);return c},getWordsFromString:function(a){return this.webApi._getService("TextProcessor").getWordsFromString(a)},replaceSepatators:function(a){return this.webApi._getService("TextProcessor").replaceSepatators(a)},removeSpecialCharacters:function(a){return this.webApi._getService("TextProcessor").removeSpecialCharacters(a)},adapter:{spellCheck:function(a){return this.webApi.spellCheck(a)},grammarCheck:function(a){return this.webApi.grammarCheck(a)},getLangList:function(a){return this.webApi.getLangList(a)},getInfo:function(a){return this.webApi.getInfo(a)},getUserDictionary:function(a){return this.webApi.getUserDictionary(a)},createUserDictionary:function(a){return this.webApi.createUserDictionary(a)},deleteUserDictionary:function(a){return this.webApi.deleteUserDictionary(a)},addWordToUserDictionary:function(a){return this.webApi.addWordToUserDictionary(a)},deleteWordFromUserDictionary:function(a){return this.webApi.deleteWordFromUserDictionary(a)},renameUserDictionary:function(a){return this.webApi.renameUserDictionary(a)},getDictionariesModifyTime:function(a){return this.webApi.getDictionariesModifyTime(a)}}},a.WebApiAdapter=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){this.name=a,this.sandbox=c,b=c.RegularsManager};c.prototype={constructor:c,init:function(){this.createIgnoreElementsRegex("ignoreElements"),this.createIgnoreElementsRegex("ignoreGrammarElements"),b.wrap("aside|br|img|caption|button|address|blockquote|body|center|dir|div|dl|fieldset|form|h[1-6]|hr|isindex|menu|noframes|noscript|ol|p|pre|table|ul|dd|dt|frameset|li|tbody|td|tfoot|th|thead|tr|html|select|option|sup|sub|input").group().start().end().i().store("blockElementsRegex"),b.anyChar.compositionGraph([b.space,b.punctuationRegExp]).set().store("wordBoundaryRegex"),b.anyChar.compositionGraph([b.space,b.punctuationRegExp,b.quotes]).set().store("wordBoundaryRegexAndQuotes"),b.whiteSpace.start().set().onePlus().store("nonWhiteSpaceExtended"),b.sentenceEndChars.composition(b.wrap("\\u2029")).set().composition(b.space).more().end().g().store("sentenceEndCharsGrammar"),b.wrap(String.fromCharCode(160)).g().store("ieSeparator")},createIgnoreElementsRegex:function(a){var c,d=this.sandbox.getOption(a),e=["style","script"];if(""!==d){d=b.space.g().replace(d,""),c=b.comma.g().replace(d,"|");for(var f=0;f<e.length;f++){var g=b.wrap(e[f]).wrapWordBoundary().g();g.match(d)||(d=d+"|"+e[f])}}else d=e.join("|");return b.wrap(d).group().start().end().i().store(a+"Regex")}},a.RegExpressions=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.tasks={},this.taskCount=0};b.prototype={init:function(){this.sandbox.subscribe("taskEnded",function(a){this.taskEndedHandler(a.taskName)},this)},destroy:function(){this.unregisterAll()},taskEndedHandler:function(a){this.unregister(a,!0),0===this.taskCount&&this.sandbox.fire("spellCheckEnded",{})},register:function(a,c){return 0===this.taskCount&&this.sandbox.fire("spellCheckStarted",{}),c.single&&(this.unregister(a,!0),c.collection=["single"]),this.tasks[a]?this.tasks[a].extendCollection(c.collection):(this.tasks[a]=new b.Task(a,c,this.sandbox),this.taskCount++,this.tasks[a].startTask()),this.tasks[a]},unregister:function(a,b){this.tasks[a]&&(this.tasks[a].timeout&&(clearTimeout(this.tasks[a].timeout),this.tasks[a].timeout=null),this.taskCount--,!b&&this.tasks[a].onUnregister&&this.tasks[a].onUnregister.apply(this.tasks[a]),delete this.tasks[a])},unregisterAll:function(){for(var a in this.tasks)this.tasks.hasOwnProperty(a)&&this.unregister(a)}},b.Task=function(a,b,c){function d(a){return function(){a&&a.apply(this,arguments),this.endTask()}}var e=this;b=b||{},this.name=a,this.single=b.single||!1,this.collection=[].concat(b.collection||[]),this.delay=b.delay||0,this.partialItemsCount=b.partialItemsCount||1,this.deferredFunction=d(b.deferredFunction),this.defferedFunctionArgs=b.defferedFunctionArgs||[],this.timeout=void 0,this.onUnregister=b.onUnregister,this.getPartialItems=function(){return this.collection.splice(0,this.partialItemsCount||1)},this.runDeferredFunction=function(a){var b=this.deferredFunction.apply(this,[].concat([a],this.defferedFunctionArgs));return b},this.extendCollection=function(a){var b=[0,0];b.push.apply(b,a),this.collection.splice.apply(this.collection,b)},this.startTask=function(){this.timeout=setTimeout(function(){var a=e.getPartialItems();e.runDeferredFunction(a)},this.delay)},this.endTask=function(){this.timeout=null,this.collection.length>0?this.startTask():c.fire("taskEnded",{taskName:this.name})}},a.Deferred=b}(WEBSPELLCHECKER.CORE),function(){var a,b,c,d,c,e=WEBSPELLCHECKER.OptionsManager,f=WEBSPELLCHECKER.CORE.prototype.Utils,g=e.importOptionsTemplate("CoreTemplate"),h=e.optionTypes;a=f.getBaseData("wscbundle.js").path,a||(a=f.getBaseData("app.js").path),c={enableGrammar:{defaultValue:!1,type:h.boolean},autoStartup:{defaultValue:!1,type:h.boolean},theme:{defaultValue:"",type:h.string},charsToObserve:{defaultValue:"",type:h.string},basePath:{defaultValue:a,type:h.string},units:{defaultValue:["editableControls","spelling","ui"],type:h.array}},b=f.getLocationInfo(a),g.setDefaults({appType:"application"}),"file"!==b.protocol&&g.setDefaults({serviceProtocol:b.protocol,serviceHost:b.host,servicePort:b.port,servicePath:b.pathname+"./../script/ssrv.cgi",serviceId:""}),c=e.mergeOptionsTemplates(c,g),e.exportOptionsTemplate("AppTemplate",c),WEBSPELLCHECKER._createApp=function(b,c,e){function f(a){return a.map(function(a){return{name:a,module:I[a]}})}function g(a,b){for(var c=0;c<a.length;c+=1)if(a[c].name===b)return c;return-1}function h(a,b){for(var c,d,e,f=b.length-1;f>=0;f-=1)c=b[f],e=g(a,c),-1!==e&&(d=a[e],a.splice(e,1),a.unshift(d));return a}function i(a){for(var b,c=D.getOption("charsToObserve"),e=a.node,f=0;f<c.length;f++)b=D.Utils.findFirstNodeWithString(e,c[f].charCode),b&&d({charName:c[f].charName,node:b})}function j(a){c&&c(a)}function k(){return B.allModulesReady?void D.fire("startSpellCheck",{}):!1}function l(){return B.allModulesReady?void D.fire("startGrammarCheck",{}):!1}function m(){x(A),D.getOption("appStarted")?t(D):u(D),"function"==typeof b.onLoad&&b.onLoad.apply(O,arguments)}function n(a){{var c,d="",e={};G.importOptionsTemplate("AppTemplate")}if(a.disableOptionsStorage&&Array.isArray(a.disableOptionsStorage)){var f=a.disableOptionsStorage,g=["all","options","lang","ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers"],h=["lang","ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers"],i=function(a){return!!g.includes(a)},j=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=!!a.includes("options");if(!i(d)||e&&-1===h.indexOf("lang"))return;if(h.includes(d)&&h.splice(h.indexOf(d),1),"all"===d||e&&a.includes("lang"))return[];"options"===d&&(h=["lang"])}return b=b.concat(h)};b["options-to-restore"]=j(f),delete a.disableOptionsStorage}return a.container="[object String]"==Object.prototype.toString.call(a.container)?document.getElementById(a.container):a.container,e=G.createOptions(a,"AppTemplate",function(a){a.reports.forEach(function(a){a.critical&&(d+=a.message)},this)}),""!==d?c=new Error(d):(e.customDictionaryIds&&(e.customDictionaryIds=e.customDictionaryIds.replace(/\s/g,"")),e)}function o(a){for(var b in a.additionalActionItems)!function(b){a.additionalActionItems[b].onClick=function(){var c=a.additionalActionItems[b].onClick;return function(){var a=!0;return"function"==typeof c&&(a=c()),a}}()}(b);return a}function p(a,b,c){var d,e=(b.UILib,b.Utils),f=b.getOption("isIframe"),g=b.getOption("mirrorBasedInstance"),h=b.getOption("documentContainer"),i=b.getOption("container"),j=b.getOption("originalContainer");d=f?h:g?j:i,b.subscribe({eventType:"cutProcessed",handler:function(){b.fire("removeMarkupInSelectionNode",{}),setTimeout(function(){k(),l()},0)},context:c}),b.subscribe("removedMarkupInContainer",function(a){a.textChanged&&l()}),b.subscribe("pasteProcessed",function(){b.fire("removeMarkupInSelectionNode",{})},c),b.subscribe("afterPaste, garbageCollected",function(){k(),l()},c),z.includes("autoSearchCreation")&&b.subscribe("periodicalChecking",function(){e.isNodeAvailable(d)||O&&O.destroy&&O.destroy()},c)}function q(a){var b=a.Utils,c=a.UILib;b.Browser.ie&&(c.addClass("html","ie"+b.Browser.version),b.Browser.version<9&&c.addClass("html","lt-ie9")),b.isTouchDevice()&&c.addClass("html","touch")}function r(a,b){var c=a.UILib;c.attr(b,"aria-readonly",!1),c.attr(b,"spellcheck",!1)}function s(){var a,b,c=D.getSelection();if(c.rangeCount()>0&&(a=c.getRangeAt(0),b=a.toString(),!b&&0===a.getNodes().length))try{c.expand("word"),D.fire("selectionIsChanged",{})}catch(d){}}function t(a){v(a,!1),a.getOption("enableGrammar")&&w(a,!1),a.fire("startSpellCheck"),a.fire("startGrammarCheck"),a.setOption("appStarted",!0)}function u(a){a.fire("removeMarkupInDocument",{}),v(a,!0),w(a,!0),a.removeAllDeferredFunctions(),a.setOption("appStarted",!1)}function v(a,b){var c=["startSpellCheck","markupWords","removeMarkupInDocument","removeMarkupFromWords","removeMarkupInSelectionNode","replaceWord","ignoreWord","ignoreAllWords","collectWords","wordsCollected","misspelledWordsFound"];a[b?"blockEvents":"unblockEvents"](c)}function w(a,b){var c=["startGrammarCheck","markupPhrase","removeMarkupFromPhrases","removeGrammarMarkupInSelectionNode","replacePhrase","ignorePhrase","ignoreAllPhrases","sentencesCollected","getGrammarSuggestionsList","problemSentencesFound","collectSentences"];a[b?"blockEvents":"unblockEvents"](c)}function x(a){var b=D.getOption("grammarLangList"),c=D.getOption("lang");!a||c in b.ltr||c in b.rtl||(a=!1),D.setOption("enableGrammar",a),D.fire("enableGrammarChanged",{state:a}),w(D,!a)}var y,z,A,B,C,D,E=this,F=WEBSPELLCHECKER.CORE,G=(WEBSPELLCHECKER.logger,WEBSPELLCHECKER.OptionsManager),H=WEBSPELLCHECKER.CORE.prototype.Utils;if(y=n(b,this),y instanceof Error){if(C=y,!H.TypeChecker.isFunction(e))throw C;e(C)}z=y.units,A=z.includes("grammar")&&y.enableGrammar,z.includes("common")||z.unshift("common"),y=o(y),B=new F(y),D=new WEBSPELLCHECKER.CORE.Sandbox("APP",B),D.setOption("appStarted",y.autoStartup),b.appType&&D.setOption("appType",b.appType),H.isTouchDevice()&&D.setOption("isTouchDevice",!0);var I={Wrapper:F.Wrapper,Mirror:F.Mirror,IME:F.IME,StyleManager:F.StyleManager,LocalizationManager:F.LocalizationManager,Banner:F.Banner,FocusManager:F.FocusManager,AccessLimiter:F.AccessLimiter,WordsCollector:F.WordsCollector,WordsFinder:F.WordsFinder,Dictionary:F.DictionaryManager,Markup:F.Markup,WordsProcessor:F.WordsProcessor,DragAndDropManager:F.DragAndDropManager,UndoManager:F.UndoManager,DOMChangesListener:F.DOMChangesListener,SentencesCollector:F.SentencesCollector,SentencesDictionary:F.GrammarDictionaryManager,GrammarPhrasesFinder:F.GrammarPhrasesFinder,SentencesProcessor:F.SentencesProcessor,GrammarMarkup:F.GrammarMarkup,MaxLength:F.MaxLength,KeyboardManager:F.KeyboardManager,UserActions:F.UserActions,InfoGetter:F.InfoGetter,GarbageCollector:F.GarbageCollector},J=[];F.UI&&Object.assign(I,{ContextMenu:F.UI.ContextMenu,Badge:F.UI.Badge,PasteDialogWidget:F.UI.PasteDialogWidget,BaseDialogWidget:F.UI.BaseDialogWidget,BadgeWidget:F.UI.BadgeWidget,ContextMenuWidget:F.UI.ContextMenuWidget});var K={spelling:["WordsCollector","WordsFinder","Dictionary","Markup","WordsProcessor"],grammar:["SentencesCollector","SentencesDictionary","GrammarPhrasesFinder","SentencesProcessor","GrammarMarkup"],ui:["ContextMenu","ContextMenuWidget","FocusManager","PasteDialogWidget","BaseDialogWidget","Badge","BadgeWidget","DOMChangesListener"],common:["IME","Banner","InfoGetter","AccessLimiter","UserActions","StyleManager","LocalizationManager","KeyboardManager"],editableControls:["Wrapper","UndoManager","DragAndDropManager","MaxLength"],autoSearchCreation:["Mirror","GarbageCollector"]},L=["Wrapper","Mirror"];D.subscribe("afterDrop",m),D.subscribe("allModulesReady",m),D.subscribe("allModulesReady",function(){z.includes("editableControls")&&B.clipboardManager.add(D,D.getOption("container"),D.isOriginalContainerTextBased()),z.includes("ui")&&(this.contextMenu=B.getService("ContextMenu"),q(D),p(b,D,this,B.clipboardManager)),O&&(j(O),D.Utils.Browser.edge&&D.getOption("isIframe")&&!D.getOption("documentContainer").contentDocument.doctype&&D.UILib.addClass(D.getOption("container"),D.getOption("iframe_quirks_class")),D.UILib.addClass(D.getOption("container"),D.getOption("instance_class")),D.isOriginalContainerTextBased()&&D.UILib.addClass(D.getOption("originalContainer"),D.getOption("instance_class"))),D.subscribe({eventType:"dblclick",element:D.getOption("container"),handler:s})}),D.subscribe("removedMarkupInContainer",i),D.subscribe("markupedNode",i),z.forEach(function(a){J=J.concat(f(K[a]))}),Array.isArray(b.extraModules)&&(J=J.concat(f(b.extraModules))),J=h(J,L),B.initModules(J),B.instanceManager.add(D);var M=D.getOption("container");r(D,M),D.subscribe("commitOptions",function(a){var b=a.changedOptions;if(!H.objectIsEmpty(b)){b.lang&&b.lang!==D.getOption("lang")&&(D.fire("removeMarkupInDocument",{}),D.removeAllDeferredFunctions()),D.setPaused(!0);var c=F.DictionaryManager.Dictionary,d=D.getOption("lang");c.each(d,function(a){a.getStatus(D.getOption("uid"))==F.DictionaryManager.wordStatus.inprocess&&a.setStatus(F.DictionaryManager.wordStatus.unknown,D.getOption("uid"))});for(var e in b)b.hasOwnProperty(e)&&D.setOption(e,b[e]);D.setPaused(!1),x(A),k(),l()}},E),D.subscribe({eventType:"toggleApp",handler:function(a){var b=a.flag;b?t(D):u(D)}}),D.getLocal=function(a){return D.Localization.getLocal(a,D.getOption("localization"))};var N,O={isAllModulesReady:function(){return B.allModulesReady},reloadMarkup:function(){k(),l()},replaceSelectionNode:function(a){var b=a&&a.word?"replaceWord":"replacePhrase";D.fire(b,a)},getSuggestions:function(a){var b=B.getService("Dictionary"),c=B.getService("SentencesDictionary"),d=a&&a.word?b.getWordFromDictionary(a.word,a.lang):c.getPhraseFromDictionary(a.phrase,a.lang),e=d&&d.suggestions?d.suggestions:null;return e},ignoreWord:function(){D.fire("ignoreWord")},ignorePhrase:function(){D.fire("ignorePhrase")},ignoreAllPhrases:function(a){D.fire("ignoreAllPhrases",a)},addWordToUserDictionary:function(a,b,c){D.fire("addWordToUserDictionary",{word:a,onSuccess:b,onError:c})},deleteWordFromUserDictionary:function(a,b,c){D.fire("deleteWordFromUserDictionary",{word:a,onSuccess:b,onError:c})},ignoreAllWords:function(){D.fire("ignoreAllWords")},removeMarkupInSelectionNode:function(a){var b=a&&a.grammarOnly?"removeGrammarMarkupInSelectionNode":"removeMarkupInSelectionNode";D.fire(b,a)},destroy:function(){{var a=D.UILib,b=D.Utils;D.getOption(D.getOption("isIframe")?"documentContainer":"container")}D.getOption("paused")&&D.setPaused(!1),b.isInPage(D.getMainContainer())&&D.fire("removeMarkupInDocument",{}),z.includes("editableControls")&&B.clipboardManager.remove(D.getOption("uid")),B.instanceManager.remove(D.getOption("uid")),D.unsubscribe({eventType:"dblclick",element:D.getOption("container"),handler:s}),B.destroyModules(),D.setPaused(!0),a.removeAttr(D.getOption("originalContainer"),"data-spelling"),D.Utils.Browser.edge&&D.getOption("isIframe")&&!D.getOption("documentContainer").contentDocument.doctype&&D.UILib.removeClass(D.getOption("container"),D.getOption("iframe_quirks_class")),a.removeClass(D.getOption("container"),D.getOption("instance_class")),D.isOriginalContainerTextBased()&&a.removeClass(D.getOption("originalContainer"),D.getOption("instance_class"));for(var c in this)this.hasOwnProperty(c)&&delete this[c]},getSpellingLangList:function(){return D.getOption("spellingLangList")},getGrammarLangList:function(){return D.getOption("grammarLangList")},getApplicationConfig:function(){return D.getOption(["ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers"])},getLang:function(){return D.getOption("lang")},setLang:function(a){D.fire("commitOptions",{changedOptions:{lang:a}})},commitOption:function(a){a.changedOptions||(a.changedOptions=a),D.fire("commitOptions",a)},getOption:function(a){return D.getOption(a)},getUserDictionaryName:function(){return D.getOption("userDictionaryName")},createUserDictionary:function(a,b,c){D.fire("createUserDictionary",{name:a,onSuccess:b,onError:c})},restoreUserDictionary:function(a,b,c){D.fire("restoreUserDictionary",{name:a,onSuccess:b,onError:c})},disconnectFromUserDictionary:function(a,b,c){D.fire("disconnectFromUserDictionary",{name:a,onSuccess:b,onError:c})},renameUserDictionary:function(a,b,c){D.fire("renameUserDictionary",{newName:a,onSuccess:b,onError:c})},removeUserDictionary:function(a,b,c){D.fire("removeUserDictionary",{name:a,onSuccess:b,onError:c})},setUserDictionaryName:function(a){D.fire("setUserDictionaryName",{name:a})},isUserDictionaryExist:function(){return"string"==typeof D.getOption("userDictionaryName")},removeMarkupFromString:function(a){return D.removeMarkupFromString(a)},getLogo:function(){return D.getOption("basePath")+D.getOption("wscLogo")},getVersion:function(){return D.getOption("wscVersion")},getBrandingInfo:function(){return{wscSupportUrl:D.getOption("wscSupportUrl")}},isSpellingNode:function(a){var b=D.getOption("data_attribute_name");return H.isEqualNode(a,b)},isGrammarNode:function(a){var b=D.getOption("problem_grammar_data_attribute");return H.isEqualNode(a,b)},findSpellingNode:function(a){for(var b=0;b<a.length;b++)if(this.isSpellingNode(a[b]))return a[b];return null},addMarkupHandler:function(a){d=a},setMarkupPaused:function(a){a?(D.setPaused(!0),D.removeAllDeferredFunctions()):(D.setPaused(!1),k(),l())},subscribe:function(a,b){D.subscribe(a,b)},fire:function(a,b){D.fire(a,b)},getLangAttribute:function(){return D.getOption("data_lang_attribute")},getUserDictionary:function(a,b){D.fire("getUserDictionary",{name:a,callback:b})},showBanner:function(a){D.fire("showBanner",{contextMenuContainerSelector:a})},hideBanner:function(){D.fire("hideBanner",{})},getProblemDescriptionText:function(a,b,c){var d=F.GrammarDictionaryManager&&F.GrammarDictionaryManager.Dictionary;return d?d.getProblemDescription(a,b,c):""},findNodeWithChar:function(a,b){return D.Utils.findFirstNodeWithString(a,b.charCode)},getAttributeInfo:function(){return{data_attribute_name:D.getOption("data_attribute_name"),misspelled_word_class:D.getOption("misspelled_word_class"),problem_grammar_data_attribute:D.getOption("problem_grammar_data_attribute"),problem_grammar_class:D.getOption("problem_grammar_class")}
},isBannerEnable:function(){return D.getOption("banner")},findGrammarNode:function(a){for(var b=0;b<a.length;b++)if(this.isGrammarNode(a[b]))return a[b];return null},getProblemNodeFromSelection:function(){var a;return a=D.getSpellingNodeFromSelection(),a||(a=D.getGrammarNodeFromSelection()),a},getCustomDictionary:function(){return D.getOption("customDictionaryIds")},getSpellingNodeAttributeName:function(){return D.getOption("data_attribute_name")},getNodeAttribute:function(){return this.getSpellingNodeAttributeName()},getGrammarNodeAttributeName:function(){return D.getOption("problem_grammar_data_attribute")},getGrammarNodeRuleAttributeName:function(){return D.getOption("problem_grammar_data_attribute_rule")},getContainerNode:function(){return D.getOption("container")},getLocal:function(a){return D.Localization.getLocal(a,D.getOption("localization"))},isDisabled:function(){return!D.getOption("appStarted")},setDisabled:function(a){D.getOption("appStarted")===a&&(a?u(D):t(D))},getProblemsCount:function(){for(var a=D.getSpellingNodesInElement(),b=D.getGrammarNodesInElement(),c=a.concat(b),d=0,e=0,f=c.length;f>e;e++)c[e].innerHTML&&d++;return d},fixBrokenNodes:function(a){D.fire("fixBrokenNodes",{container:a})},fixProblemNodesInElement:function(a){var b=D.getBrokenSpellingNodes(a),c=D.getBrokenGrammarNodes(a);b&&(D.fire("removeMarkup",{nodes:b,spelling:!0}),this.reloadMarkup()),c&&(D.fire("removeMarkup",{nodes:c,grammar:!0}),this.reloadMarkup())}};return D.instance=O,O.basePath=a,N=D.getOption(D.getOption("isIframe")?"documentContainer":"originalContainer"),D.originalElementId=D.UILib.attr(N,"id"),O._sandbox=D,O._getService=function(a){return B.getService(a)},B.allModulesReady&&j(O),O}}(),"undefined"==typeof WEBSPELLCHECKER.CORE.includeRequiredUI&&(WEBSPELLCHECKER.CORE.includeRequiredUI=!0),function(a){"use strict";var b;if(!a.DictionaryManager){var c=function(a,d){this.name=a,this.sandbox=d,this.isCacheEnabled=d.getOption("enableCache")&&!d.getOption("customDictionaryIds"),b=this.sandbox.Utils,this.userDictionaryManager=new c.UserDictionaryManager(this.sandbox)};c.wordStatus={unknown:0,misspelled:1,ignored:2,inprocess:3,correct:4,userDictionary:5,userIgnore:6},c.prototype={init:function(){this.sandbox.subscribe("wordsCollected",function(a){this.wordsCollectedHandler(a.wordsCollection)},this),this.sandbox.subscribe("getUserDictionaryName",function(a){this.userDictionaryManager.getUserDictionaryName(a)}),this.sandbox.subscribe("getUserDictionary",function(a){this.userDictionaryManager.getUserDictionary(a)}),this.sandbox.subscribe("createUserDictionary",function(a){this.userDictionaryManager.createUserDictionary(a)}),this.sandbox.subscribe("restoreUserDictionary",function(a){var b=a.onSuccess||function(){},c=this;a.onSuccess=function(a){b(a),c.userDictionaryStateRestoredHandler(a)},this.userDictionaryManager.getUserDictionaryFromServer(a)}),this.sandbox.subscribe("renameUserDictionary",function(a){this.userDictionaryManager.renameUserDictionary(a)}),this.sandbox.subscribe("removeUserDictionary",function(a){this.userDictionaryManager.removeUserDictionary(a)}),this.sandbox.subscribe("disconnectFromUserDictionary",function(a){this.userDictionaryManager.disconnectFromUserDictionary(a)}),this.sandbox.subscribe("setUserDictionaryName",function(a){this.userDictionaryManager.setUserDictionaryName(a.name)}),this.sandbox.subscribe("userDictionaryChanged",function(){this.userDictionaryManager.setUserDictionaryNameFromStorage()}),this.sandbox.subscribe("userDictionaryStateChanged",function(){this.userDictionaryStateChangedHandler()}),this.sandbox.subscribe("userDictionaryStateRestored",function(a){this.userDictionaryStateRestoredHandler(a)}),this.sandbox.subscribe("addWordToUserDictionary",function(a){this.addWordToUserDictionaryHandler(a)}),this.sandbox.subscribe("deleteWordFromUserDictionary",function(a){this.userDictionaryManager.deleteWordFromUserDictionary(a)}),this.sandbox.subscribe("getSuggestionsList",function(a){this.getSuggestionsListHandler(a.word,a.lang)},this),this.sandbox.subscribe({eventType:"unload",element:window,handler:this.saveCache}),this.restoreCache()},saveCache:function(){this.isCacheEnabled&&c.Cache.saveCache()},restoreCache:function(){this.isCacheEnabled&&c.Cache.restoreCache()},getCachedWord:function(a,b){return this.isCacheEnabled&&c.Cache.getWord(a,b)},addWordToCache:function(a,b){this.isCacheEnabled&&c.Cache.addWord(a,b)},wordsCollectedHandler:function(a){var b,c;for(var d in a.detectedLanguages)b=this.addWordsToDictionary(a.words,d),c=this.getUnknownWords(d),this.getWordsInfo(c,d),this.precessIgnoredWords(b.ignored,d),this.processWithTimeout(b.misspelled,d)},userDictionaryStateChangedHandler:function(){for(var a=(this.Dictionary,this.getUdWordsFromDictionary()),b=0;b<a.length;b++)a[b].setStatusForAllInstances(c.wordStatus.unknown);this.sandbox.fire("startSpellCheck")},addWordToUserDictionaryHandler:function(a){var b,c=this.sandbox.getOption("data_attribute_name"),d=this.sandbox.getOption("container");b=a.spellingNode?a.spellingNode:this.sandbox.getSpellingNodeFromSelection(),a.word?this.userDictionaryManager.addWordToUserDictionary(a):b&&d.contains(b)&&(a.word=b.getAttribute(c),this.userDictionaryManager.addWordToUserDictionary(a)),a.word&&this.sandbox.fireInAllApps("removeMarkupFromWords",{words:[{word:a.word}]})},getSuggestionsListHandler:function(a,b){var c=this.getWordFromDictionary(a,b);this.sandbox.fire("suggestionListSend",{suggestionList:c?c.suggestions:[]})},userDictionaryStateRestoredHandler:function(a){for(var b,d,e=this,f=this.getUdWordsFromDictionary(),g=(this.sandbox.getOption("userDictionaryName"),c.Dictionary),h=a.wordlist,i=0;i<f.length;i++)f[i].setStatusForAllInstances(c.wordStatus.unknown);for(i=0,d=h.length;d>i;i++)if(b=g.getAllWordsByName(h[i]),b.length>0)for(var j=0;j<b.length;j++)b[j].setStatusForAllInstances(c.wordStatus.unknown);e.sandbox.fireInAllApps("removeMarkupInDocument"),e.sandbox.fireInAllApps("startSpellCheck")},getWordFromDictionary:function(a,b){var d=c.Dictionary;return d.getWord(a,b)},addWordsToDictionary:function(a,b){var d=c.Dictionary,e=this.sandbox.getOption("uid"),f=this.sandbox.getOption("customDictionaryIds")||"",g={unknown:[],misspelled:[],ignored:[]};for(var h in a){var i=a[h].word,j=d.getWord(i,b);j||(j=d.addWord(i,b)),0==j.existsInInstance(e)&&(j.addToInstance(e),j.addCustomDictionariesInInstance(f,e)),j.getStatus(e)==c.wordStatus.ignored&&j.resetStatus(e),this.sandbox.getOption("ignoreAllCapsWords")===!0&&j.word.toUpperCase()!=j.word.toLowerCase()&&j.word==j.word.toUpperCase()&&j.setStatus(c.wordStatus.ignored,e),this.sandbox.getOption("ignoreWordsWithMixedCases")===!0&&j.word==j.word.toLowerCase()==0&&j.word==j.word.toUpperCase()==0&&(j.word.split("")[0]!=j.word.split("")[0].toUpperCase()||j.word.split("").slice(1).join("")!=j.word.split("").slice(1).join("").toLowerCase())&&j.setStatus(c.wordStatus.ignored,e),this.sandbox.getOption("ignoreWordsWithNumbers")===!0&&j.word.replace(/[0-9]/g,"")!=j.word&&j.setStatus(c.wordStatus.ignored,e),this.sandbox.getOption("ignoreDomainNames")===!0&&j.word.replace(/\./g,"")!=j.word&&j.setStatus(c.wordStatus.ignored,e),j.getStatus(e)===c.wordStatus.inprocess&&j.isNeedGetWordInfo(e)&&j.setStatus(c.wordStatus.unknown,e),j.getStatus(e)==c.wordStatus.ignored&&g.ignored.push(j),j.getStatus(e)==c.wordStatus.unknown&&g.unknown.push(j),j.getStatus(e)==c.wordStatus.misspelled&&g.misspelled.push(j)}return g},getWordsFromDictionaryByStatus:function(a,b){var d=this.sandbox.getOption("uid"),e=c.Dictionary;return e.getWordsFromDictionaryByStatus(a,d,b)},getUnknownWords:function(a){var b=this.getWordsFromDictionaryByStatus(a,c.wordStatus.unknown);return b},getMisspelledWords:function(a){var b=this.getWordsFromDictionaryByStatus(a,c.wordStatus.misspelled);return b},getUdWordsFromDictionary:function(){var a=c.Dictionary;return a.getAllWordsByStatus(c.wordStatus.userDictionary)},precessIgnoredWords:function(a,b){var c=this;this.sandbox.addDeferredFunction("preocessIgnoredWordsForLang_"+b,{delay:100,collection:a,partialItemsCount:100,defferedFunctionArgs:[b],deferredFunction:function(a){c.sandbox.fire("removeMarkupFromWords",{words:a})}})},processWithTimeout:function(a,b){var d=this;this.sandbox.addDeferredFunction("precessWordsForLang_"+b,{delay:100,collection:a,partialItemsCount:2,defferedFunctionArgs:[b],deferredFunction:function(a,b){for(var e=0;e<a.length;)a[e].getStatus(d.sandbox.getOption("uid"))!=c.wordStatus.misspelled?a.splice(e,1):e++;0!==a.length&&d.sandbox.fire("misspelledWordsFound",{words:a,lang:b})}})},getWordsInfo:function(a,b){function d(a,b){for(var c=0;c<a.length;c++)a[c].setGlobalStatus(b)}function e(a,b){for(var c={},d=0;d<a.length;d++)c[b+a[d].word]=a[d];return c}function f(a,b,d,e){a.setStatusForAllInstancesWithSuchCustomDictionary(c.wordStatus.misspelled,e),a.suggestions=d[j+a.word].suggestions,b.push(a)}function g(a,b,d){b?a.setStatusForAllInstances(c.wordStatus.userDictionary):d?a.setStatusForAllInstancesWithSuchCustomDictionary(c.wordStatus.correct,d):a.setGlobalStatus(c.wordStatus.correct)}var h,i=this,j="word_",k=this.sandbox.getOption("spellingLangList"),l=this.sandbox.fire("getWordsLimit").data,m=this.sandbox.getOption("uid"),n=[],o=[],p={},q=[];if(a=a||[],0!==a.length){if("number"==typeof l){if(0===l)return;a.length=a.length>l?l:a.length,this.sandbox.fire("sentWordsCount",{count:a.length})}if(!k)return void console.warn("Webspellchecker: Spellcheck lang list not defined.");if(!(b in k.ltr||b in k.rtl))return void this.sandbox.console.warn('Specified "'+b+'" language is not supported for your Customer ID. More details at http://wiki.webspellchecker.net or contact support@webspellchecker.net');for(var r=0;r<a.length;r++)h=this.getCachedWord(a[r].word,b),h?o.push(h):(a[r].setGlobalStatus(c.wordStatus.inprocess),a[r].setInProcess(m),n.push(a[r]));if(0!==o.length){var s=i.sandbox.getOption("customDictionary")||"";p=e(o,j);for(var r=0;r<a.length;r++){var t=a[r].word,u=p[j+t]&&"true"==p[j+t].ud;p[j+t]&&(p[j+t].suggestions&&!u?f(a[r],q,p,s):g(a[r],u,s))}0!==q.length&&this.sandbox.fireInAllApps("misspelledWordsFound",{words:q,lang:b})}0!==n.length&&this.sandbox.addDeferredFunction("getWordsInfoForLang_"+b,{delay:500,collection:n,partialItemsCount:10,defferedFunctionArgs:[b],onUnregister:function(){var a=this;d(a.collection,c.wordStatus.unknown)},deferredFunction:function(a,b){for(var h=[],k=0;k<a.length;k++)h.push(a[k].word);i.sandbox.getOption("userDictionaryName");return i.sandbox.fire("remoteAction",{actionMethod:"spellCheck",userWordlist:i.userDictionaryManager.getWordsFromUserDictionary(),text:h.join(","),lang:b,onSuccess:function(c){var d=i.sandbox.getOption("uid"),h=i.sandbox.getOption("customDictionaryIds")||"",l={},m=[];for(l=e(c,j),k=0;k<a.length;k++){var n=a[k].word,o=l[j+n]&&l[j+n].ud===!0;l[j+n]?i.addWordToCache(l[j+n],b):i.addWordToCache({word:n},b),l[j+n]&&!o?f(a[k],m,l,h):g(a[k],o,h),a[k].removeFromProcess(d)}0!==m.length&&i.sandbox.fireInAllApps("misspelledWordsFound",{words:m,lang:b}),i.sandbox.setOption("numberOfFailedRequest",0)},onError:function(){var e=i.sandbox.getOption("uid"),f=i.sandbox.getOption("numberOfFailedRequest");if(i.sandbox.setOption("numberOfFailedRequest",++f),f>4){i.sandbox.setPaused(!0),i.sandbox.removeAllDeferredFunctions();for(var g=0;g<a.length;g++)a[g].removeFromProcess(e);d(a,c.wordStatus.unknown)}else i.getWordsInfo(a,b)}}),!0}})}}},c.UserDictionaryManager=function(a){this.sandbox=a,this.isCacheEnabled=a.getOption("enableCache")&&!a.getOption("customDictionaryIds"),this.init()},c.UserDictionaryManager.prototype={init:function(){var a,b,d=[],e=(this.sandbox.getOption("lang"),this.sandbox.getOption("uid"),c.Dictionary),f=e.getAllWordsByStatus(c.wordStatus.userDictionary),g=this;for(this.userDictionaryName=this.sandbox.getOption("userDictionaryName"),this.userDictionaryKey=this.sandbox.getOption("userDictionaryKey"),this.userDictionaryNameKey=this.sandbox.getOption("userDictionaryNameKey"),b=0;b<f.length;b++)f[b].setStatusForAllInstances(c.wordStatus.unknown);if(!("string"==typeof this.userDictionaryName&&this.userDictionaryName.length>0)){try{d=this.sandbox.DataStorage.getData(this.userDictionaryKey),null==d&&(d=[],this.sandbox.DataStorage.setData(this.userDictionaryKey,d))}catch(h){this.sandbox.DataStorage.setData(this.userDictionaryKey,d)}a=this.sandbox.DataStorage.getData(this.userDictionaryNameKey),"string"==typeof a&&null!=a&&a.length>0?(this.userDictionaryName=a,this.sandbox.setOption("userDictionaryName",this.userDictionaryName),this.getUserDictionaryFromServer({name:a,onSuccess:function(a){for(var b=a.wordlist,d=0,h=b.length;h>d;d++)if(f=e.getAllWordsByName(b[d]),f.length>0)for(var i=0;i<f.length;i++)f[i].setStatusForAllInstances(c.wordStatus.userDictionary);g.setUdCache(b)}})):this.sandbox.DataStorage.setData(this.userDictionaryNameKey,null)}for(var b=0,i=d.length;i>b;b++)if(f=e.getAllWordsByName(d[b]),f.length>0)for(var j=0;j<f.length;j++)f[j].setStatusForAllInstances(c.wordStatus.userDictionary);!this.userDictionaryName&&this.setUdCache(d)},onSuccessCallback:function(a,b,c){switch("function"==typeof b.onSuccess&&b.onSuccess(c),a){case"createUserDictionary":this.setUserDictionaryName(c.name),this.sandbox.fireInAllApps("userDictionaryChanged");break;case"deleteUserDictionary":this.setUserDictionaryName(""),this.sandbox.fireInAllApps("userDictionaryChanged"),this.sandbox.fire("userDictionaryStateChanged");break;case"renameUserDictionary":this.setUserDictionaryName(c.name),this.sandbox.fireInAllApps("userDictionaryChanged");break;case"getUserDictionary":this.setUserDictionaryName(c.name),this.sandbox.fireInAllApps("userDictionaryChanged")}this.clearUserDictionary(),this.updateUdCache(c)},onErrorCallback:function(a,b){"function"==typeof a.onError&&a.onError(b)},setUdCache:function(a){this.isCacheEnabled&&c.Cache.setUdCache(a)},updateUdCache:function(a){this.isCacheEnabled&&("disconnect"===a.action||"delete"===a.action?c.Cache.clearUdCache():(c.Cache.setUdState(!1),c.Cache.updateUdCache(a.wordlist)))},addWordToUdCache:function(a){this.isCacheEnabled&&c.Cache.addWordToUdCache(a)},deleteWordFromUdCache:function(a){this.isCacheEnabled&&c.Cache.deleteWordFromUdCache(a)},remoteAction:function(a,c){c=c||{};var d=this,e={actionMethod:a,name:c.name||this.sandbox.getOption("userDictionaryName")};for(var f in c)b.TypeChecker.isFunction(c[f])===!1&&(e[f]=c[f]);e.onSuccess=function(b){d.onSuccessCallback(a,c,b)},e.onError=function(a){c.onError?c.onError(a):d.onErrorCallback(c,a)},this.sandbox.fire("remoteAction",e)},createUserDictionary:function(a){a.wordList=this.getWordsFromUserDictionary(),this.remoteAction("createUserDictionary",a)},removeUserDictionary:function(a){this.remoteAction("deleteUserDictionary",a)},renameUserDictionary:function(a){this.remoteAction("renameUserDictionary",a)},getUserDictionaryFromServer:function(a){this.remoteAction("getUserDictionary",a)},addWordToUserDictionaryServer:function(a){var b=this;this.remoteAction("addWordToUserDictionary",{word:a.word,onSuccess:function(c){"function"==typeof a.onSuccess&&a.onSuccess(c),b.clearUserDictionary()},onError:a.onError})},deleteWordFromUserDictionaryServer:function(a){var b=this;this.remoteAction("deleteWordFromUserDictionary",{word:a.word,onSuccess:function(c){"function"==typeof a.onSuccess&&a.onSuccess(c),b.sandbox.fireInAllApps("startSpellCheck")},onError:a.onError})},disconnectFromUserDictionary:function(){this.setUserDictionaryName(""),this.sandbox.DataStorage.setData(this.userDictionaryKey,[]),this.sandbox.fireInAllApps("userDictionaryChanged"),this.sandbox.fire("userDictionaryStateChanged"),this.updateUdCache({action:"disconnect"})},getUserDictionary:function(a){var b=this.sandbox.DataStorage.getData(this.userDictionaryKey),c=a.name||this.sandbox.getOption("userDictionaryName");null==b&&(b=[]),this.checkUserDictionaryName(c)?this.getUserDictionaryFromServer({name:c,onSuccess:a.callback}):"function"==typeof a.callback&&a.callback({wordlist:b})},addWordsToUserDictionary:function(a){for(var b=0;b<a.length;b++)this.addWordToUserDictionary({word:a[b]})},getWordsFromUserDictionary:function(){var a=this.sandbox.DataStorage.getData(this.userDictionaryKey);return null==a&&(a=[]),a.join()},checkUserDictionaryName:function(a){var b;return b="string"==typeof a&&""!==a&&a.length>0?!0:!1},setWordStatus:function(a,b){var d,e,f=c.Dictionary,g=f.getDictionary();for(var h in g)if(e=f.getWord(a,h)){switch(b){case"userDictionary":d=c.wordStatus.userDictionary;break;case"unknown":d=c.wordStatus.unknown;break;default:d=c.wordStatus.unknown}e.setStatusForAllInstances(d)}},addWordToUserDictionary:function(a){var b=this.sandbox.DataStorage.getData(this.userDictionaryKey);null==b&&(b=[]),this.checkUserDictionaryName(this.sandbox.getOption("userDictionaryName"))?(this.addWordToUserDictionaryServer(a),this.setWordStatus(a.word,"userDictionary")):b.includes(a.word)||(b.push(a.word),this.sandbox.DataStorage.setData(this.userDictionaryKey,b),this.setWordStatus(a.word,"userDictionary"),"function"==typeof a.onSuccess&&a.onSuccess({})),this.addWordToUdCache(a.word)},deleteWordFromUserDictionary:function(a){var b,c=this.sandbox.DataStorage.getData(this.userDictionaryKey);null==c&&(c=[]),this.checkUserDictionaryName(this.sandbox.getOption("userDictionaryName"))?(this.deleteWordFromUserDictionaryServer(a),this.setWordStatus(a.word,"unknown"),this.deleteWordFromUdCache(a.word)):(b=c.indexOf(a.word),-1!==b&&(c.splice(b,1),this.sandbox.DataStorage.setData(this.userDictionaryKey,c),this.setWordStatus(a.word,"unknown"),this.deleteWordFromUdCache(a.word),"function"==typeof a.onSuccess&&a.onSuccess({}),this.sandbox.fireInAllApps("startSpellCheck")))},clearUserDictionary:function(){this.sandbox.DataStorage.setData(this.userDictionaryKey,[])},setUserDictionaryName:function(a){this.sandbox.DataStorage.setData(this.userDictionaryNameKey,a),this.sandbox.setOption("userDictionaryName",a)},setUserDictionaryNameFromStorage:function(){this.sandbox.setOption("userDictionaryName",this.sandbox.DataStorage.getData(this.userDictionaryNameKey)),this.setUserDictionaryName(this.sandbox.DataStorage.getData(this.userDictionaryNameKey))}},c.Dictionary=c.Dictionary||function(){var a={},b="word_";return{getWord:function(c,d){return a[d]&&a[d][b+c]},getWordsFromDictionaryByStatus:function(a,b,c){var d=[];return this.each(a,function(a){a.getStatus(b)==c&&d.push(a)}),d},getAllWordsByStatus:function(b){var c=[];for(var d in a)this.each(d,function(a){a.hasStatusInAnyInstance(b)&&c.push(a)});return c},getAllWordsByName:function(c){var d=[];for(var e in a)a[e][b+c]&&d.push(a[e][b+c]);return d},setStatusToWords:function(a,b,c,d){for(var e=0;e<a.length;e++)this.getWord(a[e],c)||this.addWord(a[e],c),this.getWord(a[e],c).setStatus(b,d)},getDictionary:function(){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},addWord:function(d,e){var f=new c.Word(d);return a[e]=a[e]||{},a[e][b+d]=f},each:function(b,c){if("function"==typeof c)for(var d in a[b])c(a[b][d])},clear:function(){a={}}}}(),c.Word=function(a){var b,c={},d={},e={},f={};this.word=a,this.suggestions=[],this.getStatus=function(a){var b;return"undefined"!=typeof c[a]&&(b=c[a]),b},this.hasStatusInAnyInstance=function(a){var b=!1;if("undefined"!=typeof a)for(var e in d)if(c[e]===a){b=!0;break}return b},this.resetStatus=function(a){"undefined"!=typeof b&&"undefined"!=typeof a?this.setStatus(b,a):"undefined"!=typeof a&&this.setStatus(0,a)},this.setGlobalStatus=function(a){if("undefined"!=typeof a){b=a;for(var e in d)(0==c[e]||3==c[e])&&(c[e]=b)}},this.setStatusForAllInstances=function(a){if("undefined"!=typeof a)for(var b in d)c[b]=a},this.setStatusForAllInstancesWithSuchCustomDictionary=function(a,b){if("undefined"!=typeof a)for(var f in d)e[f]===b&&(0==c[f]||3==c[f])&&(c[f]=a)},this.setStatus=function(a,b){"undefined"!=typeof a&&"undefined"!=typeof b&&(c[b]=a)},this.addCustomDictionariesInInstance=function(a,b){"undefined"!=typeof b&&(e[b]=a)},this.setInProcess=function(a){"undefined"==typeof a||f[a]||(f[a]=!0)},this.removeFromProcess=function(a){"undefined"!=typeof a&&f[a]&&delete f[a]},this.isNeedGetWordInfo=function(a){if("undefined"!=typeof a){if(f[a])return!1;for(var b in f)if(e[b]===e[a])return!1;return!0}},this.addToInstance=function(a){d[a]=this.word,this.resetStatus(a)},this.existsInInstance=function(a){return d[a]?!0:!1}},c.Cache=c.Cache||function(){var b={words:{},length:0},d={},e="word_",f="wsc_dictionary_cache",g=a.prototype.Utils.isLocalStorageSupported(),h=!1,i=!1,j=!1;return{getWord:function(a,c){var f;if(j&&b.words[c]){if(f=b.words[c][e+a],!f)return;return f.ud=d[e+f.word]?"true":"false",f}},addWord:function(a,c){b.length>=4e3||(b.words[c]=b.words[c]||{},b.words[c][e+a.word]||(b.words[c][e+a.word]=a,b.length++))},clear:function(){b={words:{},length:0}},saveCache:function(){var a;if(g&&!i)try{i=!0,a=window.localStorage.getItem(f),a&&window.localStorage.setItem(f,JSON.stringify(b))}catch(c){}},restoreCache:function(){if(g&&!h)try{h=!0,b=JSON.parse(window.localStorage.getItem(f)),b||(c.Cache.clear(),window.localStorage.setItem(f,JSON.stringify(b)))}catch(a){}},setUdCache:function(a){this.setUdState(!0);for(var b=0;b<a.length;b++)d[e+a[b]]=!0},updateUdCache:function(a){this.clearUdCache(),this.setUdCache(a)},clearUdCache:function(){d={}},setUdState:function(a){j=a},isUdCached:function(){return j},addWordToUdCache:function(a){d[e+a]=!0},deleteWordFromUdCache:function(a){d[e+a]&&delete d[e+a]}}}(),a.DictionaryManager=c}}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.definition={}};b.prototype={constructor:b,init:function(){function a(a){function c(){window.alert(a),b.fire("restoreSelection")}b.Utils.Browser.gecko?setTimeout(c,10):c()}var b=this.sandbox,c=!1,d=!1;b.subscribe("undoRedoPosibility",function(a){c=a.canUndo,d=a.canRedo}),b.subscribe("getUserActions",function(a){var b=a.types,c=b?this.getUserActions(b):this.actionsTypes;a.setReturnedData({actionTypes:c})}),this.actionsTypes={spelling:{ignore:{handler:function(a){b.fire("restoreSelection"),b.fire("ignoreWord",{spellingNode:a.problemNode})}},ignoreAll:{handler:function(a){b.fire("restoreSelection"),b.fire("ignoreAllWords",{spellingNode:a.problemNode})}},addWord:{handler:function(a){b.fire("restoreSelection"),setTimeout(function(){b.fire("addWordToUserDictionary",{spellingNode:a.problemNode})},10)}}},grammar:{problemdescription:{isDisabled:function(){return!0},handler:function(){}},ignore:{handler:function(a){b.fire("restoreSelection"),b.fire("ignorePhrase",{grammarNode:a.problemNode})}},ignoreAll:{handler:function(a){b.fire("restoreSelection"),b.fire("ignoreAllPhrases",{grammarNode:a.problemNode})}}},common:{undo:{isDisabled:function(){return!c},handler:function(){b.fire("restoreSelection"),b.fire("executeUndo",{})}},redo:{isDisabled:function(){return!d},handler:function(){b.fire("restoreSelection"),b.fire("executeRedo",{})}},copy:{isDisabled:function(a){return a},handler:function(){a(b.getLocal("message_info_copy",b))}},paste:{handler:function(){return b.fire("openDialog",{dialogName:"pasteDialog"}),!1}},cut:{isDisabled:function(a){return a},handler:function(){a(b.getLocal("message_info_cut",b))}}},options:{settings:{isDisabled:function(){return!b.getOption("appStarted")},handler:function(){return b.Utils.Browser.chrome&&b.getSelection().removeAllRanges(),b.fire("openDialog",{dialogName:"baseDialog"}),!1}},toggle:{handler:function(){b.fire("restoreSelection"),b.fire("toggleApp",{flag:!b.getOption("appStarted")})}},help:{handler:function(){b.fire("restoreSelection"),window.open(b.getOption("wscSupportUrl"),"_blank")}}}}},getUserActions:function(a){var b={};return a.forEach(function(a){var c=this.actionsTypes[a];c&&(b[a]=c)},this),b}},a.UserActions=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d,e="themes/",f={},g=function(a,e){this.name=a,this.doc="iframe"==e.getOption("documentContainer").nodeName.toLowerCase()?e.getOption("documentContainer").contentWindow.document:document,this.sandbox=e,this.basePath=e.getOption("basePath"),this.misspelledNodeClass=e.getOption("misspelled_word_class"),this.problemGrammarClass=e.getOption("problem_grammar_class"),d=e.logger,b=e.UILib,c=e.Utils};g.prototype={constructor:g,init:function(){var a=this.sandbox.getOption("cssPath"),b=this.sandbox.getOption("theme");this.loadStyle(a,this.doc),this.addAdditionalStyles(),this.getLanguageStyleRules(),b&&this.loadTheme(b,WEBSPELLCHECKER.environment)},loadTheme:function(a,b){if(a=a||"classic-blue",c.is(a,"String")){var g,h,i=e+a+"/all.css",j="/samples/";b&&"dev"===b?(g=location.pathname,g.includes(j)?(h=g.substring(0,g.indexOf(j)),i=h+"/modules/ui/"+i):i="../modules/ui/"+i):i=this.basePath+i,"loaded"!==f[a]?(f[a]="loading",this.loadStyle(i)):d({name:"Load Theme",msg:"Theme"+a+"not loading. Exists on the page"}),f[a]="loaded"}},loadStyle:function(a,b){function c(a){var c,d;c=b.createStyleSheet(a),d=c.ownerNode?c.ownerNode:c.owningElement}b=b||document;for(var d,e=this.basePath,f=b.getElementsByTagName("link"),g=0;g<f.length;g++)if(f[g].href==e)return;b.createStyleSheet?"complete"==b.readyState?c(a):b.onreadystatechange=function(){"complete"==b.readyState&&c(a)}:(d=b.createElement("link"),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",a),b.getElementsByTagName("head")[0].appendChild(d))},addDynamicStyles:function(a,b){b=b||this.doc;var c=b.createElement("style");c.setAttribute("data-cke-temp","cke_temp");for(var d in a)c.cssText+=d+"{"+a[d]+"}";b.getElementsByTagName("head")[0].appendChild(c)},addAdditionalStyles:function(){var a={},b=this.sandbox.UILib,c=this.doc,d=c.documentElement,e=c.body,f="";f=b.css(e,"background-color"),f||(f=b.css(d,"background-color")),f&&(f=f.replace(/ /g,"").toLowerCase(),f.indexOf("rgba(0,0,0,0)")<0&&f.indexOf("transparent")<0&&(a["."+this.problemGrammarClass+" > ."+this.misspelledNodeClass]="background-color: "+f+";",a["."+this.problemGrammarClass+" > .red"]="background-color: "+f+";")),this.addDynamicStyles(a)},getLanguageStyleRules:function(){var a={},b=this.sandbox.getOption("languageNodeName"),c=this.sandbox.getOption("multiLanguageStyles"),d=this.sandbox.getOption("languageAttributeName");for(var e in c)a[b+"["+d+"="+e+"] ."+this.misspelledNodeClass]=c[e];this.addDynamicStyles(a)}},a.StyleManager=g}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.localizationLoaded=!1};b.async=!0,b.prototype={constructor:b,init:function(){var a=this.sandbox.getOption("localization");this.loadLocalization(a),this.sandbox.subscribe("localizationLoaded",function(a){this.handleLocalizationLoad(a)})},loadLocalization:function(a){var b=this.sandbox.getOption("detectLocalizationLanguage"),d=this.sandbox.getOption("localization"),e=this.sandbox.Utils.getLocationInfo(this.sandbox.getOption("basePath")),f=this;return b=b&&d===a,c.lang[a]?void this.fireModuleReady():(b&&(a=this.detect(a),this.sandbox.setOption("localization",a)),void this.sandbox.IO.loadScript(new this.sandbox.IO.URL({protocol:e.protocol,host:e.host,port:e.port,path:e.pathname+this.sandbox.getOption("localizationPath")+a+"/local.js"}),function(){f.fireModuleReady(),f.sandbox.fireInAllApps("localizationLoaded",{lang:a})},function(){f.fireModuleReady(),f.sandbox.fireInAllApps("localizationLoaded",{lang:a})}))},detect:function(a){var b=this.sandbox.getOption("localizationList"),c=navigator.userLanguage||navigator.language||a,d=this.sandbox.getOption("supportLocale"),e=c.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),f=e[1],g=e[2];return d&&b.indexOf(f+"-"+g)>0?f=f+"-"+g:b.indexOf(f)<0&&(f=a),f},fireModuleReady:function(){var a=this;setTimeout(function(){!a.localizationLoaded&&a.sandbox.fire("moduleReady",{moduleID:a.name}),a.localizationLoaded=!0},0)},handleLocalizationLoad:function(a){var b=this.sandbox.getOption("localization");b===a.lang&&this.fireModuleReady()}};var c={lang:{},getLocal:function(a,b){return this.lang[b]&&this.lang[b][a]?this.lang[b][a]:a}};a.LocalizationManager=b,a.prototype.Localization=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){this.name=a,this.sandbox=c,b=this.sandbox.UILib};c.prototype={init:function(){this.sandbox.subscribe("markupWords",function(a){this.markupWords(a.ranges,a.lang)},this),this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.handleKeydown,priority:1500,context:this}),this.sandbox.subscribe("removeMarkupInSelectionNode",function(a){this.removeMarkupInSelectionNode(a)},this),this.sandbox.subscribe("removeMarkupInDocument",function(){this.removeMarkupInDocument()},this),this.sandbox.subscribe("removeMarkupFromWords",function(a){this.removeMarkupFromWords(a.words)},this),this.sandbox.subscribe("removeMarkup",function(a){a.wsc&&this.removeMarkup(a.nodes)},this)},handleKeydown:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=this.sandbox.Utils,n=67,o=65,p=90,q=89,r=[45],s=[8,106,107,109,110,111,187,186,188,190,191,192,219,220,221,222],t=[13,32];if(s.push(m.Browser.gecko?173:189),b=(a.ctrlKey||a.metaKey)&&a.keyCode===n,c=(a.ctrlKey||a.metaKey)&&a.keyCode===o,d=(a.ctrlKey||a.metaKey)&&!a.shiftKey&&a.keyCode===p,e=(a.ctrlKey||a.metaKey)&&a.shiftKey&&a.keyCode===p,f=(a.ctrlKey||a.metaKey)&&!a.shiftKey&&a.keyCode===q,g=!(b||c||d||e||f),h=a.keyCode>40&&a.keyCode<91||a.keyCode>=96&&a.keyCode<=105,i=r.indexOf(a.keyCode)<0,j=s.indexOf(a.keyCode)>=0,k=t.indexOf(a.keyCode)>=0,g&&h&&i||j||k)if(k&&this.sandbox.isCaretInEndOfMisspelledWord()){var u=this.getSpellingNodeIfCaretInEndOfIt(),v=u?this.sandbox.isNodeContentBroken(u,this.sandbox.getOption("data_attribute_name")):!1;v?l.removeMarkupInSelectionNode():u&&l.moveCaretFromSpellingNode(u)}else l.removeMarkupInSelectionNode()},moveCaretFromSpellingNode:function(a){var b,c,d,e=a,f=this.sandbox.getSelection(),g=(this.sandbox.Utils.getCurrentDocument(this.sandbox.getOption("documentContainer")),this);d=e.parentNode,c=this.sandbox.createRange(),b=document.createTextNode("‌"),d.insertBefore(b,e.nextSibling),c.setStartAfter(b),c.collapse(!0),f.removeAllRanges(),f.addRange(c),setTimeout(function(){var a,c=g.sandbox.saveSelection();a=g.sandbox.getSavedSelectionParentContainer(c),b.nodeValue=b.nodeValue.replace(/\u200C/,""),g.sandbox.restoreSelection(c),g.sandbox.Utils.Browser.gecko&&a&&a.normalize()},0)},markupWords:function(a,c){if(0!==a.length){var d=this,e=d.sandbox.getOption("documentContainer"),f=d.sandbox.getOption("misspelled_word_node"),g=d.sandbox.getOption("data_attribute_name"),h=d.sandbox.getOption("data_lang_attribute"),i=d.sandbox.getOption("misspelled_word_class"),j=d.sandbox.RegularsManager.specialCharacters.set().onePlus().g(),k=d.sandbox.Utils.getCurrentDocument(e).createElement(f);this.sandbox.UILib.addClass(k,i),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var l=0;l<a.length;l++)if(a[l].language===c){var m=a[l].range.commonAncestorContainer(),n=d.sandbox.Utils.isEqualNode(m,g)?[m]:b.findNodeParents(m,f,g);if(0===n.length){var o=k.cloneNode(!0),p=a[l].range.toString();o.setAttribute(g,j.replace(p,"")),c&&o.setAttribute(h,c),o.appendChild(a[l].range.extractContents()),a[l].range.insertNode(o);var q=b.findNodeChildren(o,f,g);for(d.sandbox.fire("markupedNode",{node:o});q.length>0;){var r=q.shift();d.removeMarkup(r)}}}this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})}},removeMarkupInDocument:function(){var a,c=this,d=c.sandbox.getOption("container"),e=c.sandbox.getOption("misspelled_word_node"),f=c.sandbox.getOption("data_attribute_name");a=b.query(d,e+"["+f+"]"),c.removeMarkup(a)},removeMarkupFromWords:function(a){for(var c,d,e=this,f=e.sandbox.getOption("container"),g=e.sandbox.getOption("misspelled_word_node"),h=e.sandbox.getOption("data_attribute_name"),i=this.sandbox.getOption("data_lang_attribute"),j=[],k=0;k<a.length;k++)d=b.query(f,g+"["+h+'="'+a[k].word+'"]'),c=a[k].lang,c&&(d=b.filter(d,"["+i+'="'+c+'"]')),j.push.apply(j,d);e.removeMarkup(j)},removeMarkupInSelectionNode:function(a){function b(a){var b=[];return b=a.filter(function(a){return i.isEqualNode(a,j)
})}var c,d,e,f,g,h=this,i=this.sandbox.Utils,j=(this.sandbox.UILib,h.sandbox.getOption("data_attribute_name")),k=a&&a.selectionNode,l=a&&a.removeInside,m=a&&a.forceBookmark,n=h.sandbox.getSelection(),o=this.sandbox.getOption("container"),p=[];k?(e=h.sandbox.createRange(),e.selectNode(k),p=e.getNodes()):n.rangeCount()>0&&(e=n.getRangeAt(0),c=e.startContainer(),d=e.endContainer(),f=e.startOffset(),g=e.endOffset(),p=this.getNeighbourSpellingNodes(c,d,f,g),l&&(p=p.concat(e.getNodes()))),p=b(p),p=i.ArrayUtils.arrayUnique(p),m&&!this.sandbox.getOption("focused")&&p.length>0&&this.sandbox.fire({eventType:"focus",element:o});for(var q=0,r=p.length;r>q;q+=1)h.removeMarkup(p[q])},getNeighbourSpellingNodes:function(a,b,c,d){function e(a,b,c){{var d,e,f,g,k,n=h.sandbox.getOption("container"),o=h.sandbox.RegularsManager,p=o.nonWhiteSpaceExtended,q=p.g(),r=o.punctuationRegExp.set(),s=o.wordBoundaryRegex,t=o.blockElementsRegex,u=h.sandbox.getOption("backspaceKeyButtonPressed"),v=h.sandbox.getOption("deleteKeyButtonPressed"),w=h.sandbox.getOption("spaceKeyButtonPressed"),x=h.sandbox.getOption("enterKeyButtonPressed");h.sandbox.getSelection().getRangeAt(0).collapsed()}if(b){k=new i.Walker(b,c,a,n);do{if(k.siblingNode&&t.test(k.siblingNode.nodeName.toLowerCase())&&k.textWalkedThrough.length>0&&p.test(k.textWalkedThrough))break;if(i.isEqualNode(k.currentNode,l)&&k.textWalkedThrough.length>0){d=k.currentNode;break}if(e=k.textWalkedThrough,f=r.g().replace(k.textWalkedThrough," "),g=-1!==r.search(e),a||(e=e.split("").reverse().join(""),f=f.split("").reverse().join("")),(w||x)&&!a&&s.test(e)){d=j.findNodeParents(k.currentNode,m,l)[0];break}if(v&&!a&&0===e.search(/\s/))break;if(u&&a&&0===e.search(/\s/))break;if(g&&!v&&!u){d=j.findNodeParents(k.currentNode,m,l)[0];break}if(q.setLastIndex(0),q.test(f)&&q.getLastIndex()+1<=e.length)break}while(k.getNext())}return{spellingNode:d,text:e}}var f,g,h=this,i=this.sandbox.Utils,j=this.sandbox.UILib,k=[],l=this.sandbox.getOption("data_attribute_name"),m=this.sandbox.getOption("misspelled_word_node"),n=h.sandbox.getOption("backspaceKeyButtonPressed"),o=h.sandbox.getOption("deleteKeyButtonPressed");return f=e(!1,a,c),g=e(!0,b,d),n&&/^\s{2,}/.test(f.text)&&(f.spellingNode=null,g.spellingNode=null),o&&/^\s{2,}/.test(g.text)&&(f.spellingNode=null,g.spellingNode=null),(n||o)&&/^\s+/.test(f.text)&&/^\s+/.test(g.text)&&(f.spellingNode=null,g.spellingNode=null),k=k.concat(f.spellingNode,g.spellingNode)},getSpellingNodeIfCaretInEndOfIt:function(){var a,b=this.sandbox.getSpellingNodeFromSelection(),c=this.sandbox.getSelection(),d=c.getRangeAt(0).endContainer().childNodes;return!b&&d.length&&(a=d[c.getRangeAt(0).startOffset()-1],b=a&&1===a.nodeType?a:null),b},removeMarkup:function(a){var b,c,d,e,f,g=(this.sandbox.Utils.getCurrentDocument(this.sandbox.getOption("documentContainer")),this.sandbox.isFocused()),h=[].concat(a);for(g&&h.length>0&&(b=this.sandbox.saveSelection(),f=this.sandbox.getSavedSelectionParentContainer(b)),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});h.length>0;)c=h.shift(),c.innerHTML?(d=this.sandbox.createRange(),d.selectNode(c),e=d.createContextualFragment(c.innerHTML),d.deleteContents(),d.insertNode(e),this.sandbox.fire("removedMarkupInContainer",{node:d.commonAncestorContainer()})):this.sandbox.UILib.remove(c);this.sandbox.restoreSelection(b),this.sandbox.Utils.Browser.gecko&&f&&f.normalize(),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})}},a.Markup=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("startSpellCheck",function(){this.startSpellCheck()}),this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:function(a){this.handleKeydown(a)}}),this.sandbox.subscribe("collectWords",function(a){this.collectWords(a.source,a.ignoreMisspellingsInContainer)},this)},handleKeydown:function(a){var b,c=this,d=this.sandbox.getOption("multiLanguageMode");(32==a.keyCode||13==a.keyCode||32==a.charCode||13==a.charCode)&&c.sandbox.addDeferredFunction("collectWordsAfterKeypress",{single:!0,delay:0,deferredFunction:function(){var a,b=c.sandbox.getSelection();if(b.rangeCount()>0){var e=b.getRangeAt(0);a=d?e.commonAncestorContainer():e,c.sandbox.fire("collectWords",{source:a})}}}),c.sandbox.addDeferredFunction("collectWordsAfterDelay",{single:!0,delay:2e3,deferredFunction:function(){var a,e=c.sandbox.getOption("container");d?b=e:(a=c.sandbox.createRange(),a.selectNodeContents(e),b=a),c.sandbox.fire("collectWords",{source:b})}})},startSpellCheck:function(){var a,b=this.sandbox.createRange(),c=this.sandbox.getOption("container"),d=this.sandbox.getOption("multiLanguageMode");d?a=c:(b.selectNodeContents(c),a=b.toString()),this.sandbox.fire("collectWords",{source:a,ignoreMisspellingsInContainer:!1})},collectWords:function(a,b){var c;switch(typeof a){case"string":c=this.collectWordsInString(a);break;case"object":c=a.nodeType?this.collectWordsInContainer(a,b):this.collectWordsInRange(a)}return this.sandbox.fire("wordsCollected",{wordsCollection:c}),c},collectWordsInString:function(a){var b,c=this.sandbox.getOption("lang"),d=this.sandbox.getOption("permanentMinWordLength")[c],e=(this.sandbox.getOption("minWordLength"),"word_");b=this.sandbox.getWordsFromString(a,d).wordsCollection;for(var f={},g=0;g<b.length;g++)f[e+b[g]]=f[e+b[g]]||{word:b[g]};return f={words:f,detectedLanguages:{}},f.detectedLanguages[c]=1,f},collectWordsInRange:function(a){var b=this.createStringWithoutScaytElements(a.commonAncestorContainer());return this.collectWordsInString(b)},collectWordsInContainer:function(a,b){var c,d=new WEBSPELLCHECKER.CORE.WordsFinder.Finder(this.sandbox,b);return d.collectBlockInfo(a),c=this.collectWordsInString(d.resultText),c.detectedLanguages=d.detectedLanguages,c},createStringWithoutScaytElements:function(a){for(var b=this.sandbox.UILib,c="",d=[a],e=d.shift(),f=this.sandbox.RegularsManager,g=f.blockElementsRegex,h=this.sandbox.getOption("misspelled_word_node"),i=this.sandbox.getOption("data_attribute_name"),j=f.ignoreElementsRegex,k=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)");e;){switch(e.nodeType){case 3:c+=e.nodeValue;break;case 1:var l=e.nodeName.toLowerCase()==h.toLowerCase()&&e.getAttribute(i);if(!l&&!k.test(b.attr(e,"className"))&&!j.match(e.nodeName)){for(var m=0;m<e.childNodes.length;m++)d.splice(m,0,e.childNodes[m]);g.match(e.nodeName)&&(d.length>e.childNodes.length&&d.splice(m,0,document.createTextNode(" ")),c.length>0&&" "!=c[c.length-1]&&d.splice(0,0,document.createTextNode(" ")))}}e=d.shift()}return c}},a.WordsCollector=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("misspelledWordsFound",function(a){this.processMisspelledWords(a.words,a.lang)},this)},processMisspelledWords:function(a,b){for(var c=this,d=(c.sandbox.getOption("lang"),c.sandbox.getOption("uid")),e=[],f=0;f<a.length;f++)a[f].existsInInstance(d)&&1==a[f].getStatus(d)&&e.push(a[f]);0!==e.length&&c.sandbox.addDeferredFunction("findWordRangesForMarkupForLang_"+b,{delay:100,collection:e,defferedFunctionArgs:[b],partialItemsCount:1,deferredFunction:function(a,b){var d,e,f=c.sandbox.isFocused();f&&(d=c.sandbox.saveSelection()),e=c.findWordRangesForMarkup(a),c.sandbox.fire("markupWords",{ranges:e,lang:b}),c.sandbox.restoreSelection(d)}})},findWordRangesForMarkup:function(a){var c,d=this.sandbox.createRange(),e=this.sandbox.getOption("container");d.selectNodeContents(e),c=new b.Finder(this.sandbox),c.collectBlockInfo(d.commonAncestorContainer());for(var f=[],g=0;g<a.length;g++)for(c.lastIndex=0;null!==c.findWord(a[g].word);)f.push({range:c.wordRange,language:c.wordLanguage});return f.reverse()}},b.Finder=function(a,b){function c(b,c){var d,e=a.getOption("multiLanguageMode"),f=a.getOption("languagesMap"),g=a.getOption("languageNodeName"),h=a.getOption("languageAttributeName"),i=c;return e&&(b.lang&&b.nodeName.toLowerCase()===g||(b=a.UILib.parents(b,g+"["+h+"]")[0]),d=b&&b.nodeName.toLowerCase()==g?b.getAttribute(h):"",d&&(i=f[d]||null)),i}b="undefined"==typeof b?!0:b,this.parts=[],this.newParts={getPos:function(a){for(;!this[a];)a--;return this[a]}},this.resultText="",this.detectedLanguages={},this.detectedLanguages[a.getOption("lang")]=1,this.lastIndex=0,this.wordRange=null,this.reset=function(){this.parts=[],this.resultText="",this.lastIndex=0,this.wordRange=null,this.detectedLanguages[a.getOption("lang")]=1},this.collectBlockInfo=function(d){function e(a,b,c){if(a!==b){var d={node:c.el,start:i.resultText.length,end:i.resultText.length+b-a,offset:a};i.newParts[d.start]=d,i.newParts[d.end]=d,i.resultText+=0==c.editable?m.replace(c.el.nodeValue," ").substring(a,b):c.el.nodeValue.substring(a,b)}}for(var f=[{el:d,editable:d.isContentEditable}],g=f.shift(),h=a.getOption("lang"),i=this,j=a.RegularsManager,k=j.blockElementsRegex,l=j.ignoreElementsRegex,m=j.anyChar.g(),n=a.getOption("misspelled_word_node"),o=a.getOption("data_attribute_name"),p=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),q=0,r="",s=[],t=a.RegularsManager.specialCharacters.set().onePlus();g;){switch(g.el.nodeType){case 3:g.el.nodeValue.length>0&&(q=g.indexOffset||0,r=g.el.nodeValue,s=t.match(r.substring(q)),s?(e(q,q+s.index,g),g.indexOffset=q+s.index+s[0].length,f.splice(0,0,g)):(e(q,r.length,g),g.emptyCharsCountInPart=0));break;case 1:if(b&&g.el.nodeName.toLowerCase()==n.toLowerCase()&&g.el.getAttribute(o))this.resultText+=m.replace(g.el.getAttribute(o),"_");else if(!p.test(a.UILib.attr(g.el,"className"))&&!l.test(g.el.nodeName)){var u=g.el.hasAttribute("contenteditable")?g.el.isContentEditable:g.editable,v=c(g.el,h);v&&(this.detectedLanguages[v]=1);for(var w=0;w<g.el.childNodes.length;w++)f.splice(w,0,{el:g.el.childNodes[w],editable:u});k.match(g.el.nodeName)&&(f.length>g.el.childNodes.length&&f.splice(w,0,{el:document.createTextNode(" "),editable:!0}),this.resultText.length>0&&" "!=this.resultText[this.resultText.length-1]&&f.splice(0,0,{el:document.createTextNode(" "),editable:!0}))}}g=f.shift()}this.resultText=a.replaceSepatators(this.resultText)},this.findWord=function(b){var d=this.resultText.indexOf(b,this.lastIndex);if(d>0)this.lastIndex=d+b.length,d=this.resultText.charAt(d-1).match(/\s/)?d:"skipped",d=this.lastIndex==this.resultText.length||this.resultText.charAt(d+b.length).match(/\s/)?d:"skipped";else{if(0!==d)return null;this.lastIndex=d+b.length,d=this.lastIndex==this.resultText.length||this.resultText.charAt(d+b.length).match(/\s/)?d:"skipped"}if("skipped"==d)return this.findWord.call(this,b);var e=a.createRange(),f=this.newParts.getPos(d);e.setStart(f.node,d-f.start+f.offset);var g=this.newParts.getPos(d+b.length-1);e.setEnd(g.node,d+b.length-g.start+g.offset),e=a.Utils.fixRangeBoundaryPoints(e),this.wordRange=e;var h=a.getOption("lang"),i=e.commonAncestorContainer();return this.wordLanguage=c(i,h),this.wordRange}},a.WordsFinder=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("replaceWord",function(a){this.replaceWordInSelection(a.word,a.spellingNode)},this),this.sandbox.subscribe("ignoreWord",function(a){this.ignoreWordInSelection(a.spellingNode)},this),this.sandbox.subscribe("ignoreAllWords",function(a){this.ignoreWordInDocument(a.spellingNode)},this)},replaceWordInSelection:function(a,b){var c,d=this.sandbox.getOption("container");c=b?b:this.sandbox.getSpellingNodeFromSelection(),c&&d.contains(c)&&this.replaceWordByNode(c,a)},ignoreWordInSelection:function(a){var b,c=this.sandbox.getOption("container");b=a?a:this.sandbox.getSpellingNodeFromSelection(),b&&c.contains(b)&&this.ignoreWords([b])},ignoreWordInDocument:function(a){var b,c,d,e=this.sandbox.getOption("container"),f=this.sandbox.getOption("misspelled_word_node"),g=this.sandbox.getOption("data_attribute_name"),h=this.sandbox.getOption("data_lang_attribute"),i=this.sandbox.UILib,j=[];b=a?a:this.sandbox.getSpellingNodeFromSelection(),b&&e.contains(b)&&(d=b.getAttribute(h),c=this.sandbox.UILib.query(e,f+"["+g+'="'+b.getAttribute(g)+'"]'),c=i.filter(c,"["+h+'="'+d+'"]'),j.push.apply(j,c),this.ignoreWords(j))},ignoreWords:function(b){for(var c,d,e,f,g=this.sandbox.saveSelection(),h=this.sandbox.createRange(),i=a.DictionaryManager.Dictionary,j=this.sandbox.getOption("data_attribute_name"),k=this.sandbox.getOption("data_lang_attribute"),l=this.sandbox.getOption("uid");b.length>0;)c=b.shift(),d=c.getAttribute(j),e=c.getAttribute(k),i.getWord(d,e)&&i.getWord(d,e).setStatus(a.DictionaryManager.wordStatus.userIgnore,l),h.selectNode(c),f=h.createContextualFragment(c.innerHTML),h.deleteContents(),this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:h.commonAncestorContainer()}),h.insertNode(f);this.sandbox.restoreSelection(g)},replaceWordByNode:function(a,b){a.innerHTML=b;var c=this.sandbox.createRange();c.selectNodeContents(a),c.collapse(!1);var d=this.sandbox.getSelection();d.removeAllRanges(),d.addRange(c);var e=this.sandbox.saveSelection();c=this.sandbox.createRange(),c.selectNode(a);var f=c.createContextualFragment(a.innerHTML);if(c.deleteContents(),c.insertNode(f),this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:c.commonAncestorContainer(),textChanged:!0}),this.sandbox.restoreSelection(e),this.sandbox.getOption("mirrorBasedInstance")){var g=this.sandbox.getTextBeforeCursor();null!==g&&g.substring(g.length-b.length)!==b&&(g+=b),this.sandbox.fire("textReplaced",{textBeforeCursor:g?g:null,newText:b})}}},a.WordsProcessor=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){var e=["CKEditor","TinyMCE"],f=c.getOption("appType");this.name=a,b=c.getOption("basePath"),this.sandbox=c,this.closeBannerTimeout=void 0,this.contextMenuContainer=null,this.template=e.includes(f)?d.editor():d.common(),this.bannerId=e.includes(f)?"banner_tpl_editor":"banner_tpl_default"};c.prototype={init:function(){this.sandbox;this.sandbox.Template.create(this.bannerId,this.template),this.sandbox.subscribe("showBanner",function(a){this.showBannerHandler(a.contextMenuContainerSelector)},this),this.sandbox.subscribe("hideBanner",function(){this.hideBanner()},this)},showBannerHandler:function(a){var b=this,c=this.sandbox.UILib;b.sandbox.getOption("banner")!==!1&&b.sandbox.addDeferredFunction("showBanner",{single:!0,delay:100,deferredFunction:function(){var d=c.find(a)[0];b.contextMenuContainer=d,d&&(c.css(d,{overflow:"visible"}),b.showBanner(d))}})},actionLinks:function(a){var b=this,c=a.target||a.srcElement;c.href&&"closeBanner"!==c.id&&(window.open(c.href,"_blank"),b.contextMenuContainer&&b.sandbox.fire({eventType:"focus",element:b.contextMenuContainer}))},showBanner:function(a){function b(a){var e=a;f(e),c.sandbox.unsubscribe({eventType:"mousedown",element:d.find("#wsc_banner")[0],handler:b})}var c=this,d=this.sandbox.UILib,e=c.sandbox.Template.render(c.bannerId,{}),f=d.proxy(c.actionLinks,c);d.append(a,e),c.sandbox.subscribe({eventType:"mousedown",element:d.find("#wsc_banner")[0],handler:b})},hideBanner:function(){var a=this.sandbox.UILib,b=a.find("#wsc_banner")[0];b&&(a.css(a.parent(b),{overflow:""}),a.remove(b))}};var d={editor:function(){return'<div id="wsc_banner" style="padding: 2px 18px 14px; border: 1px solid #c7c7c7; box-shadow: 0 0 5px rgba(0,0,0,.1); position: absolute; font-size: 12px; line-height: 1.33; font-family: Arial,Verdana,sans-serif; z-index: 9998; width: 140px; min-height: 60px; background-color: rgb(255, 255, 255); white-space: normal; left: 102%; top: 0; background-position: initial initial; background-repeat: initial initial; color: #3f3f3f; box-sizing: content-box;"><div style="overflow: hidden;"><div class="img-banner"><img src="'+b+'css/webspellchecker-logo-small.png"><span style="display: inline-block; position: relative; font-size: 11px; color: #134aad; font-weight: 700; vertical-align: top; margin-top: 15px;">WebSpellChecker</span></div></div><ul style="list-style-type: disc; margin-top: 5px; margin-left: 25px;"><li style="color: #3f3f3f; line-height: 1.8;"><span style="color: #1E8914; vertical-align: middle;" >Accelerated check</span></li><li style="color: #3f3f3f; line-height: 1.8;">More languages</li><li style="color: #3f3f3f; line-height: 1.8;">Technical support</li><li style="color: #3f3f3f; line-height: 1.8;">Extra features</li><li style="color: #3f3f3f; line-height: 1.8;">No banner</li></ul><div style="text-align: center;"><a target="_blank" href="http://www.webspellchecker.net/pricing.html" style="display: inline-block; text-align: center; padding: 3px 16px; border-radius: 6px; background: #1E8914; color: #fff; font-size: 11px; outline: 0; border: 0; cursor: pointer; box-sizing: border-box; line-height: 1.8; margin: 10px auto 0;">Upgrade Now</a></div></div>'},common:function(){return'<div id="wsc_banner"><div class="img-banner"><img src="'+b+'css/webspellchecker-logo-small.png"><span>WebSpellChecker</span></div><ul class="more-list"><li>No banner</li><li>More languages</li><li>Technical support</li><li>Extra features</li></ul><div class="button-holder"><a target="_blank" href="http://www.webspellchecker.net/pricing.html" class="sc-upgrade">Upgrade Now</a></div>'}};a.Banner=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b;if(!a.AccessLimiter){var c=function(a,c){this.name=a,this.wordsLimit=c.getOption("wordsLimit"),this.setTimeoutId=null,this.sandbox=c,b=this.sandbox.Utils};c.prototype={init:function(){var a=(this.sandbox,this.sandbox.getOption("freeze"));a&&this.activateFreeze()},activateFreeze:function(){this.limitController=c.limitController=c.limitController||new d({wordsLimit:this.wordsLimit}),this.sandbox.subscribe("getWordsLimit",function(a){this.getWordsLimitHandler(a)}),this.sandbox.subscribe("sentWordsCount",function(a){this.sentWordsCountHandler(a.count)}),this.sandbox.subscribe("spellCheckEnded",function(){this.spellCheckEndedHandler()})},getWordsLimitHandler:function(a){a.setReturnedData({data:this.limitController.getWordsLimit()})},sentWordsCountHandler:function(a){a=this.limitController.getWordsLimit()-a,this.limitController.updateWordsLimit(0>a?0:a)},spellCheckEndedHandler:function(){var a=this.sandbox.getOption("spellCheckDelay"),b=this;this.limitController.isFrozen()&&null===this.setTimeoutId&&(this.sandbox.fireInAllApps("freeze",{status:!0}),this.setTimeoutId=setTimeout(function(){b.limitController.clear(),b.setTimeoutId=null,b.sandbox.fireInAllApps("freeze",{status:!1}),b.sandbox.fireInAllApps("startSpellCheck",{})},a))}};var d=function(a){var b=!1,c=a.wordsLimit;return{clear:function(){c=a.wordsLimit,b=!1},isFrozen:function(){return b},getWordsLimit:function(){return c},updateWordsLimit:function(a){c=a,0===a&&(b=!0)}}};a.AccessLimiter=c}}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){var a=this;this.sandbox.subscribe({eventType:"keydown",element:this.getContainer(),handler:this.handleKeydown}),a.sandbox.subscribe({eventType:"compositionstart",element:this.getContainer(),handler:function(){a.sandbox.setPaused(!0)}}),a.sandbox.subscribe({eventType:"compositionend",element:this.getContainer(),handler:function(){a.sandbox.setPaused(!1),a.sandbox.addDeferredFunction("collectWordsAfterWorkIME",{single:!0,delay:0,deferredFunction:function(){var b,c=a.sandbox.getSelection(),d=a.sandbox.getOption("multiLanguageMode");if(c.rangeCount()>0){var e=c.getRangeAt(0);b=d?e.commonAncestorContainer():e,a.sandbox.fire("collectWords",{source:b})}}})}})},handleKeydown:function(a){var b=this;(229===a.keyCode||0===a.keyCode)&&b.sandbox.fire("removeMarkupInSelectionNode")},getContainer:function(){var a=this;return a.sandbox.getOption("container")}},a.IME=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.infoTypesMap={banner:"banner",spellingLangList:"langList",grammarLangList:"grammarLangList"}};b.async=!0,b.prototype={constructor:b,appSetPause:function(){this.sandbox.setPaused(!0),this.sandbox.removeAllDeferredFunctions()},init:function(){var a=this;this.sandbox.fire("remoteAction",{actionMethod:"getInfo",onSuccess:function(b){var c,d,e,f=a.infoTypesMap;for(var g in f)c=f[g],void 0!==typeof b[c]&&a.sandbox.setOption(g,b[c]);a.sandbox.setOption("freeze",!1),e=a.sandbox.getOption("spellingLangList"),d=a.sandbox.getOption("lang"),d in e.ltr||d in e.rtl?a.sandbox.fire("moduleReady",{moduleID:a.name}):(a.appSetPause(),console.warn("The defined language code "+d+" is not available or supported for your customer ID. Please contact us at support@webspellchecker.net or submit a ticket at webspellchecker.net website."))},onError:function(){a.appSetPause()}})}},a.InfoGetter=b}(WEBSPELLCHECKER.CORE),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){"use strict";var c=b.UILib,d=b.Utils;a=a||{};var e=d.extend(null,{appendTo:function(a){c.appendTo(this.getDOMElement(),a)},insertBefore:function(a){c.insertBefore(this.getDOMElement(),a)},insertAfter:function(a){c.insertAfter(this.getDOMElement(),a)},getParentDialog:function(){return this.dialog},getDOMElement:function(){return this.element},css:function(a){c.css(this.getDOMElement(),a)},hideElement:function(){this.getDOMElement().style.display="none"},showElement:function(){this.getDOMElement().style.display=""}});a.Component=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=function(a,b,c){this.container=a||document,this.keysMap=b,this.sandbox=c,this.isActive=!1,this.activate=function(){this.isActive||(this.isActive=!0,this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:e}))},this.deActivate=function(){this.isActive=!1,this.sandbox.unsubscribe({eventType:"keydown",element:this.container,handler:e})},this.destroy=function(){this.deActivate()};var d=this,e=function(a){var b,c=a.keyCode;for(var e in d.keysMap)e==c&&"function"==typeof d.keysMap[e]&&(b=d.keysMap[e](a),b&&a.preventDefault())}};a.KeyboardNavigation=b}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){"use strict";var c=b.Utils,d=b.UILib,e=c.extend(a.Component,function(f,g){function h(){function b(a){var b=a._type;a.sender.dialogName===z.dialogName&&z[b](a)}z.element=E=i(),F=d.find(".sc-dialog__header-drag",E),G=d.find(".sc-dialog__header .sc-dialog__header-in",E),J=d.find(".sc-dialog__header .sc-dialog__header-title",E),K=d.find(".sc-dialog__content",E),H=new a.Button({id:"close",text:"&#65279;",title:f.getLocal("btn_close",f),extraClass:"sc-button__icon sc-button__icon_close",onClick:s},z),I=new a.Button({id:"info",text:"&#65279;",title:f.getLocal("btn_info",f),href:f.getOption("ECUserManual"),target:"_blank",extraClass:"sc-button__icon sc-button__icon_info"},z),H.appendTo(G),I.appendTo(G),"function"==typeof z.onLoad&&z.subscribe("onLoad",b,z),"function"==typeof z.onShow&&z.subscribe("onShow",b,z),"function"==typeof z.onHide&&z.subscribe("onHide",b,z),"function"==typeof z.onClose&&z.subscribe("onClose",b,z),z.subscribe("afterTabShow",z.refreshFocusableElements,z),z.subscribe("userDictionaryAction",z.refreshFocusableElements,z),z.addTabs(z.tabDefinitions),j(),t(),f.fire("dialogDefinition",{name:g,definition:A,dialog:z}),z.fire("onLoad",{sender:z})}function i(){var a="";return D.create(R.name,R.text),a=D.render(R.name,{titleHtml:z.title,label:z.label,extraClass:z.extraClass}),d.create(a)[0]}function j(){"number"==typeof z.minWidth&&d.css(E,{width:z.minWidth}),"number"==typeof z.minHeight&&d.css(E,{height:z.minHeight})}function k(){var a,b=d.find("."+P)[0],e={display:"block"};b=b||d.create('<div class="'+P+'">')[0],c.Browser.ie&&c.Browser.version<9?(a=Math.round(100*Q),e.filter=a>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")"):e.opacity=Q,d.css(b,e),d.appendTo(b,"body")}function l(){var a=d.find("."+P)[0];a&&d.css(a,{display:"none"})}function m(a){a?(f.subscribe({eventType:"resize",element:window,handler:n}),o()):(clearTimeout(y),f.unsubscribe({eventType:"resize",element:window,handler:n}))}function n(a){clearTimeout(y),y=setTimeout(o,S)}function o(){var a=0,b=0,c=p(),d=q(),e=B.getScrollLeft(),f=B.getScrollTop(),g="fixed";g=d.height>c.height?"fixed":"absolute",a=parseInt((d.width-c.width)/2,10),b=parseInt((d.height-c.height)/2,10),"absolute"==g&&(a=e+a,b=f+b,a=0>a?0:a,b=0>b?0:b),z.setPosition(a,b,g)}function p(){var a={};return a.width=d.outerWidth(E,!0),a.height=d.outerHeight(E,!0),a}function q(){var a={};return a.width=B.getWindowInnerWidth(),a.height=B.getWindowInnerHeight(),a}function r(a,b){for(var c in b){if(c===a)return b[c];if(b[c].getChildren){var d=r(a,b[c].getChildren());if(d)return d}}return null}function s(){z.hide(),z.fire("onClose",{sender:z}),z.fire("restoreSelection")}function t(){function a(a){e=a.clientX-parseInt(E.style.left),g=a.clientY-parseInt(E.style.top),d.addClass("html","sc-unselectable"),b(a),f.subscribe({eventType:"mousemove",element:document,handler:b}),f.subscribe({eventType:"mouseup",element:document,handler:c})}function b(a){E.style.left=a.clientX-e+"px",E.style.top=a.clientY-g+"px"}function c(){d.removeClass("html","sc-unselectable"),f.unsubscribe({eventType:"mousemove",element:document,handler:b}),f.unsubscribe({eventType:"mouseup",element:document,handler:c})}var e,g;f.subscribe({eventType:"mousedown",element:F[0],handler:a})}function u(){for(var a=document.activeElement,b=0;b<z.focusableElements.length;b++)a===z.focusableElements[b]&&(z.focusIndex=b);return z.focusIndex++,z.focusIndex>=z.focusableElements.length&&(z.focusIndex=0),z.setFocus(z.focusIndex),!0}function v(){var a,b=document.activeElement,c=z.getActiveTabIndex(),e=z.getTabsLength(),f=c-1;return d.hasClass(b,"sc-tabset__link")?(0>f&&(f=e-1),z.lockFocusIndexChange=!0,a=z.getTab(f),a.onClick(),!0):!1}function w(){var a,b=document.activeElement,c=z.getActiveTabIndex(),e=z.getTabsLength(),f=c+1;return d.hasClass(b,"sc-tabset__link")?(f>=e&&(f=0),z.lockFocusIndexChange=!0,a=z.getTab(f),a.onClick(),!0):!1}function x(){return H.onClick(),!0}var y,z=this,A=e._.dialogDefinitions[g],B=(f.getOption("container"),f.UIMetrics),C=a.KeyboardNavigation,D=b.Template,E=null,F=null,G=null,H=null,I=null,J=null,K=null,L=[],M={},N=null,O="one-tab",P="sc-modal-cover",Q=.6,R={name:"uiDialogTpl",text:'<div class="sc-dialog <%=extraClass%>"><div class="sc-dialog__header"><div class="sc-dialog__header-in"></div><div class="sc-dialog__header-title"><%=titleHtml%></div><div class="sc-dialog__header-drag" title="<%=label%>"></div></div><div class="sc-dialog__content"></div></div>'},S=100;A=A(f),this.dialogName=g,this.title=A.title||"",this.label="SCAYT"===this.title?"SpellCheckAsYouType":this.title,this.buttonDefinitions=L.concat(A.buttons||[]),this.tabDefinitions=A.tabs||{},this.extraClass=A.extraClass||"",this.minWidth=A.minWidth,this.minHeight=A.minHeight,this.onLoad=A.onLoad,this.onShow=A.onShow,this.onHide=A.onHide,this.onClose=A.onClose,R=A.elementTemplate?A.elementTemplate:R,this.focusableElements=[],this.focusIndex=0,this.lockFocusIndexChange=!1,this.keyboardNavigation=new C(document,{9:u,37:v,39:w,27:x},f),this.show=function(){k(),d.appendTo(E,"body"),m(!0),this.fire("saveSelection"),this.fire("onShow",{sender:z}),c.Browser.ie&&c.Browser.version<=8||this.keyboardNavigation.activate()},this.hide=function(){m(!1),d.remove(E),l(),this.fire("onHide",{sender:z}),c.Browser.ie&&c.Browser.version<=8||this.keyboardNavigation.deActivate()},this.setTitle=function(a){d.html(J,a)},this.addTab=function(b){N=N||new a.TabbedNavigation({appendTo:K},this),N.addTab(b),this.updateStyles()},this.addTabs=function(b){b&&b.length>0&&(N=N||new a.TabbedNavigation({appendTo:K},this),N.addTabs(b),this.updateStyles())},this.getTabsLength=function(){return N?N.getTabsLength():0},this.getActiveTabIndex=function(){return N?N.getActiveTabIndex():0},this.getTab=function(a){return N?N.getTab(a):null},this.setActiveTab=function(a){N&&N.setActiveTab(a)},this.removeTab=function(a){var b=!1;return N?(b=N.removeTab(a),this.updateStyles(),b):void 0},this.updateStyles=function(){var a=N.getTabsLength();d[2>a?"addClass":"removeClass"](E,O)},this.setPosition=function(a,b,c){c=c||"absolute",d.css(E,{position:c}),d.setPosition(E,a,b)},this.find=function(a){return d.find(a,E)},this.getFocusableElements=function(){for(var a=z.getTab(z.getActiveTabIndex()),b=d.find(".sc-focusable",a.element),c=d.find(".sc-focusable",G),e=d.find(".sc-tabset__tab_active a",E),f=b.concat(c).concat(e),g=[],h=0;h<f.length;h++){for(var i=f[h],j=!1;i!==E;){if("none"===d.css(i,"display")){j=!0;break}i=i.parentNode}j||g.push(f[h])}return g},this.refreshFocusableElements=function(){var a=this;c.Browser.ie&&c.Browser.version<=8||setTimeout(function(){a.focusableElements=a.getFocusableElements(),a.focusIndex=a.lockFocusIndexChange?a.focusableElements.length-1:0,a.setFocus(a.focusIndex),a.lockFocusIndexChange=!1},0)},this.setFocus=function(a){this.focusableElements[a].focus()},this.getUIElement=function(a,b){var c=null,d=null,e=null;return N&&(d=N.getTab(a),e=d.getChildren(),c=r(b,e)),c},this.getButton=function(a){return M[a]},this.fire=function(a,b){return f.fire(a,b)},this.subscribe=function(a,b,c,d){return f.subscribe(a,b,c,d)},this.unsubscribe=function(a,b){return f.unsubscribe(a,b)},this.destroy=function(){H.destroy(),H=null,I.destroy(),I=null;for(var a in M)M[a].destroy(),delete M[a];N&&(N.destroy(),N=null),d.remove(E),l(),E=null,F=null,G=null,J=null,K=null,this.unsubscribe("onLoad",this),this.unsubscribe("onShow",this),this.unsubscribe("onHide",this),this.unsubscribe("onClose",this),this.unsubscribe("afterTabShow",this),this.unsubscribe("userDictionaryAction",this);for(var b in this)this.hasOwnProperty(b)&&delete this[b]},h()});e.add=function(a,b){e._.dialogDefinitions[a]||(e._.dialogDefinitions[a]=b)},e.getNextId=function(){var a=0;return function(b){return(b||"")+ ++a}}(),e._={dialogDefinitions:{}},a.Dialog=e,a._=a._||{},a._.uiElements=a._.uiElements||{},a.registerUIElement=function(a,b){this._.uiElements[a]=b},a.createUIElement=function(a,b,c){var d=this._.uiElements[a],e=null;return"function"==typeof d&&(e=new d(b,c)),e}}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";{var c=b.Utils;b.UILib}a=a||{};var d=c.extend(a.Component,function(c,d){function e(){k.appendTo&&(f(),k.addTabs(k.tabDefinitions),k.setActiveTab(c.activeIndex))}function f(){var a="",b=null;m.create(r.name,r.text),a=m.render(r.name,{extraClass:k.extraClass}),b=l.appendTo(a,k.appendTo),n=l.filter(b,".sc-tabset")[0],n||(n=l.find(".sc-tabset",b)[0]),k.element=o=l.filter(b,".sc-tabview-panel")[0],o||(o=l.find(".sc-tabview-panel",b)[0])}function g(a){return p[a]}function h(a){return p[Object.keys(p)[a]]}function i(a){var b=-1;for(var c in p)if(b++,c==a.id)break;return b}function j(a){var b,c=k.getTab(a),d=null,e=0;return c&&(b=Object.keys(p),b.length>1&&(e=b.indexOf(c.id)+1,"undefined"==typeof b[e]&&(e=0),d=k.getTab(e))),d}var k=this,l=b.UILib,m=(b.Utils,b.Template),n=null,o=null,p={},q=0,r={name:"uiTabbedNavTpl",text:'<ul class="sc-tabset <%=extraClass%>"></ul><div class="sc-tabview-panel <%=extraClass%>"></div>'};this.appendTo=c.appendTo,this.tabDefinitions=c.tabs||[],q=c.activeIndex||q,this.extraClass=c.extraClass||"",this.dialog=d,this.addTab=function(b){var c,e;e=new a.Tab({id:b?b.id:"",title:b?b.title:"",style:b.style||"",extraClass:b.extraClass||"",elements:b.elements||[],tabset:n,tabsHolder:o,onLoad:b.onLoad,onShow:b.onShow,onHide:b.onHide,onClick:function(){k.setActiveTab(e.id),b.onClick&&b.onClick.call(this)}},d),p[e.id]&&k.removeTab(e.id),p[e.id]=e,e.hide(),c=k.getTab(q),c&&c.isActive()||k.setActiveTab(0)},this.addTabs=function(a){for(var b,c=0;b=a[c],c<a.length;c++)this.addTab(b)},this.removeTab=function(a){var b=!1,c=null,d=k.getTab(a);return d&&(d.isActive()&&(c=j(a),c&&k.setActiveTab(c.id)),delete p[d.id],d.destroy(),b=!0),b},this.getActiveTabIndex=function(){return q},this.setActiveTab=function(a){var b=k.getTab(a);
if(b){q=i(b);for(var c in p)p[c].hide();b.show(),this.dialog.fire("afterTabShow",{tab:b})}},this.getTab=function(a){var b=null;switch(typeof a){case"string":b=g(a);break;case"number":b=h(a)}return b},this.getTabsLength=function(){return Object.keys(p).length},this.destroy=function(){for(var a in p)p[a].destroy();p={},l.remove(n),l.remove(o);for(var b in this)this.hasOwnProperty(b)&&delete this[b]},e()});a.TabbedNavigation=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(i(),"function"==typeof k.onLoad&&k.onLoad.call(k,a))},k),"function"==typeof k.onShow&&e.subscribe("onShow",k.onShow,k),"function"==typeof k.onHide&&e.subscribe("onHide",k.onHide,k),g()}function g(){var b="",c="";l.create(p.name,p.text),b=l.render(p.name,{extraClass:k.extraClass,label:k.title,href:k.id}),m=d.create(b)[0],d.appendTo(m,k.tabset),m=d.filter(m,".sc-tabset__tab")[0],m||(m=d.find(".sc-tabset__tab",m)[0]),l.create(q.name,q.text),c=l.render(q.name,{extraClass:k.extraClass}),k.element=n=d.create(c)[0],o=a.createUIElement("vbox",{type:"vbox",extraClass:"sc-tabset__tab-content",style:k.style,children:k.elementsDefinitions},e),o.appendTo(n),d.appendTo(n,k.tabsHolder)}function h(a){a.preventDefault(),"function"==typeof k.onClick&&k.onClick.call(k,{event:a})}function i(){e.subscribe({eventType:"click",element:d.find("a",m)[0],handler:h})}function j(){e.unsubscribe({eventType:"click",element:d.find("a",m)[0],handler:h})}var k=this,l=b.Template,m=null,n=null,o=null,p={name:"uiTabSwitcherHolderTpl",text:'<li class="sc-tabset__tab <%=extraClass%>"><a class="sc-tabset__link" href="#tab-<%=href%>" title="<%=label%>"><span class="sc-tabset__tab-text"><%=label%></span></a></li>'},q={name:"uiTabTpl",text:'<div class="sc-tabset__tab-panel <%=extraClass%>"></div>'};this.id=c.id||a.Dialog.getNextId("sc-tab_"),this.title=c.title||this.id,this.style=c.style||"width: 100%;",this.extraClass=c.extraClass||"",this.elementsDefinitions=c.elements||[],this.activeClass="sc-tabset__tab_active",this.tabset=c.tabset,this.tabsHolder=c.tabsHolder,this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onClick=c.onClick,this.dialog=e,this.show=function(){d.addClass(m,k.activeClass),d.css(n,{display:"block"})},this.hide=function(){d.removeClass(m,k.activeClass),d.css(n,{display:"none"})},this.isActive=function(){return d.hasClass(m,k.activeClass)},this.getChildren=function(){return o.getChildren()},this.destroy=function(){j(),e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),o.destroy(),d.remove(m),d.remove(d.find("a",m)[0]),d.remove(n);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.Tab=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(h(),"function"==typeof o.onLoad&&o.onLoad.call(o,a))},o),"function"==typeof o.onShow&&e.subscribe("onShow",o.onShow,o),"function"==typeof o.onHide&&e.subscribe("onHide",o.onHide,o),o.storable&&e.subscribe("onClose",function(a){a.sender.dialogName===e.dialogName&&o.commit()},o),o.element=q=g()}function g(){var a="",b=null;return p.create(t.name,t.text),a=p.render(t.name,{radioId:o.id,name:o.name,value:o.value,labelText:o.label,checked:c.checked?"checked":"",disabled:c.disabled?"disabled":"",style:o.style,extraClass:c.disabled?s+" "+o.extraClass:o.extraClass}),b=d.create(a)[0],r=d.find("input",b)[0],b}function h(){e.subscribe({eventType:"focus",element:r,handler:j}),e.subscribe({eventType:"blur",element:r,handler:k}),e.subscribe({eventType:"click",element:r,handler:l}),e.subscribe({eventType:"change",element:r,handler:m}),e.subscribe({eventType:"keydown",element:r,handler:n})}function i(){e.unsubscribe({eventType:"focus",element:r,handler:j}),e.unsubscribe({eventType:"blur",element:r,handler:k}),e.unsubscribe({eventType:"click",element:r,handler:l}),e.unsubscribe({eventType:"change",element:r,handler:m}),e.unsubscribe({eventType:"keydown",element:r,handler:n})}function j(a){var b=a;o.isDisabled()&&b.preventDefault(),"function"!=typeof o.onFocus||o.isDisabled()||o.onFocus.call(o,{event:a})}function k(a){var b=a;o.isDisabled()&&b.preventDefault(),"function"!=typeof o.onBlur||o.isDisabled()||o.onBlur.call(o,{event:a})}function l(a){var b=a;o.isDisabled()&&b.preventDefault(),"function"!=typeof o.onClick||o.isDisabled()||o.onClick.call(o,{event:a})}function m(a){var b=a;o.isDisabled()&&b.preventDefault(),"function"!=typeof o.onChange||o.isDisabled()||o.onChange.call(o,{event:a})}function n(a){var b=a;o.isDisabled()&&b.preventDefault(),"function"!=typeof o.onKeydown||o.isDisabled()||o.onKeydown.call(o,{event:a})}var o=this,p=b.Template,q=null,r=null,s="sc-radio_disabled",t={name:"uiRadioTpl",text:'<span class="sc-radio-wrapper <%=extraClass%>" style="<%=style%>"><input id="<%=radioId%>" name="<%=name%>" class="sc-input-radio sc-focusable" value="<%=value%>" type="radio" <%=checked%> <%=disabled%> /><label for="<%=radioId%>"><%=labelText%></label></span>'};this.id=c.id||a.Dialog.getNextId("sc-radio_"),this.name=c.name||"",this.type=c.type,this.value=c.value||"",this.storable=!!c.storable,this.storedValue=!!c.checked,this.label=c.label||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onFocus=c.onFocus,this.onBlur=c.onBlur,this.onClick=c.onClick,this.onChange=c.onChange,this.onKeydown=c.onKeydown,this.dialog=e,this.getInputElement=function(){return r},this.check=function(){this.isDisabled()||(r.checked=!0)},this.uncheck=function(){this.isDisabled()||(r.checked=!1)},this.isChecked=function(){return r.checked},this.setValue=function(a){this.isDisabled()||(r.value=a)},this.getValue=function(){return r.value},this.enable=function(){d.removeClass(q,s),r.disabled=!1},this.disable=function(){d.addClass(q,s),r.disabled=!0},this.isDisabled=function(){return d.hasClass(q,s)&&r.disabled},this.commit=function(){this.storedValue=this.isChecked()},this.reset=function(){this[this.storedValue?"check":"uncheck"](),this.commit()},this.isChanged=function(){return this.storedValue!==this.isChecked()},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),e.unsubscribe("onClose",this),i(),d.remove(q);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.RadioButton=e,a.registerUIElement("radio",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(h(),"function"==typeof o.onLoad&&o.onLoad.call(o,a))},this),"function"==typeof o.onShow&&e.subscribe("onShow",o.onShow,o),"function"==typeof o.onHide&&e.subscribe("onHide",o.onHide,o),o.storable&&e.subscribe("onClose",function(a){a.sender.dialogName===e.dialogName&&o.commit()},o),o.element=q=g()}function g(){var a="",b=null;return p.create(t.name,t.text),a=p.render(t.name,{checkboxId:o.id,name:o.name,value:o.value,labelText:o.label,checked:c.checked?"checked":"",disabled:c.disabled?"disabled":"",style:o.style,extraClass:c.disabled?s+" "+o.extraClass:o.extraClass}),b=d.create(a)[0],r=d.find("input",b)[0],b}function h(){e.subscribe({eventType:"focus",element:r,handler:j}),e.subscribe({eventType:"blur",element:r,handler:k}),e.subscribe({eventType:"click",element:r,handler:l}),e.subscribe({eventType:"keydown",element:r,handler:n}),e.subscribe({eventType:"change",element:r,handler:m})}function i(){e.unsubscribe({eventType:"focus",element:r,handler:j}),e.unsubscribe({eventType:"blur",element:r,handler:k}),e.unsubscribe({eventType:"click",element:r,handler:l}),e.unsubscribe({eventType:"keydown",element:r,handler:n}),e.unsubscribe({eventType:"change",element:r,handler:m})}function j(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onFocus||o.isDisabled()||o.onFocus.call(o,{event:a})}function k(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onBlur||o.isDisabled()||o.onBlur.call(o,{event:a})}function l(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onClick||o.isDisabled()||o.onClick.call(o,{event:a})}function m(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onChange||o.isDisabled()||o.onChange.call(o,{event:a})}function n(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onKeydown||o.isDisabled()||o.onKeydown.call(o,{event:a})}var o=this,p=b.Template,q=null,r=null,s="sc-checkbox_disabled",t={name:"uiCheckboxTpl",text:'<span class="sc-checkbox-wrapper <%=extraClass%>" style="<%=style%>"><input id="<%=checkboxId%>" name="<%=name%>" class="sc-input-checkbox sc-focusable" value="<%=value%>" type="checkbox" <%=checked%> <%=disabled%> /><label for="<%=checkboxId%>"><%=labelText%></label></span>'};this.id=c.id||a.Dialog.getNextId("sc-checkbox_"),this.name=c.name||"",this.type=c.type,this.value=c.value||"",this.storable=!!c.storable,this.storedValue=!!c.checked,this.label=c.label||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onFocus=c.onFocus,this.onBlur=c.onBlur,this.onClick=c.onClick,this.onChange=c.onChange,this.onKeydown=c.onKeydown,this.dialog=e,this.getInputElement=function(){return r},this.check=function(){this.isDisabled()||(r.checked=!0)},this.uncheck=function(){this.isDisabled()||(r.checked=!1)},this.isChecked=function(){return r.checked},this.setValue=function(a){this.isDisabled()||(r.value=a)},this.getValue=function(){return r.value},this.enable=function(){d.removeClass(q,s),r.disabled=!1},this.disable=function(){d.addClass(q,s),r.disabled=!0},this.isDisabled=function(){return d.hasClass(q,s)&&r.disabled},this.commit=function(){this.storedValue=this.isChecked()},this.reset=function(){this[this.storedValue?"check":"uncheck"](),this.commit()},this.isChanged=function(){return this.storedValue!==this.isChecked()},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),e.unsubscribe("onClose",this),i(),d.remove(q);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.Checkbox=e,a.registerUIElement("checkbox",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(e,f){function g(){"function"==typeof i.onLoad&&f.subscribe("onLoad",i.onLoad,i),"function"==typeof i.onShow&&f.subscribe("onShow",i.onShow,i),"function"==typeof i.onHide&&f.subscribe("onHide",i.onHide,i),h()}function h(){var a="";j.create(l.name,l.text),a=j.render(l.name,{extraClass:i.extraClass,style:i.style}),i.element=k=d.create(a)[0],j.create(m.name,m.text),d.each(i.childrenDefinitions,function(a,b){i.addChild(b)})}var i=this,j=b.Template,k=null,l={name:"uiVContainerTpl",text:'<div class="sc-vbox <%=extraClass%>" style="<%=style%>"></div>'},m={name:"uiVContainerChildTpl",text:'<div class="sc-vbox-child"></div>'},n={};this.id=e.id||a.Dialog.getNextId("sc-vbox_"),this.type=e.type,this.style=e.style||"",this.extraClass=e.extraClass||"",this.widths=c.is(e.widths,"Array")?e.widths:[],this.childrenDefinitions=e.children||[],this.onLoad=e.onLoad,this.onShow=e.onShow,this.onHide=e.onHide,this.dialog=f,this.addChild=function(b){var c=j.render(m.name,{}),e=d.create(c)[0],g=a.createUIElement(b.type,b,f);if(!g)throw new Error('Unable to create UI element with type "'+b.type+'". No such element.');n[g.id]=g,g.appendTo(e);var h=this.getIndexOfChild(g.id),i=this.widths[h]||"";return d.css(e,{width:i}),d.appendTo(e,k),g},this.removeChild=function(a){var b=n[a],c=!1;return b&&(b.destroy(),delete n[a],c=!0),c},this.getChildren=function(){return n},this.getIndexOfChild=function(a){for(var b=-1,c=Object.keys(n),d=0,e=c.length;e>d;d++)if(c[d]===a){b=d;break}return b},this.disable=function(){for(var a in n)"function"==typeof a.disable&&a.disable()},this.enable=function(){for(var a in n)"function"==typeof a.enable&&a.enable()},this.destroy=function(){f.unsubscribe("onLoad",this),f.unsubscribe("onShow",this),f.unsubscribe("onHide",this);for(var a in n)i.removeChild(a.id);d.remove(k);for(var b in this)this.hasOwnProperty(b)&&delete this[b]},g()});a.VerticalContainer=e,a.registerUIElement("vbox",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(e,f){function g(){"function"==typeof i.onLoad&&f.subscribe("onLoad",i.onLoad,i),"function"==typeof i.onShow&&f.subscribe("onShow",i.onShow,i),"function"==typeof i.onHide&&f.subscribe("onHide",i.onHide,i),h()}function h(){var a="";j.create(l.name,l.text),a=j.render(l.name,{extraClass:i.extraClass,style:i.style}),i.element=k=d.create(a)[0],j.create(m.name,m.text),d.each(i.childrenDefinitions,function(a,b){i.addChild(b)})}var i=this,j=b.Template,k=null,l={name:"uiHContainerTpl",text:'<div class="sc-hbox <%=extraClass%>" style="<%=style%>"></div>'},m={name:"uiHContainerChildTpl",text:'<div class="sc-hbox-child"></div>'},n={};this.id=e.id||a.Dialog.getNextId("sc-hbox_"),this.type=e.type,this.style=e.style||"",this.extraClass=e.extraClass||"",this.widths=c.is(e.widths,"Array")?e.widths:[],this.childrenDefinitions=e.children||[],this.onLoad=e.onLoad,this.onShow=e.onShow,this.onHide=e.onHide,this.dialog=f,this.addChild=function(b){var c=j.render(m.name,{}),e=d.create(c)[0],g=a.createUIElement(b.type,b,f);if(!g)throw new Error('Unable to create UI element with type "'+b.type+'". No such element.');n[g.id]=g,g.appendTo(e);var h=this.getIndexOfChild(g.id),i=this.widths[h]||"";return d.css(e,{width:i}),d.appendTo(e,k),g},this.removeChild=function(a){var b=n[a],c=!1;return b&&(b.destroy(),delete n[a],c=!0),c},this.getChildren=function(){return n},this.getIndexOfChild=function(a){for(var b=-1,c=Object.keys(n),d=0,e=c.length;e>d;d++)if(c[d]===a){b=d;break}return b},this.disable=function(){for(var a in n)"function"==typeof a.disable&&a.disable()},this.enable=function(){for(var a in n)"function"==typeof a.enable&&a.enable()},this.destroy=function(){f.unsubscribe("onLoad",this),f.unsubscribe("onShow",this),f.unsubscribe("onHide",this);for(var a in n)i.removeChild(a.id);d.remove(k);for(var b in this)this.hasOwnProperty(b)&&delete this[b]},g()});a.HorizontalContainer=e,a.registerUIElement("hbox",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(h(),"function"==typeof k.onLoad&&k.onLoad.call(k,a))},k),"function"==typeof k.onShow&&e.subscribe("onShow",k.onShow,k),"function"==typeof k.onHide&&e.subscribe("onHide",k.onHide,k),g()}function g(){var a="";l.create(n.name,n.text),a=l.render(n.name,{extraClass:k.extraClass,style:k.style}),k.element=m=d.create(a)[0],l.create(o.name,o.text),d.each(k.childrenDefinitions,function(a,b){k.addChild(b)})}function h(){e.subscribe({eventType:"click",element:m,handler:j})}function i(){e.unsubscribe({eventType:"click",element:m,handler:j})}function j(a){a.preventDefault(),"function"==typeof k.onClick&&k.onClick.call(k,{event:a})}var k=this,l=b.Template,m=null,n={name:"uiItemListTpl",text:'<div class="sc-item-list <%=extraClass%>" style="<%=style%>"></div>'},o={name:"uiItemListChildTpl",text:'<div class="sc-item-list-child" data-ud-word="<%=itemText%>"><span class="sc-item-list__text"><%=itemText%></span><a class="sc-item-list__icon sc-item-list__icon_close sc-focusable" href="javascript:void(0)" title="<%=title%>" role="button" aria-label="<%=title%>"></a></div>'},p=[],q=!1;this.id=c.id||a.Dialog.getNextId("sc-item-list_"),this.type=c.type,this.title=c.title||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.childrenDefinitions=c.children||[],this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onClick=c.onClick,this.dialog=e,this.addChild=function(a,b){var c=l.render(o.name,{itemText:a,title:k.title}),e=d.create(c)[0];p.push(a),b?d.prependTo(e,m):d.appendTo(e,m)},this.removeChild=function(a,b){p.splice(p.indexOf(b),1),m.removeChild(a)},this.removeAllChild=function(){p=[],m.innerHTML=""},this.inChildren=function(a){return p.includes(a)},this.block=function(){q=!0},this.unblock=function(){q=!1},this.isBlocked=function(){return q},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),i(),d.remove(m);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.ItemList=e,a.registerUIElement("itemList",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(h(),"function"==typeof o.onLoad&&o.onLoad.call(o,a))},o),"function"==typeof o.onShow&&e.subscribe("onShow",o.onShow,o),"function"==typeof o.onHide&&e.subscribe("onHide",o.onHide,o),o.storable&&(e.subscribe("onSubmit",function(a){a.sender.dialogName===e.dialogName&&o.commit()},o),e.subscribe("onClose",function(a){a.sender.dialogName===e.dialogName&&o.reset()},o),e.subscribe("onCancel",function(a){a.sender.dialogName===e.dialogName&&o.reset()},o)),o.element=q=g()}function g(){var a="",b=null;return p.create(t.name,t.text),a=p.render(t.name,{inputId:o.id,name:o.name,value:o.value,labelText:o.label,placeholder:o.placeholder,maxLength:o.maxLength,disabled:c.disabled?"disabled":"",style:o.style,extraClass:o.extraClass}),b=d.create(a)[0],r=d.find("input",b)[0],b}function h(){e.subscribe({eventType:"focus",element:r,handler:j}),e.subscribe({eventType:"blur",element:r,handler:k}),e.subscribe({eventType:"click",element:r,handler:l}),e.subscribe({eventType:"change",element:r,handler:m}),e.subscribe({eventType:"keydown",element:r,handler:n})}function i(){e.unsubscribe({eventType:"focus",element:r,handler:j}),e.unsubscribe({eventType:"blur",element:r,handler:k}),e.unsubscribe({eventType:"click",element:r,handler:l}),e.unsubscribe({eventType:"change",element:r,handler:m}),e.unsubscribe({eventType:"keydown",element:r,handler:n})}function j(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onFocus||o.isDisabled()||o.onFocus.call(o,{event:a})}function k(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onBlur||o.isDisabled()||o.onBlur.call(o,{event:a})}function l(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onClick||o.isDisabled()||o.onClick.call(o,{event:a})}function m(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onChange||o.isDisabled()||o.onChange.call(o,{event:a})}function n(a){o.isDisabled()&&a.preventDefault(),"function"!=typeof o.onKeydown||o.isDisabled()||o.onKeydown.call(o,{event:a})}var o=this,p=b.Template,q=null,r=null,s="sc-input-text_disabled",t={name:"uiTextInputTpl",text:'<div class="sc-text-input-wrapper <%=extraClass%>" style="<%=style%>"><label for="<%=inputId%>" id="sc-label_<%=inputId%>"><%=placeholder%></label><div class="sc-text-input-holder"><input id="<%=inputId%>" name="<%=name%>" maxlength="<%=maxLength%>" class="sc-input-text sc-focusable" type="text" placeholder="<%=placeholder%>" value="<%=value%>" <%=disabled%> autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" aria-labelledby="sc-label_<%=inputId%>" /></div></div>'};this.id=c.id||a.Dialog.getNextId("sc-text-input_"),this.name=c.name||"",this.type=c.type,this.value=c.value||"",this.storable=!!c.storable,this.storedValue=this.value,this.label=c.label||"",this.placeholder=c.placeholder||"",this.maxLength=c.maxLength||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onFocus=c.onFocus,this.onBlur=c.onBlur,this.onClick=c.onClick,this.onChange=c.onChange,this.onKeydown=c.onKeydown,this.dialog=e,this.getValue=function(){return r.value},this.setValue=function(a){this.isDisabled()||(r.value=a)},this.enable=function(){d.removeClass(q,s),r.disabled=!1},this.disable=function(){d.addClass(q,s),r.disabled=!0},this.isDisabled=function(){return d.hasClass(r,s)&&r.disabled},this.commit=function(){this.storedValue=this.getValue()},this.reset=function(){this.setValue(this.storedValue),this.commit()},this.isChanged=function(){return this.storedValue!==this.getValue()},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),e.unsubscribe("onSubmit",this),e.unsubscribe("onClose",this),e.unsubscribe("onCancel",this),i(),d.remove(q);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.TextInput=e,a.registerUIElement("text",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){"function"==typeof h.onLoad&&e.subscribe("onLoad",h.onLoad,h),"function"==typeof h.onShow&&e.subscribe("onShow",h.onShow,h),"function"==typeof h.onHide&&e.subscribe("onHide",h.onHide,h),h.element=j=g()}function g(){var a="";return i.create(k.name,k.text),a=i.render(k.name,{html:h.html,style:h.style,extraClass:h.extraClass}),d.create(a)[0]}var h=this,i=b.Template,j=null,k={name:"uiHtmlTpl",text:'<div class="sc-html <%=extraClass%>" style="<%=style%>"><%=html%></div>'};this.id=c.id||a.Dialog.getNextId("sc-html_"),this.type=c.type,this.html=c.html||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.dialog=e,this.setHtml=function(a){d.html(j,a)},this.getHtml=function(){return d.html(j)},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),d.remove(j);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.HtmlContainer=e,a.registerUIElement("html",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=b.UILib;a=a||{};var e=c.extend(a.Component,function(c,e){function f(){e.subscribe("onLoad",function(a){a.sender.dialogName===e.dialogName&&(h(),"function"==typeof n.onLoad&&n.onLoad.call(n,a))},n),"function"==typeof n.onShow&&e.subscribe("onShow",n.onShow,n),"function"==typeof n.onHide&&e.subscribe("onHide",n.onHide,n),n.element=p=g()}function g(){var a="";return o.create(r.name,r.text),a=o.render(r.name,{id:n.id,buttonHtml:n.text,title:n.title,label:n.label,href:n.href,target:n.target,buttonStyle:n.style,extraClass:c.disabled?q+" "+n.extraClass:n.extraClass}),d.create(a)[0]}function h(){e.subscribe({eventType:"focus",element:p,handler:j}),e.subscribe({eventType:"blur",element:p,handler:k}),e.subscribe({eventType:"click",element:p,handler:l}),e.subscribe({eventType:"keydown",element:p,handler:m})}function i(){e.unsubscribe({eventType:"focus",element:p,handler:j}),e.unsubscribe({eventType:"blur",element:p,handler:k}),e.unsubscribe({eventType:"click",element:p,handler:l}),e.unsubscribe({eventType:"keydown",element:p,handler:m})}function j(a){n.isDisabled()&&a.preventDefault(),"function"!=typeof n.onFocus||n.isDisabled()||n.onFocus.call(n,{event:a})}function k(a){n.isDisabled()&&a.preventDefault(),"function"!=typeof n.onBlur||n.isDisabled()||n.onBlur.call(n,{event:a})}function l(a){(!n.href||"#"===n.href||n.isDisabled())&&a.preventDefault(),"function"!=typeof n.onClick||n.isDisabled()||n.onClick.call(n,{event:a})}function m(a){n.isDisabled()&&a.preventDefault(),"function"!=typeof n.onKeydown||n.isDisabled()||n.onKeydown.call(n,{event:a})}var n=this,o=b.Template,p=null,q="sc-button_disabled",r={name:"uiButtonTpl",text:'<a class="sc-button sc-focusable <%=extraClass%>" href="<%=href%>" title="<%=title%>" style="<%=buttonStyle%>" target="<%=target%>" role="button" aria-labelledby="sc-label_<%=id%>"><%=buttonHtml%><span id="sc-label_<%=id%>" aria-hidden="false" style="display: none; cursor: default; color: transparent;"><%=label%></span><a/>'};this.id=c.id||a.Dialog.getNextId("sc-button_"),this.type=c.type,this.text=c.text||this.id,this.title=c.title||"",this.label="&#65279;"===this.text?this.title:"",this.href=c.href||"#",this.target=c.target||"",this.style=c.style||"",this.extraClass=c.extraClass||"",this.onLoad=c.onLoad,this.onShow=c.onShow,this.onHide=c.onHide,this.onFocus=c.onFocus,this.onBlur=c.onBlur,this.onClick=c.onClick,this.onKeydown=c.onKeydown,this.dialog=e,this.click=function(){e.fire({eventType:"click",element:p})},this.enable=function(){d.removeClass(p,q)},this.disable=function(){d.addClass(p,q)},this.isDisabled=function(){return d.hasClass(p,q)},this.destroy=function(){e.unsubscribe("onLoad",this),e.unsubscribe("onShow",this),e.unsubscribe("onHide",this),i(),d.remove(p);for(var a in this)this.hasOwnProperty(a)&&delete this[a]},f()});a.Button=e,a.registerUIElement("button",e)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.menuTemplate='<div tabindex="0" class="sc-cm-holder <%=extraMainClass%>"><ul class="sc-cm"></ul></div>',this.menuItemTemplate='<li class="sc-cm__item <%=extraItemClass%>"><a href="javascript: void(0);" class="clrfix" title="<%=innerText%>"><i class="i-icon i-icon_<%=itemName%>"></i><span class="shortcut"><%=shortcutText%></span><%=innerText%></a></li>',this.menuSeparatorTemplate='<li class="sc-cm__item sc-cm__item_separator"></li>',this.isMacOS=this.sandbox.Utils.Browser.mac,this.shortcuts={undo:(this.isMacOS?"&#8984;":"Ctrl")+"+Z",redo:(this.isMacOS?"&#8984;":"Ctrl")+"+Shift+Z",copy:(this.isMacOS?"&#8984;":"Ctrl")+"+C",paste:(this.isMacOS?"&#8984;":"Ctrl")+"+V",cut:(this.isMacOS?"&#8984;":"Ctrl")+"+X"},this.appendTo="body",this.attachTo=this.sandbox.getOption(this.sandbox.getOption("mirrorBasedInstance")?"originalContainer":"container")};b.prototype={init:function(){this.sandbox.UILib;this.menu=new b.Menu(this.sandbox,this.menuTemplate,this.menuItemTemplate,this.shortcutText,this.menuSeparatorTemplate,this.shortcuts,this.appendTo,this.attachTo),this.hide()},show:function(){this.menu.show()},hide:function(){this.menu.hide()},addItem:function(a,b){this.menu.addItem(a,b)},addItems:function(a){this.menu.addItems(a)},addGroup:function(a,b){this.menu.addGroup(a,b)},removeItem:function(a){return this.menu.removeItem(a)},getItem:function(a){return this.menu.getItem(a)},clear:function(){this.menu.clear()},getDOMElement:function(){return this.menu.getDOMElement()}},b.Menu=function(c,d,e,f,g,h,i,j,k){function l(){var a;return P.sandbox.Template.create("cmMenuTpl",P.menuTemplate),a=P.sandbox.Template.render("cmMenuTpl",{extraMainClass:P.extraClass||""}),P.sandbox.Template.remove("cmMenuTpl"),Q.appendTo(a,P.appendTo)}function m(){var a=P.selectedIndex-1;return 0>a&&(a=P.sortedItems.length-1),P.selectItem(a),!0}function n(){var a=P.selectedIndex+1;return a>=P.sortedItems.length&&(a=0),P.selectItem(a),!0}function o(){var a=U[P.sortedItems[P.selectedIndex].itemName];return a.childElement?(P.keyboardNavigation.deActivate(),a.childElement.show()):a.click(),!0}function p(){var a=U[P.sortedItems[P.selectedIndex].itemName];return a.parentElement.isSubmenu?a.parentElement.hide():c.fire("restoreSelection"),!0}function q(a){a.sort(function(a,b){return a.groupOrder<b.groupOrder?-1:a.groupOrder>b.groupOrder?1:a.order<b.order?-1:a.order>b.order?1:0})}function r(){P.sandbox.subscribe(Y?{eventType:"orientationchange",element:window,handler:t}:{eventType:"resize",element:window,handler:t}),P.isSubmenu?(P.sandbox.subscribe({eventType:"mouseenter",element:P.appendTo,handler:G}),P.sandbox.subscribe({eventType:"mouseleave",element:P.appendTo,handler:H})):(Z&&P.sandbox.subscribe({eventType:"touchstart",element:P.attachTo,handler:x}),$||_?($&&P.sandbox.subscribe({eventType:"mouseover",element:P.attachTo,handler:y}),_&&(P.sandbox.subscribe({eventType:"mousemove",element:P.attachTo,handler:C}),P.sandbox.subscribe({eventType:"mousedown",element:P.attachTo,handler:A}),P.sandbox.subscribe({eventType:"mouseup",element:P.attachTo,handler:B})),P.sandbox.subscribe({eventType:"mouseout",element:P.attachTo,handler:z}),P.sandbox.subscribe({eventType:"mouseenter",element:P.menuContainer[0],handler:D}),P.sandbox.subscribe({eventType:"mouseleave",element:P.menuContainer[0],handler:D}),P.sandbox.subscribe({eventType:"keydown",element:document,handler:E}),P.sandbox.subscribe({eventType:"click",element:P.attachTo,handler:E}),P.sandbox.subscribe({eventType:"onShow",handler:F}),P.sandbox.subscribe({eventType:"restoreSelection",handler:E})):P.sandbox.subscribe({eventType:"contextmenu",element:P.attachTo,handler:v}))}function s(){P.sandbox.unsubscribe(Y?{eventType:"orientationchange",element:window,handler:t}:{eventType:"resize",element:window,handler:t}),P.isSubmenu?(P.sandbox.unsubscribe({eventType:"mouseenter",element:P.appendTo,handler:G}),P.sandbox.unsubscribe({eventType:"mouseleave",element:P.appendTo,handler:H})):(Z&&P.sandbox.unsubscribe({eventType:"touchstart",element:P.attachTo,handler:x}),P.sandbox.subscribe({eventType:"blur",element:P.attachTo,handler:P.focusInput}),$||_?($&&P.sandbox.unsubscribe({eventType:"mouseover",element:P.attachTo,handler:y}),_&&(P.sandbox.unsubscribe({eventType:"mousemove",element:P.attachTo,handler:C}),P.sandbox.unsubscribe({eventType:"mousedown",element:P.attachTo,handler:A}),P.sandbox.unsubscribe({eventType:"mouseup",element:P.attachTo,handler:B})),P.sandbox.unsubscribe({eventType:"mouseout",element:P.attachTo,handler:z}),P.sandbox.unsubscribe({eventType:"mouseenter",element:P.menuContainer[0],handler:D}),P.sandbox.unsubscribe({eventType:"mouseleave",element:P.menuContainer[0],handler:D}),P.sandbox.unsubscribe({eventType:"keydown",element:document,handler:E}),P.sandbox.unsubscribe({eventType:"click",element:P.attachTo,handler:E}),P.sandbox.unsubscribe({eventType:"onShow",handler:F}),P.sandbox.unsubscribe({eventType:"restoreSelection",handler:E})):P.sandbox.unsubscribe({eventType:"contextmenu",element:P.attachTo,handler:v}))}function t(){this.hide()}function u(a){var b,c={clientX:a.clientX||null,clientY:a.clientY||null,pageX:a.pageX||null,pageY:a.pageY||null};setTimeout(function(){P.clearPosition(),P.show(),b=J(c),P.setPosition(b.x,b.y)},0)}function v(a){var b,c,d,e;P.sandbox.getOption("paused")||(P.sandbox.Utils.Browser.gecko&&(b=P.sandbox.getSelection(),d=b.getRangeAt(0),c=P.sandbox.getCaretRangeFromEvent(a),d.containsRange(c)===!1&&(b.removeAllRanges(),b.addRange(c))),e=P.sandbox.getSpellingNodeFromSelection(),e||(e=P.sandbox.getGrammarNodeFromSelection()),e&&(a.preventDefault(),u(a)))}function w(){var a,b=P.sandbox.getSelection(),c=L(b);P.sandbox.getOption("paused")||(a=P.sandbox.getSpellingNodeFromSelection(),a||(a=P.sandbox.getGrammarNodeFromSelection()),a&&u({clientX:c.x,clientY:c.y}))}function x(a){var b,c,d,e,f=(new Date).getTime(),g=P.sandbox.getOption("misspelled_word_node"),h=P.sandbox.getOption("data_attribute_name"),i=this.sandbox.getOption("problem_grammar_node"),j=this.sandbox.getOption("problem_grammar_data_attribute"),k=P.sandbox.createRange(),l=window.pageXOffset,m=window.pageYOffset;if(!P.sandbox.getOption("paused")){if(c=P.sandbox.Utils.isEqualNode(a.target,h)?a.target:P.sandbox.UILib.findNodeParents(a.target,g,h)[0],c||(d=P.sandbox.Utils.isEqualNode(a.target,j)?a.target:P.sandbox.UILib.findNodeParents(a.target,i,j)[0]),e=c?c:d,f-cb.time>bb||!e||e!==cb.problemNode)return cb.time=f,cb.event=a,void(cb.problemNode=e);a.preventDefault(),P.sandbox.fire({eventType:"focus",element:P.attachTo}),window.scrollTo(l,m),k.selectNodeContents(c?c:d),b=P.sandbox.getSelection(),b.removeAllRanges(),b.addRange(k),u({clientX:a.targetTouches[0].clientX,clientY:a.targetTouches[0].clientY,pageX:a.targetTouches[0].pageX,pageY:a.targetTouches[0].pageY})}}function y(a){var b,c=a.target,d=P.sandbox.getOption("misspelled_word_class"),e=P.sandbox.getOption("problem_grammar_class");
if(!P.sandbox.getOption("paused")){for(;c!==P.attachTo;){if(Q.hasClass(c,d)){b=!0;break}c=c.parentNode}if(!b)for(c=a.target;c!==P.attachTo&&!Q.hasClass(c,e);)c=c.parentNode;c!==P.attachTo&&c!==db&&(!P.hidden&&E(),db=c,Q.addClass(db,"problem-word_hover"),clearTimeout(N),clearTimeout(O),N=setTimeout(function(){u(a)},500))}}function z(a){var b=a.relatedTarget||a.toElement;if(db){if(b)for(;b;){if(b===db||b===P.menuContainer[0])return;b=b.parentNode}db=null,P.hidden&&F(),clearTimeout(N),O=setTimeout(function(){!eb&&E()},1e3)}}function A(a){if(R.Browser.ie){var b=P.attachTo.getBoundingClientRect(),c=R.getScrollBarsState(P.attachTo);if(c.vertical&&a.clientX<b.right&&a.clientX>b.right-ab)return;if(c.horizontal&&a.clientY<b.bottom&&a.clientY>b.bottom-ab)return}fb=!0}function B(){fb=!1}function C(a){var b,c,d,e,f,g=a.clientX,h=a.clientY,i=R.getCurrentDocument(P.sandbox.getOption("documentContainer")),j=(i.activeElement,P.sandbox.getOption("misspelled_word_class")),k=P.sandbox.getOption("problem_grammar_class");if(!P.sandbox.getOption("paused")&&!fb){b=R.elementsFromPoint(g,h,i);for(var l=0;l<b.length;l++)if(e=Q.hasClass(b[l],j),f=Q.hasClass(b[l],k),e||f){c=f&&Q.hasClass(Q.parent(b[l]),j)?Q.parent(b[l])[0]:b[l];break}db&&c!==db&&z({}),c&&c!==db&&(d=c.getBoundingClientRect(),!P.hidden&&E(),db=c,Q.addClass(db,"problem-word_hover"),clearTimeout(N),clearTimeout(O),N=setTimeout(function(){u({clientX:d.left+(d.right-d.left)/2,clientY:d.bottom})},500))}}function D(){eb=!eb,eb||E()}function E(){P.hidden||(P.hide(),F())}function F(){var a=P.sandbox.getOption("mirrorBasedInstance")?P.sandbox.getOption("container"):P.attachTo,b=Q.find(".problem-word_hover",a);if(b.length)for(var c=0;c<b.length;c++)Q.removeClass(b[c],"problem-word_hover")}function G(){var a;P.clearPosition(),P.show(),a=J(),P.setPosition(a.x,a.y)}function H(){P.hide()}function I(){P.hide()}function J(a){var b,c,d,e,f={x:0,y:0},g=0,h=0,i=S.getScrollLeft(),j=S.getScrollTop(),k=S.getWindowWidth(),l=S.getWindowHeight(),m=Q.outerWidth(W),n=Q.outerHeight(W),o=S.getDocumentHeight(),p=P.sandbox.getOption("documentContainer"),q=P.sandbox.getOption("isIframe");return b=q&&Y?K(p):p.getBoundingClientRect(),P.isSubmenu?(c=Q.outerWidth(P.appendTo),d=Q.outerHeight(P.appendTo),e=Q.offset(P.appendTo),f.x=c,f.y=0,e.left+c+m>i+k&&(f.x-=e.left+c+m-(i+k)),e.top+n>j+l&&(f.y-=e.top+n-(j+l),e.top+f.y<j&&(f.y=o>=j+n?j-e.top:o-n-e.top))):(a.pageX&&a.pageY?(g=q?a.clientX+i+b.left:a.pageX,h=q?a.clientY+j+b.top:a.pageY):(g=a.clientX+i+(q?b.left:0),h=a.clientY+j+(q?b.top:0)),f.x=g,f.y=h,g+m>k+i&&(f.x=g-m,f.x<i&&(f.x=i)),h+n>l+j&&(f.y=h-n,f.y<j&&(f.y=o>=j+n?j:o-n))),f}function K(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop-a.scrollTop+a.clientTop),c+=parseInt(a.offsetLeft-a.scrollLeft+a.clientLeft),a=a.offsetParent;return{top:b,left:c}}function L(a){var b=a.getRangeAt(0).cloneRange(),c=document.createElement("span"),d={x:0,y:0},e={};return b.collapse(!0),c.appendChild(document.createTextNode("​")),b.insertNode(c),e=c.getBoundingClientRect(),d.x=e.left,d.y=e.bottom,c.parentNode.removeChild(c),d}function M(){var a;P.sandbox.Template.create("cmMenuSeparatorTpl",P.menuSeparatorTemplate),a=P.sandbox.Template.render("cmMenuSeparatorTpl",{}),Q.appendTo(a,X)}var N,O,P=this,Q=c.UILib,R=c.Utils,S=c.UIMetrics,T=a.KeyboardNavigation,U={},V={"default":100},W=null,X=null,Y=c.getOption("isTouchDevice"),Z=c.getOption("enableOnTouchDevices"),$=c.getOption("contextMenuByMouseover"),_=c.getOption("mirrorBasedInstance"),ab=_&&R.getScrollWidth(),bb=300,cb={time:0,event:{},problemNode:null},db=null,eb=!1,fb=!1,gb=c.getOption("modifierKeys").SHIFT;this.sandbox=c,this.menuTemplate=d,this.menuItemTemplate=e,this.menuSeparatorTemplate=g,this.shortcuts=h,this.appendTo=i,this.attachTo=Q.find(j)[0],this.extraClass=k,this.isSubmenu=!this.attachTo,this.sortedItems=[],this.selectedIndex=-1,this.hidden=this.isSubmenu?!0:!1,this.menuContainer=W=l(),P.sandbox.subscribe({eventType:"contextmenu",element:W[0],handler:function(a){a.preventDefault()}}),X=Q.find(".sc-cm",W),r(),this.keyboardNavigation=new T(document,{38:m,40:n,9:n,37:p,39:o,32:o,13:o,27:p},this.sandbox),this.sandbox.subscribe("allModulesReady",function(){!$&&this.sandbox.fire("setShortcuts",{shortcuts:[{shortcut:gb+121,callback:w,context:P}]})}),this.show=function(){if(this.hidden!==!1){this.sortedItems=[],this.selectedIndex=-1;var a=this;this.clear(),this.isSubmenu||this.sandbox.fire("beforeContextMenuShow",{problemNode:db});for(var b in U)this.sortedItems.push({itemName:U[b].itemName,groupOrder:V[U[b].group],groupName:U[b].group,order:U[b].order});q(this.sortedItems);for(var c=this.sortedItems.length,d=c&&this.sortedItems[0].groupName,e=0;c>e;e++)d!=this.sortedItems[e].groupName&&"moresuggest"!=this.sortedItems[e].groupName&&(M(),d=this.sortedItems[e].groupName),U[this.sortedItems[e].itemName].appendTo(X);Q.addClass(W,"sc-cm_show"),Q.removeClass(W,"sc-cm_hide"),this.isSubmenu||$||_||(this.sandbox.unsubscribe({eventType:"blur",element:W[0],handler:I}),this.sandbox.subscribe({eventType:"blur",element:W[0],handler:I}),setTimeout(function(){a.sandbox.fire({eventType:"focus",element:W[0]})},0)),this.hidden=!1,this.selectItem(0),$||(this.isSubmenu&&this.parentElement.parentElement.keyboardNavigation.deActivate(),this.keyboardNavigation.activate())}},this.hide=function(){var a=this.getVisibleSubmenu();a&&a.hide(),this.hidden||(Q.addClass(W,"sc-cm_hide"),Q.removeClass(W,"sc-cm_show"),this.removeActive(),this.isSubmenu||$||this.sandbox.subscribe({eventType:"blur",element:W[0],handler:I}),this.hidden=!0,this.isSubmenu||this.sandbox.fire("contextMenuHide",{}),$||(this.keyboardNavigation.deActivate(),this.isSubmenu&&!this.parentElement.parentElement.hidden&&this.parentElement.parentElement.keyboardNavigation.activate()))},this.addItem=function(a,c){"undefined"==typeof c.group&&(c.group="default"),"undefined"!=typeof V[c.group]&&(U[a]=new b.MenuItem(this,a,c))},this.addItems=function(a){for(var b in a)this.addItem(b,a[b])},this.addGroup=function(a,b){V[a]="number"==typeof b?b:100},this.removeItem=function(a){var b=!1;return a&&U[a]&&(U[a].destroy(),delete U[a],b=!0),b},this.getItem=function(a){var b=U[a];if(!b)for(var c in U)if(U[c].childElement&&(b=U[c].childElement.getItem(a)),b)break;return b},this.getVisibleSubmenu=function(){var a,b=null;for(var c in U)if(a=U[c].childElement,a&&!a.hidden){b=a;break}return b},this.selectItem=function(a){var b=this.sortedItems[a];b&&(U[b.itemName].setActive(),this.selectedIndex=a)},this.clear=function(){if(!this.isSubmenu)for(var a in U)this.removeItem(a);Q.empty(X)},this.setPosition=function(a,b){Q.setPosition(W,a,b)},this.clearPosition=function(){Q.css(W,{left:-9999,top:-9999})},this.getDOMElement=function(){return W},this.destroy=function(){this.clear(),s(),Q.remove(W)},this.removeActive=function(){var a=Q.find(".sc-cm__item_active",this.getDOMElement())[0];Q.removeClass(a,"sc-cm__item_active")}},b.MenuItem=function(a,c,d){function e(){var a="";return g.sandbox.Template.create("cmMenuItemTpl",g.menuItemTemplate),a=g.sandbox.Template.render("cmMenuItemTpl",{itemName:g.itemName,innerText:g.itemTitle,shortcutText:g.shortcutText,extraItemClass:g.extraClass}),i.create(a)[0]}function f(a){var b=a,c=!0,d=g.getParentContextMenu();a.preventDefault(),g.disabledState||"function"!=typeof g.onClick||(c=g.onClick(b)),c===!1&&d.hide()}var g=this,h=a.sandbox,i=h.UILib,j=null;this.parentElement=a,this.childElement=null,this.sandbox=this.parentElement.sandbox,this.menuTemplate=this.parentElement.menuTemplate,this.menuItemTemplate=this.parentElement.menuItemTemplate,this.menuSeparatorTemplate=this.parentElement.menuSeparatorTemplate,this.disabledState=d.disabled,this.itemName=c,this.itemTitle=d.itemTitle,this.extraClass=d.extraClass,this.shortcutText=a.shortcuts[c]?a.shortcuts[c]:"",this.order="number"==typeof d.order?d.order:0,this.group=d.group,this.focusable="boolean"==typeof d.focusable?d.focusable:!0,this.onClick=d.onClick,this.appendTo=function(a){i.appendTo(j,a),this.attachEvents()},this.destroy=function(){this.childElement&&(this.childElement.destroy(),this.childElement=null),this.detachEvents(),i.remove(j)},this.addItem=function(a,c){this.childElement||(this.childElement=new b.Menu(this.sandbox,this.menuTemplate,this.menuItemTemplate,this.shortcutText,this.menuSeparatorTemplate,this.parentElement.shortcuts,j,null,"sc-cm_dropdown-menu"),this.childElement.parentElement=this,i.addClass(j,"sc-cm__item_dropdown sc-cm__item_arrow")),this.childElement.addItem(a,c)},this.addItems=function(a){for(var b in a)this.addItem(b,a[b])},this.is=function(a){return j===a},this.attachEvents=function(){this.detachEvents(),g.sandbox.subscribe({eventType:"mousedown",element:j,handler:f})},this.detachEvents=function(){g.sandbox.unsubscribe({eventType:"mousedown",element:j,handler:f})},this.getDomElement=function(){return j},this.setDisabled=function(a){g.disabledState=a,i[a?"addClass":"removeClass"](j,"sc-cm__item_disabled")},this.setActive=function(){a.removeActive(),i.addClass(j,"sc-cm__item_active")},this.click=function(){h.fire({eventType:"mousedown",element:j})},this.getParentContextMenu=function(){var a=this;do a=a.parentElement;while(a.parentElement);return a},j=e(),this.setDisabled(this.disabledState)},a.ContextMenu=b}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b,c,d=function(a,d){b=d.UILib,c=d.Utils,this.name=a,this.sandbox=d,this.elementTemplate='<div class="sc-sb-holder <%=extraClass%>" style="display: none;"><div class="sc-sb-big"><ul class="sc-sb__items"></ul><div class="sc-sb"></div></div><div class="sc-sb-small"></div></div>',this.elementItemTemplate='<li class="sc-sb__item sc-sb__item-<%=itemName%> <%=extraItemClass%>"><a href="javascript: void(0);" title="<%=innerText%>"><i class="sc-sb-icon sc-sb-icon_<%=itemName%>"></i></a></li>',this.container=this.sandbox.getOption("documentContainer"),this.insertAfter=this.sandbox.getOption("mirrorBasedInstance")?this.sandbox.getOption("originalContainer"):this.container,this.attachTo=this.sandbox.getOption("container"),this.problemsCount=0,this.menuItems={},this.isEnabled=!0,this.isMutationObserver=this.sandbox.getOption("isMutationObserver"),this.timeoutDelay=2e3,this.timeoutId=null,this.visibilityApiData=c.getVisibilityApiData()};d.prototype={init:function(){var a=this;this.sandbox.getOption("enableBadgeButton")&&(this.badgeContainer=this.render(),this.setPositionAndSize(),this.badge=b.find(".sc-sb",this.badgeContainer),this.badgeList=b.find(".sc-sb__items",this.badgeContainer),this.attachEvents(),!this.isMutationObserver&&this.startChecking(),this.sandbox.subscribe("spellCheckStarted",function(){a.setChecking(!0)},this,-2e3),this.sandbox.subscribe("spellCheckEnded",function(){a.update(),a.changeBgColor(),a.setChecking()},this,-2e3),this.sandbox.subscribe("removedMarkupInContainer, removeMarkupFromWords",function(){a.update(),a.changeBgColor()},this,-2e3),this.sandbox.subscribe("periodicalChecking",function(){a.changePosition()}),this.sandbox.subscribe("toggleApp",function(b){b.flag?(a.isEnabled=!0,a.setChecking(!0),a.setDisabled()):(a.problemsCount=0,a.changeBgColor(),a.setChecking(),a.setDisabled(!0),a.isEnabled=!1)}),this.visibilityApiData.hidden&&!this.isMutationObserver&&this.sandbox.subscribe({eventType:this.visibilityApiData.visibilityChangeEvent,element:document,handler:this.handleVisibilityChange}))},hide:function(){var a=this;b.addClass(this.badgeContainer,"sc-sb--hide"),setTimeout(function(){b.removeClass(a.badgeContainer,"sc-sb--hide")},100)},setChecking:function(a){this.isEnabled&&(a?b.addClass(this.badge,"sc-sb--checking"):b.removeClass(this.badge,"sc-sb--checking"))},setDisabled:function(a){a?b.addClass(this.badgeContainer,"sc-sb-holder--disabled"):b.removeClass(this.badgeContainer,"sc-sb-holder--disabled")},changeBgColor:function(){this.isEnabled&&(this.problemsCount>0?b.addClass(this.badgeContainer,"sc-sb-holder--error"):b.removeClass(this.badgeContainer,"sc-sb-holder--error"))},addItem:function(a,b){this.menuItems[a]=new d.MenuItem(this,a,b)},addItems:function(a){for(var b in a)this.addItem(b,a[b])},removeItem:function(a){var b=!1;return a&&this.menuItems[a]&&(this.menuItems[a].destroy(),delete this.menuItems[a],b=!0),b},getDOMElement:function(){return this.badgeContainer},startChecking:function(){var a=this;this.timeoutId=setTimeout(function(){a.startChecking()},this.timeoutDelay),this.changePosition()},stopChecking:function(){clearTimeout(this.timeoutId),this.timeoutId=null},handleVisibilityChange:function(){document[this.visibilityApiData.hidden]?this.stopChecking():this.startChecking()},getPosition:function(){var a={x:0,y:0,small:!1},b=this.sandbox.getOffsetParent(this.badgeContainer[0]),d=b.getBoundingClientRect(),e=this.container.getBoundingClientRect(),f=e.bottom-e.top,g=e.right-e.left,h=this.container.clientHeight,i=this.container.clientWidth,j=c.isInputBased(this.sandbox.getOption("originalContainer")),k=j?14:18,l=32;return 38>h||38>i?(a.x=e.left-d.left+g-k,a.y=e.top-d.top+f-k,a.small=!0):(a.x=e.left-d.left+g-l,a.y=e.top-d.top+f-l),a},setPosition:function(a,c){b.setPosition(this.badgeContainer,a,c)},setPositionAndSize:function(){var a=this.getPosition(),c="sc-sb-holder--small",d=b.hasClass(this.badgeContainer,c);a.small?!d&&b.addClass(this.badgeContainer,c):d&&b.removeClass(this.badgeContainer,c),this.setPosition(a.x,a.y)},update:function(){this.isEnabled&&(this.problemsCount=this.sandbox.getProblemsCount()||0,this.badge[0].innerHTML=this.problemsCount<=99?this.problemsCount:"99+")},render:function(){var a;return this.sandbox.Template.create("sbTpl",this.elementTemplate),a=this.sandbox.Template.render("sbTpl",{extraClass:this.extraClass||""}),this.sandbox.Template.remove("sbTpl"),b.insertAfter(a,this.insertAfter)},attachEvents:function(){this.sandbox.subscribe(this.sandbox.getOption("isTouchDevice")?{eventType:"orientationchange",element:window,handler:this.changePosition}:{eventType:"resize",element:window,handler:this.changePosition})},detachEvents:function(){this.sandbox.unsubscribe(this.sandbox.getOption("isTouchDevice")?{eventType:"orientationchange",element:window,handler:this.changePosition}:{eventType:"resize",element:window,handler:this.changePosition})},changePosition:function(a){var b=this,c=0;a&&"orientationchange"===a.type&&(c=500),setTimeout(function(){b.setPositionAndSize()},c)},clear:function(){for(var a in this.menuItems)this.removeItem(a)},destroy:function(){this.clear(),this.detachEvents(),this.stopChecking(),b.remove(this.badgeContainer)}},d.MenuItem=function(a,b,c){function d(){g.menuItem=j=e(),g.appendTo(g.parentElement.badgeList[0]),g.Disabled(g.disabledState)}function e(){var a="";return g.sandbox.Template.create("cmButtonItemTpl",g.menuItemTemplate),a=g.sandbox.Template.render("cmButtonItemTpl",{itemName:g.itemName,innerText:g.itemTitle,shortcutText:g.shortcutText,extraItemClass:g.extraClass}),i.create(a)[0]}function f(a){a.preventDefault(),g.disabledState||"function"!=typeof g.onClick||g.onClick(a),g.parentElement.hide()}var g=this,h=a.sandbox,i=h.UILib,j=null;this.parentElement=a,this.sandbox=this.parentElement.sandbox,this.menuItemTemplate=this.parentElement.elementItemTemplate,this.disabledState=c.disabled,this.itemName=b,this.itemTitle=c.itemTitle,this.extraClass=c.extraClass,this.order="number"==typeof c.order?c.order:0,this.onClick=c.onClick,this.appendTo=function(a){i.appendTo(j,a),this.attachEvents()},this.destroy=function(){this.detachEvents(),i.remove(j)},this.attachEvents=function(){this.detachEvents(),g.sandbox.subscribe({eventType:"mousedown",element:j,handler:f})},this.detachEvents=function(){g.sandbox.unsubscribe({eventType:"mousedown",element:j,handler:f})},this.Disabled=function(a){g.disabledState=a,i[a?"addClass":"removeClass"](j,"sc-cm__item_disabled")},d()},a.Badge=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){var c=b.Utils,d=c.extend(null,{init:function(){}});a.Widget=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";function c(a,b){var c,d;for(var e in b)if(c=b[e],c.includes(a)){d=e;break}return d}var d=(b.UILib,b.Utils),e=a.Widget,f=d.extend(e,{init:function(a){this.parent.init(a),a.actionList=a.getActionList()},buildMenuItems:function(a){var b,c=a.currentActionTypes,d=a.additionalItems,e=a.problemNode,f=a.problemDescription,g=this.sandbox.getOption("actionItems"),h=a.controlInfo||{};return b=this.getMenuItems(c,h,g,e),b=this.addDescription(b,f),d&&(b=this.addMenuItems(b,d)),b=this.OrderMenuItems(b,g),this.actionList.addItems(b),b},addDescription:function(a,b){return a.problemdescription&&b&&(a.problemdescription.itemTitle=b),a},getMenuItems:function(a,b,d,e){var f,g,h,i="",j={},k=this.sandbox.fire("getUserActions",{types:a}).actionTypes,l="btn_",m={control:["ignore","ignoreAll","addWord"],probleminfo:["problemdescription"],clipboard:["undo","redo","copy","paste","cut"],options:["settings","toggle","help"]},n={"clipboard-action":["undo","redo","copy","paste","cut"]},o=this.sandbox.getOption("appStarted"),p=b.isSelectionCollapsed;for(var q in k){f=k[q];for(var r in f)d.includes(r.toLowerCase())&&(i="toggle"===r?o?"disable":"enable":r,h=this.sandbox.getLocal(l+i),g=f[r],j[r]={onClick:function(a){return function(){a({problemNode:e})}}(g.handler),disabled:g.isDisabled&&g.isDisabled(p),group:c(r,m),extraClass:c(r,n),itemTitle:h})}return j},addMenuItems:function(a,b){for(var c in b)a[c]||(a[c]=b[c]);return a},OrderMenuItems:function(a,b){if(b&&b.length)for(var c=0;c<b.length;c++)a[b[c]]&&(a[b[c]].order=c);return a}});a.ActionListWidget=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,b.Utils),d=a.Widget,e=a.Dialog,f=c.extend(d,{UIDialog:e,storedDialog:null,getDialogName:function(){return this.dialogName},getDialog:function(){var a=this.getDialogName(),b=this.UIDialog._.dialogDefinitions[a];return"function"==typeof b&&(this.storedDialog=this.storedDialog||new this.UIDialog(this.sandbox,a)),this.storedDialog},showDialog:function(){var a=(this.sandbox.getOption("settingsSections")[0],this.getDialog());a.show()},init:function(a){this.parent.init(a),a.UIDialog.add(a.getDialogName(),a.getDialogDefinition.bind(a)),a.sandbox.subscribe("openDialog",function(b){b.dialogName===a.getDialogName()&&a.showDialog()})}});a.DialogWidget=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=a.ActionListWidget,d=WEBSPELLCHECKER.CORE,e=b.Utils,f=function(a,b){this.name=a,this.sandbox=b};f.prototype={init:function(){this.parent.init(this),this.contextMenu=this.actionList,this.addMenuGroups();var a=this.sandbox;a.subscribe("beforeContextMenuShow",function(b){var c,d,e=a.getSelection(),f=e.rangeCount()?e.getRangeAt(0).collapsed():!0;c=b.problemNode?b.problemNode:a.getSpellingNodeFromSelection(),c||(c=a.getGrammarNodeFromSelection()),a.fire("checkUndoRedoPosibility"),d=this.buildContextMenuItems({problemNode:c,isSelectionCollapsed:f})}),a.subscribe("suggestionListSend",function(a){for(var b={},c=[],d="word_",e=0;e<a.suggestionList.length;e++)b[d+a.suggestionList[e]]||(b[d+a.suggestionList[e]]=a.suggestionList[e],c.push(a.suggestionList[e]));this.suggestions=c}),a.subscribe("contextMenuHide",function(){a.fire("hideBanner",{})})},getActionList:function(){return this.sandbox.getContextMenu()},buildContextMenuItems:function(a){{var b,c,e,f,g,h={},i=this.sandbox,j={},k=i.UILib,l=a.problemNode,m=["common"],n=i.getOption("data_attribute_name"),o=i.getOption("problem_grammar_data_attribute"),p=i.getOption("problem_grammar_data_attribute_rule"),q=i.getOption("lang"),r=i.getOption("enableBadgeButton"),s=this.sandbox.getOption("actionItems"),t=this.sandbox.getOption("appStarted"),u=Object.assign({},i.getOption("additionalActionItems"));i.getOption("mirrorBasedInstance")}b=i.Utils.isEqualNode(l,n),c=i.Utils.isEqualNode(l,o),t&&(b?m.unshift("spelling"):c&&m.unshift("grammar")),r||m.push("options"),l&&(i.fire("showBanner",{contextMenuContainerSelector:this.contextMenu.getDOMElement()}),b?i.fire("getSuggestionsList",{lang:i.getOption("lang"),word:k.attr(l,n)}):c&&(e=k.attr(l,o),f=k.attr(l,p),g=d.GrammarDictionaryManager.Dictionary.getProblemDescription(e,f,q),i.fire("getGrammarSuggestionsList",{lang:q,phrase:e,rule:f})),j=this.buildSuggestionMenuItems(l,b));for(var v in u)s.includes(v)||delete u[v];return u=this.addMenuItems(u,j),h=this.buildMenuItems({problemNode:l,currentActionTypes:m,additionalItems:u,controlInfo:a,problemDescription:g})},buildSuggestionMenuItems:function(a,b){function c(b){var c,d={};d[j]=b,d[k]=a,c=e.UILib.findNodeParents(a,m,l)[0],e.fire("restoreSelection"),e.fire(i,d),n&&e.fire("removeGrammarMarkupInSelectionNode",{selectionNode:c})}var d={},e=this.sandbox,f=this.suggestions,g=(e.UILib,e.getOption("suggestionsCount")),h=e.getOption("moreSuggestionsCount"),i=(e.getOption("container"),b?"replaceWord":"replacePhrase"),j=b?"word":"phrase",k=b?"spellingNode":"grammarNode",l=e.getOption("problem_grammar_data_attribute"),m=e.getOption("problem_grammar_node"),n=b?!0:!1;return f&&f.length>0?f.forEach(function(a,b){if(g>b)d["sugg_"+a.replace(/\s/g,"_")]={itemTitle:a,order:b,group:"suggest",extraClass:"examples-variante",onClick:function(a){return function(){c(a)}}(a)};else if(g+h>b){var f=this.contextMenu.getItem("moreSuggestions");f||this.contextMenu.addItem("moreSuggestions",{itemTitle:e.getLocal("btn_moreSuggestions",e),order:1,group:"moresuggest",onClick:function(){return!0}}),f=this.contextMenu.getItem("moreSuggestions"),f&&f.addItem("sugg_"+a.replace(/\s/g,"_"),{itemTitle:a,onClick:function(a){return function(){c(a)}}(a)})}},this):d.nosuggestions={itemTitle:e.getLocal("btn_noSuggestions",e),order:0,group:"suggest",disabled:!0},d},addMenuGroups:function(){var a=this.sandbox.getOption("actionItemsSections"),b=this.contextMenu;if(a&&a.length)for(var c=0;c<a.length;c++)b.addGroup(a[c],c)}},a.ContextMenuWidget=e.extend(c,f)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c,d=a.ActionListWidget,e=b.Utils,f=function(a,b){this.name=a,this.sandbox=b,c=this.sandbox.UILib};f.prototype={init:function(){this.parent.init(this),this.sandbox.subscribe("allModulesReady",function(){this.buildBadgeItems()})},getActionList:function(){return this.sandbox.getBadge()},buildBadgeItems:function(){var a=this.sandbox,b=this.sandbox.getOption("actionItemsSections"),c=["options"],d=a.getOption("enableBadgeButton")&&a.getOption("isMutationObserver"),e={};if(d&&b.includes("options"))return e=this.buildMenuItems({currentActionTypes:c})}},a.BadgeWidget=e.extend(d,f)}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c,d=b.Utils,e=a.DialogWidget,f=function(a,b){this.name=a,this.sandbox=b,c=b.UILib,this.storedDialog=null,this.dialogName="baseDialog",this.settingsSections=b.getOption("settingsSections")};f.prototype={constructor:f,init:function(){var a=this.sandbox;this.parent.init(this),a.subscribe("userDictionaryAction",function(b){var c,d=b.dialog,e=d.getUIElement("dictionaries","dictionaryNote"),f=d.getUIElement("dictionaries","dictionaryName"),g=a.getOption("userDictionaryName")||"";b.error?(""===b.name?e.setHtml(a.getLocal("message_info_emptyDic")):(c=a.getLocal("message_error_"+b.command+"Dic"),c=c.replace("%s",b.name),e.setHtml(c)),e.css({color:"#ef0000","margin-bottom":"-5px"}),f.setValue(g?g:"")):(c=a.getLocal("message_success_"+b.command+"Dic"),c=c.replace("%s",b.name),e.setHtml(c),e.css({color:"#1E8914","margin-bottom":"-5px"}))})},getDialogDefinition:function(a){var b,d=a.getOption("settingsSections");return b={title:a.getLocal("text_title"),minWidth:500,onLoad:function(){d.includes("languages")&&b.renderLangList(this)},onClose:function(c){var d=b.getOptionsToCommit(c);a.fire("commitOptions",{changedOptions:d})},onShow:function(a){var b=a.sender;b.setActiveTab(d[0])},renderLangList:function(b){var d,e,f,g=b.getUIElement("languages","leftLangCol"),h=b.getUIElement("languages","rightLangCol"),i=a.getOption("spellingLangList"),j={},k=[],l=0;j=c.extend({},i.ltr,i.rtl);for(e in j)k.push([e,j[e]]);k.sort(function(a,b){var c=0;return a[1]>b[1]?c=1:a[1]<b[1]&&(c=-1),c}),j={};for(var m=0;m<k.length;m++)j[k[m][0]]=k[m][1];d=Math.round(k.length/2);for(e in j)l++,f=d>=l?g:h,f.addChild({id:"wscLang_"+e,type:"radio",storable:!0,name:"wsc_lang",label:j[e],value:e})},getOptionsToCommit:function(a){var b,e=a.sender,f={},g=d.includes("options")?e.getUIElement("options","wscOptions"):null,h=d.includes("languages")?e.getUIElement("languages","leftLangCol"):null,i=d.includes("languages")?e.getUIElement("languages","rightLangCol"):null,j={};if(g){g=g.getChildren();for(b in g)g[b].isChanged()&&(f[b]=g[b].isChecked())}if(h||i){j=c.extend(j,h&&h.getChildren()||{},i&&i.getChildren()||{});for(b in j)if(j[b].isChecked()&&j[b].isChanged()){f.lang=j[b].getValue();break}}return f},toggleDictionaryButtons:function(a){var b=this.getUIElement("dictionaries","createDic"),c=this.getUIElement("dictionaries","removeDic"),d=this.getUIElement("dictionaries","renameDic"),e=this.getUIElement("dictionaries","restoreDic");a?(b.disable(),e.disable(),c.enable(),d.enable()):(b.enable(),e.enable(),c.disable(),d.disable())},toggleDictionaryState:function(a){var b=this.getUIElement("dictionaries","dictionarySettingsState"),c=this.getUIElement("dictionaries","wordState"),d=this.getUIElement("dictionaries","dictionaryActions"),e=this.getUIElement("dictionaries","udButtonsHolder"),f=this.getUIElement("dictionaries","createDic"),g=this.getUIElement("dictionaries","restoreDic"),h=this.getUIElement("dictionaries","disconnectDic"),i=this.getUIElement("dictionaries","removeDic"),j=this.getUIElement("dictionaries","renameDic"),k=this.getUIElement("dictionaries","dicInfo"),l=this.getUIElement("dictionaries","workWithWords");switch(a){case"initialState":b.hideElement(),c.showElement(),d.showElement(),e.showElement(),f.enable(),g.showElement(),h.hideElement(),i.disable(),j.disable(),k.showElement(),l.hideElement();break;case"wordsState":b.showElement(),c.hideElement(),d.hideElement(),e.hideElement(),k.hideElement(),l.showElement();break;case"dictionaryState":b.hideElement(),c.showElement(),d.showElement(),e.showElement(),f.disable(),g.hideElement(),h.showElement(),i.enable(),j.enable(),k.showElement(),l.hideElement()}},clearWordList:function(){var a=this.getUIElement("dictionaries","wordList");a.removeAllChild()},getUserDictionary:function(c){var d=this;a.fire("getUserDictionary",{name:c,callback:function(a){a.error||b.renderWordList(a.wordlist,d)}})},renderWordList:function(a,b){for(var c=b.getUIElement("dictionaries","wordList"),d=0;d<a.length;d++)c.addChild(a[d])}},b.tabs=this.getDialogTabs(b,a),b.tabs=this.generateDialogTabs(b.tabs,d),b},generateDialogTabs:function(a,b){for(var c=[],d=[],e=null,f=0;f<b.length;f++)e=a.filter(function(a){return a.id===b[f]})[0],e&&c.push(e);for(d=a.filter(function(a){return a.required}),f=0;f<d.length;f++){var g=!c.filter(function(a){return a.id===d[f].id})[0];g&&c.push(d[f])}return c},getDialogTabs:function(a,b){return[{id:"options",title:b.getLocal("tab_options"),extraClass:"options",elements:[{id:"wscOptions",type:"vbox",children:[{id:"ignoreAllCapsWords",type:"checkbox",storable:!0,label:b.getLocal("label_allCaps")},{id:"ignoreDomainNames",type:"checkbox",storable:!0,label:b.getLocal("label_ignoreDomainNames")},{id:"ignoreWordsWithMixedCases",type:"checkbox",storable:!0,label:b.getLocal("label_mixedCase")},{id:"ignoreWordsWithNumbers",type:"checkbox",storable:!0,label:b.getLocal("label_mixedWithDigits")}],onShow:function(){var a=this.getChildren(),c=!1;for(var d in a)c=b.getOption(d),a[d][c?"check":"uncheck"](),a[d].commit()}}]},{id:"languages",extraClass:"sc-tabset__tab-languages",title:b.getLocal("tab_languages"),elements:[{id:"langHolder",type:"hbox",widths:["45%","45%"],extraClass:"clrfix",style:"width: 100%; margin-bottom: 10px;",children:[{id:"leftLangCol",type:"vbox"},{id:"rightLangCol",type:"vbox",style:"padding: 0 0 0 10px;"}],onShow:function(){var a="wscLang_",c=b.getOption("lang"),d=this.getParentDialog().getUIElement("languages",a+c);d&&(d.check(),d.commit())}},{id:"linkExternal",type:"html",style:"position: absolute; bottom: 15px; left: 15px;",html:'<a href="'+b.getOption("moreLangUrl")+'" target="_blank" class="sc-link-external">'+b.getLocal("btn_moreLanguages")+"</a>"}]},{id:"dictionaries",extraClass:"sc-tabset__tab-dictionaries",title:b.getLocal("tab_dictionaries"),onClick:function(){var b=this.getParentDialog(),c=b.getUIElement("dictionaries","dictionaryNote");c.setHtml(""),a.clearWordList.call(b),a.getUserDictionary.call(b),a.toggleDictionaryState.call(b,"wordsState")},elements:[{id:"dictionaryNote",type:"html",html:""},{id:"dictionaryActions",type:"hbox",widths:["48%","48%"],style:"width: 100%;",extraClass:"clrfix",children:[{id:"dictionaryName",type:"text",maxLength:"64",placeholder:b.getLocal("placeholder_fieldNameDic"),storable:!0,onShow:function(){var c=this.getParentDialog(),d=b.getOption("userDictionaryName")||"";c.getUIElement("dictionaries","dictionaryNote").setHtml(""),this.setValue(d),a.toggleDictionaryState.call(c,d?"dictionaryState":"initialState")}},{id:"additionalButtons",type:"hbox",style:"width: 100%;",extraClass:"sc-additional-buttons-holder",children:[{id:"removeDic",type:"button",extraClass:"sc-button__icon sc-button__icon_delete",text:"&#65279;",title:b.getLocal("btn_deleteDic"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryName"),e=b.getOption("userDictionaryName");b.fire("removeUserDictionary",{name:e,onSuccess:function(f){d.setValue(""),f.error||a.toggleDictionaryState.call(c,"initialState"),f.dialog=c,f.command="remove",f.name=e,b.fire("userDictionaryAction",f)},onError:function(a){a.error=!0,a.dialog=c,a.command="remove",a.name=e,b.fire("userDictionaryAction",a)}})}},{id:"renameDic",type:"button",extraClass:"sc-button__icon sc-button__icon_rename",text:"&#65279;",title:b.getLocal("btn_renameDic"),onClick:function(){var a=this.getParentDialog(),c=a.getUIElement("dictionaries","dictionaryName").getValue();b.fire("renameUserDictionary",{newName:c,onSuccess:function(d){d.dialog=a,d.command="rename",d.name=c,b.fire("userDictionaryAction",d)},onError:function(d){d.error=!0,d.dialog=a,d.command="rename",d.name=c,b.fire("userDictionaryAction",d)}})}}]}]},{id:"udButtonsHolder",type:"hbox",extraClass:"clrfix",style:"margin-top: -15px;",children:[{id:"createDic",type:"button",extraClass:"sc-button_grey",text:b.getLocal("btn_createDic"),title:b.getLocal("btn_createDic"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryName").getValue();b.fire("createUserDictionary",{name:d,onSuccess:function(e){e.error||a.toggleDictionaryState.call(c,"dictionaryState"),e.dialog=c,e.command="create",e.name=d,b.fire("userDictionaryAction",e)},onError:function(a){a.error=!0,a.dialog=c,a.command="create",a.name=d,b.fire("userDictionaryAction",a)}})}},{id:"restoreDic",type:"button",extraClass:"sc-button_grey",text:b.getLocal("btn_connectDic"),title:b.getLocal("btn_connectDic"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryName").getValue();b.fire("restoreUserDictionary",{name:d,onSuccess:function(e){!e.error&&e.name?a.toggleDictionaryState.call(c,"dictionaryState"):e.error=!0,e.dialog=c,e.command="restore",e.name=d,b.fire("userDictionaryAction",e)},onError:function(a){a.error=!0,a.dialog=c,a.command="restore",a.name=d,b.fire("userDictionaryAction",a)}})}},{id:"disconnectDic",type:"button",extraClass:"sc-button_grey",text:b.getLocal("btn_disconnectDic"),title:b.getLocal("btn_disconnectDic"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryName"),e=b.getOption("userDictionaryName");b.fire("disconnectFromUserDictionary",{}),d.setValue(""),a.toggleDictionaryState.call(c,"initialState"),b.fire("userDictionaryAction",{dialog:c,command:"disconnect",name:e})}}]},{id:"dicInfo",type:"html",style:"margin: 20px auto 5px; white-space:normal; line-height:1.7; font-size:11px;",html:'<a href="'+b.getOption("ECUserManual")+'" target="_blank" class="sc-link-external sc-focusable">'+b.getLocal("btn_learnDictionary")+"</a>"},{id:"workWithWords",type:"vbox",extraClass:"sc-ud-words clrfix",style:"width: 100%; height: 250px; margin-bottom: 0",children:[{id:"wordActions",type:"hbox",widths:["48%","48%"],style:"width: 100%;",extraClass:"clrfix",children:[{id:"addWordField",type:"text",maxLength:"64",placeholder:b.getLocal("placeholder_fieldAddWord"),onShow:function(){this.setValue("")
},onKeydown:function(a){var b=a.event.keyCode||a.event.which,c=this.getParentDialog(),d=c.getUIElement("dictionaries","addWord");13===b&&this.getValue()&&!d.isDisabled()&&d.onClick()}},{id:"addWordButton",type:"hbox",children:[{id:"addWord",type:"button",extraClass:"sc-button_green",text:b.getLocal("btn_add"),title:b.getLocal("btn_add"),onClick:function(){var a=this.getParentDialog(),c=a.getUIElement("dictionaries","wordList"),e=a.getUIElement("dictionaries","addWordField"),f=e.getValue(),g=b.RegularsManager.wordBoundaryRegex.g(),h=this;if(f){if(-1!==g.search(f))return void b.fire("userDictionaryAction",{dialog:a,command:"wordWithBannedSymbols",name:f,error:!0});if(c.inChildren(f))return e.setValue(""),void b.fire("userDictionaryAction",{dialog:a,command:"wordAlreadyAdded",name:f});this.disable(),b.fire("addWordToUserDictionary",{word:f,onSuccess:function(g){g.error||(e.setValue(""),c.addChild(f,!0)),g.dialog=a,g.command="addWord",g.name=d.trunc(f,16),h.enable(),b.fire("userDictionaryAction",g)},onError:function(c){c.error=!0,c.dialog=a,c.command="addWord",c.name=d.trunc(f,16),h.enable(),b.fire("userDictionaryAction",c)}})}}}]}]},{id:"wordList",type:"itemList",title:b.getLocal("btn_deleteWord"),onClick:function(a){var e=a.event,f="data-ud-word",g=c.parent(e.target)[0],h=c.attr(g,f),i=this.getParentDialog(),j=i.getUIElement("dictionaries","wordList"),k=this;c.hasClass(e.target,"sc-item-list__icon_close")&&!this.isBlocked()&&(this.block(),b.fire("deleteWordFromUserDictionary",{word:h,onSuccess:function(a){a.error||j.removeChild(g,h),k.unblock(),a.dialog=i,a.command="deleteWord",a.name=d.trunc(h,16),b.fire("userDictionaryAction",a)},onError:function(a){a.error=!0,k.unblock(),a.dialog=i,a.command="deleteWord",a.name=d.trunc(h,16),b.fire("userDictionaryAction",a)}}))},children:[]}]},{id:"wordState",type:"hbox",extraClass:"clrfix",style:"position: absolute; margin-bottom: 0; right: 15px; bottom: 15px",children:[{id:"goToDic",type:"button",extraClass:"sc-button_grey sc-button_full",text:b.getLocal("btn_goToDic"),title:b.getLocal("btn_goToDic"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryNote");d.setHtml(""),a.clearWordList.call(this.getParentDialog()),a.getUserDictionary.call(this.getParentDialog()),a.toggleDictionaryState.call(c,"wordsState"),b.fire("afterTabShow",{})}}]},{id:"dictionarySettingsState",type:"hbox",extraClass:"clrfix",style:"position: absolute; margin-bottom: 0; right: 15px; bottom: 15px;",children:[{id:"dictionaryPreferences",type:"button",extraClass:"sc-button_grey sc-button_full",text:b.getLocal("btn_dictionaryPreferences"),title:b.getLocal("btn_dictionaryPreferences"),onClick:function(){var c=this.getParentDialog(),d=c.getUIElement("dictionaries","dictionaryNote");d.setHtml(""),b.getOption("userDictionaryName")?a.toggleDictionaryState.call(c,"dictionaryState"):a.toggleDictionaryState.call(c,"initialState"),b.fire("afterTabShow",{})}}]}]},{id:"about",title:b.getLocal("tab_about"),required:WEBSPELLCHECKER.CORE.includeRequiredUI,extraClass:"about",elements:[{type:"html",id:"aboutBlock",style:"margin: 5px;",html:'<div class="sc-version-control-holder"><div class="sc-image-block"><img src="'+b.getOption("basePath")+b.getOption("wscLogo")+'" alt="logo"></div><div class="sc-text-block"><h5>WebSpellChecker Proofreader</h5><p>'+b.getLocal("version")+b.getOption("wscVersion")+'</p></div></div><div class="sc-copyrights">'+b.getLocal("text_copyrights")+"</div>"}]}]}},f=d.extend(e,f),a.BaseDialogWidget=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=a.DialogWidget,e=function(a,b){this.name=a,this.sandbox=b,this.dialogName="pasteDialog",this.storedDialog=null};e.prototype={constructor:e,init:function(){var a=this.sandbox;this.parent.init(this),this.sandbox.subscribe("dialogDefinition",function(b){var c,d=b.dialog,e=b.name;e===this.getDialogName()&&(c=d.find(".sc-cm-paste-holder")[0],a.clipboardManager.add(a,c,a.isOriginalContainerTextBased(),!0))})},getDialogDefinition:function(a){var b;return{title:a.getLocal("btn_paste"),extraClass:"paste",minWidth:500,tabs:[{id:"paste",elements:[{id:"pasteContents",type:"vbox",children:[{id:"messageInfoPaste",type:"html",html:'<p class="sc-cm-paste-message">'+a.getLocal("message_info_paste")+"</p>"},{id:"pasteContainer",type:"html",html:'<div class="sc-cm-paste-holder" contenteditable="true" spellcheck="false"></div>'}]},{id:"pasteAction",type:"hbox",extraClass:"clrfix",style:"position: absolute; margin-bottom: 0; right: 15px; bottom: 15px",children:[{id:"pasteText",type:"button",extraClass:"sc-button_green",text:a.getLocal("btn_paste"),title:a.getLocal("btn_paste"),onClick:function(){var c=this.getParentDialog(),d=b.innerHTML;c.hide(),c.fire("restoreSelection"),setTimeout(function(){a.fire("pasteProcessed",{contentType:"auto",text:d,pasteInto:a.getOption("container")})},0)}}]}]}],onLoad:function(a){a.sender.dialogName===this.dialogName&&(b=this.find(".sc-cm-paste-holder")[0])},onShow:function(c){c.sender.dialogName===this.dialogName&&(b.innerHTML="",a.fire({eventType:"focus",element:b}))}}}},e=c.extend(d,e),a.PasteDialogWidget=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b={htmlToText:function(a,b){var c="address|article|aside|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h[1-6]|header|hgroup|hr|li|main|nav|noscript|ol|output|p|pre|section|table|tfoot|ul|video";return a=a.replace(new RegExp("<("+c+")(>|.*?[^?]>)","gi"),'<br class="wsc-marker">$&').replace(new RegExp("</("+c+")(>|.*?[^?]>)","gi"),'$&<br class="wsc-marker">').replace(/<br class="wsc-marker">\s*<br class="wsc-marker">/gi,'<br class="wsc-marker">').replace(/^(<br class="wsc-marker">)+/gi,"").replace(/(<br class="wsc-marker">)+$/gi,"").replace(/<br class="wsc-marker">/gi,"\r\n").replace(/<br>/gi,"\r\n").replace(/&nbsp;/g," ").replace(/\ufeff/g,"").replace(/\u0002/g,""),a=a.replace(/<br[^>]*class[^>]*=[^>]*"[^>]*wsc-bogus[^>]*"[^>]*>/g,""),a=this.encodingTools.htmlDecode(a),b&&(a=a.replace(/\r\n/g," ")),a},textToHtml:function(a,b){return a=a.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\r\n/g,"<br>").replace(/\n/gi,"<br>").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;"),b&&(a=a.replace(/ /g,"&nbsp;"),a=a.replace(/<br>/gi,"&nbsp;")),a},htmlToPlainText:function(a){return this.encodingTools.htmlDecode(a)},tagsToLowerCase:function(a){return a=a.replace(/<\/?[A-Z]+>/g,function(a){return a.toLowerCase()})},getHtmlWithoutSpellingNodes:function(a,b,c){var a=this.getHtmlWithoutGivenNodes(a,b,c);return a=this.getHtmlWithoutGivenNodes(a,"span","scayt-misspell-word")},getHtmlWithoutGrammarNodes:function(a,b,c){var a=this.getHtmlWithoutGivenNodes(a,b,c);return a=this.getHtmlWithoutGivenNodes(a,"span","gramm-problem")},getHtmlWithoutRangyMarkerNodes:function(a){var a=this.getHtmlWithoutGivenNodes(a,"span","rangySelectionBoundary");return a=a.replace(/\ufeff/g,"")},getHtmlWithoutGivenNodes:function(b,c,d){for(var e=0,f=0,g=b,h=!1,i=a.Utils,c=i.Browser.ie&&8===i.Browser.version?c.toUpperCase():c;-1!==g.indexOf(d);)if(e=g.indexOf("<"+c,e),f=g.indexOf(">",e),h=e===g.lastIndexOf("<"+c)?!0:!1,g.indexOf(d,e)>f){if(h)break;e=f}else{if(g=g.substring(0,e)+g.substring(f+1,g.indexOf("</"+c+">",f))+g.substring(g.indexOf("</"+c+">",f)+c.length+3,g.length),h)break;e=0,f=0}return g},recogniseContentType:function(a){var b=new RegExp("<[s]*[a-z0-9]+[s]*>|<[s]*/[s]*[a-z0-9]+[s]*>|<[s]*[a-z0-9]+[s]*/[s]*>","gi");return a.match(b)?"html":"text"},encodingTools:function(){var a={symbolsToSave:[{searchFor:/\n/g,replaceWith:"__%N%__"},{searchFor:/\r/g,replaceWith:"__%R%__"}],symbolsToRestore:[{searchFor:/__%N%__/g,replaceWith:"\n"},{searchFor:/__%R%__/g,replaceWith:"\r"}],save:function(a){a=a||"";for(var b=0;b<this.symbolsToSave.length;b++)a=a.replace(this.symbolsToSave[b].searchFor,this.symbolsToSave[b].replaceWith);return a},restore:function(a){a=a||"";for(var b=0;b<this.symbolsToRestore.length;b++)a=a.replace(this.symbolsToRestore[b].searchFor,this.symbolsToRestore[b].replaceWith);return a}};return{htmlEncode:function(b){var c,d,e;return c=a.save(b),d=document.createElement("span"),e=document.createTextNode(c),d.appendChild(e),c=a.restore(d.innerHTML)},htmlDecode:function(b){var c,d=document.createElement("span");return c=a.save(b),d.innerHTML=c,c=a.restore(d.textContent||d.innerText)}}}()};a.DataProcessor=b}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";function b(b,d,h,j){function o(a){var f,g=a,i="",j=h?"text":k,l=null,o=b.Utils,s=o.getCurrentDocument(b.getOption("documentContainer")),w=b.getOption("isTextBasedContainer"),x=[];if(l=o.Browser.edge?o.getWindowByDocument(s).clipboardData:g&&g.clipboardData,u||v)return a.preventDefault(),a.stopPropagation(),!1;if(p(),r&&(q=b.saveSelection()),f=d.innerHTML,!l||!l.getData)return j=h?"text":"html",n.getPastedData(j,function(a){b.fire({eventType:"focus",element:d}),b.restoreSelection(q),(!o.Browser.ie||a)&&setTimeout(function(){b.fire("pasteProcessed",{event:g,text:a,contentType:j,pasteInto:d,transferType:m.INTERNAL})},0)}),!0;if(e(l.types))for(var y=0;y<l.types.length;y++)x[y]=l.types[y];t=!0,h&&/text\/plain/.test(x)?(j="text",i=l.getData("text/plain")):/text\/html/.test(x)?(j="html",i=l.getData("text/html")):/text\/plain/.test(x)?(j="text",i=l.getData("text/plain")):i="",w&&(i=i.replace(/&/gi,"&amp;")),d.innerHTML=i,c(d,f,function(a){b.restoreSelection(q),(!o.Browser.ie||a)&&setTimeout(function(){b.fire("pasteProcessed",{event:g,text:a,contentType:j,pasteInto:d,transferType:m.INTERNAL})},0)})}function p(){u=!0,setTimeout(function(){u=!1},100)}{var q,r=b.getFocused(),s=b.getOption("isIframe"),t=!1,u=!1,v=!1;a.Utils}b.subscribe({eventType:"focus",element:d,handler:function(){r=!0}}),b.subscribe({eventType:"blur",element:d,handler:function(){r=!1}}),b.subscribe({eventType:"cut",element:d,handler:function(a){b.fire({eventType:"cutProcessed",data:a})}}),b.subscribe({eventType:"copy",element:d,handler:function(a){b.fire({eventType:"copyProcessed",data:a})}}),b.subscribe({eventType:l,element:d,handler:o}),b.subscribe({eventType:"paste",element:d,handler:function(a){return t?(a.preventDefault(),a.stopPropagation(),!1):void 0}}),b.subscribe("pasteProcessed",function(a){{var b=a.pasteInto;f(a)}b==d&&(a.contentTrueType="html"==a.contentType?"html":i.recogniseContentType(a.text),"html"==a.contentTrueType&&(a.text=i.tagsToLowerCase(a.text)),"text"==a.contentType&&"html"==a.contentTrueType&&(a.text=i.encodingTools.htmlEncode(a.text)),"auto"==a.contentType&&(a.contentType="html"==a.contentTrueType?"html":"text"))},b,2e3),b.subscribe("pasteProcessed",function(a){var c=a.pasteInto;c==d&&(v=!0,setTimeout(function(){var c,d,e,f,h=document.createElement("span");c=j&&s?b.getSelection(!0):b.getSelection(),d=c.getRangeAt(0),h.innerHTML=a.text,d.deleteContents(),d.insertNode(h),e=b.createRange(),f=b.createRange(),e.selectNode(h),f.selectNodeContents(h),e.commonAncestorContainer().insertBefore(f.extractContents(),h),d.setStartBefore(h),d.collapse(!0),c.removeAllRanges(),c.addRange(d),v=!1,g.remove(h),b.fire("afterPaste")},0))},b,-2e3)}function c(a,b,c){var d=a.innerHTML;a.innerHTML=b,"function"==typeof c&&c(d)}function d(a){var b=a.container,c=a.sandbox;c.unsubscribe({eventType:"focus",element:b}),c.unsubscribe({eventType:"blur, cut, copy, paste, beforepaste",element:b}),c.unsubscribe("pasteProcessed",c)}function e(a){return a&&!a.propertyIsEnumerable("length")&&"object"==typeof a&&"number"==typeof a.length}function f(a){return a.transferType=a.transferType||m.EXTERNAL,a.transferType}if(!a.clipboardManager){var g=a.UILib,h=a.Utils,i=a.DataProcessor,j=[],k="html",l=h.Browser.ie?"beforepaste":"paste",m={INTERNAL:1,EXTERNAL:2},n={init:function(a){if(this.sandbox=a,!this.initialized){this.initialized=!0;for(var b in this.contentTypes)this.contentTypes[b].element=g.create(this.contentTypes[b].template)[0],g.appendTo(this.contentTypes[b].element,"body")}},getScrollTop:function(){return g.scrollTop(window)+10+"px"},getScrollLeft:function(){return g.scrollLeft(window)+"px"},contentTypes:{text:{template:'<textarea id="sc-hidden-paste-text-holder" style="position:absolute;left:-99999px;"></textarea>',element:null,cleanup:function(){this.element.value="",this.element.style.top=n.getScrollTop(),n.sandbox.fire({eventType:"focus",element:this.element})},getData:function(){return this.element.value},setData:function(a){this.element.value=a}},html:{template:'<div contenteditable="true" id="sc-hidden-paste-html-holder" style="position:absolute;left:-99999px;"></div>',element:null,cleanup:function(){this.element.innerHTML="",this.element.style.top=n.getScrollTop(),n.sandbox.fire({eventType:"focus",element:this.element})},getData:function(){return this.element.innerHTML},setData:function(a){this.element.innerHTML=a}}},getPastedData:function(a,b){var c=this,d=h.Browser.ie&&11===h.Browser.version;b||(b=a,a="html"),this.contentTypes[a].element&&"function"==typeof b&&(this.contentTypes[a].cleanup(),setTimeout(function(){var e=c.contentTypes[a].getData();d&&"html"===a&&"<br>"===e&&(e=""),b(e)},0))}},o={add:function(a,c,d,e){j.push({sandbox:a,container:c}),n.init(a),b(a,c,d,e)},remove:function(a){for(var b,c=0;c<j.length;c++)j[c].sandbox.getOption("uid")===a&&(b=j[c],d(b),j.splice(c,1))}};a.clipboardManager=o}}(WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";if(!a.UIMetrics){var c=b.UILib,d=window,e=(document.documentElement,document.body,{});e.getScrollLeft=function(){return c.scrollLeft(d)},e.getScrollTop=function(){return c.scrollTop(d)},e.getWindowWidth=function(){return c.width(d)},e.getWindowHeight=function(){return c.height(d)},e.getWindowInnerWidth=function(){return"number"==typeof window.innerWidth?window.innerWidth:document.documentElement.clientWidth},e.getWindowInnerHeight=function(){return"number"==typeof window.innerHeight?window.innerHeight:document.documentElement.clientHeight},e.getBodyMinWidth=function(){var a=0;return a=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(document.body,null).minWidth:document.body.currentStyle?document.body.currentStyle.minWidth:document.body.style.minWidth,parseInt(a,10)||0},e.getPageWidth=function(){return Math.max(Math.max(document.documentElement.offsetWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.body.scrollWidth))},e.getPageHeight=function(){return Math.max(Math.max(document.documentElement.offsetHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.body.scrollHeight))},e.getDocumentWidth=function(){return Math.max(e.getPageWidth(),e.getBodyMinWidth(),e.getWindowWidth())},e.getDocumentHeight=function(){return Math.max(e.getPageHeight(),e.getWindowHeight())},a.UIMetrics=e}}(WEBSPELLCHECKER.CORE,WEBSPELLCHECKER.CORE.prototype),function(a){function b(a){return c.is(a,":visible")}var c,d,e,f=function(a,b){var f=this;this.name=a,this.sandbox=b,d=this.Utils=b.Utils,c=this.UILib=b.UILib,e=this.DataProcessor=b.DataProcessor,this.originalElement=this.sandbox.getOption("originalContainer"),this.styles=this.sandbox.getOption("styles"),this.isTextBased=function(){var a=["textarea","text","email","search","url"];return a.indexOf(f.originalElement.type)>=0}(),this.sandbox.setOption("isTextBasedContainer",this.isTextBased),this.isInputBased=function(){var a=["text","email","search","url"];return a.indexOf(f.originalElement.type)>=0}(),this.prefix="wsc-",this.fakeElement=this.createFakeElement(),this.isTextBasedContainer=this.sandbox.getOption("isTextBasedContainer")};f.prototype={init:function(){var a;this.attachEvents(),this.setMaxLength(),this.fakeElement?(this.adjustStyles(this.originalElement,this.fakeElement,this.styles),a=g(this.fakeElement,this.sandbox,this),a.init(this.originalElement),this.fakeElement.innerHTML=this.DataProcessor.textToHtml(this.originalElement.value,this.isInputBased),this.UILib.hide(this.originalElement),this.originalElement.proofraytFakeElement=this.fakeElement,this.sandbox.setContainer(this.fakeElement),this.sandbox.setOption("documentContainer",this.fakeElement)):(c.attr(this.originalElement,"aria-readonly",!1),c.attr(this.originalElement,"spellcheck",!1))},destroy:function(){this.fakeElement&&(this.UILib.remove(this.fakeElement),this.originalElement.proofraytFakeElement=null,this.UILib.css(this.originalElement,{display:""})),this.detachEvents()},getOriginalElement:function(){return this.originalElement},getFakeElement:function(){return this.fakeElement},getTextContainer:function(){return this.fakeElement||this.originalElement},setData:function(a){var b=this.DataProcessor;a=this.sandbox.getHtmlWithoutSpellingNodes(a),a=this.sandbox.getHtmlWithoutGrammarNodes(a),this.fakeElement?(this.fakeElement.innerHTML=b.textToHtml(a,this.isInputBased),this.originalElement.value=b.htmlToText(this.fakeElement.innerHTML,this.isInputBased)):this.originalElement.innerHTML=a},getData:function(){return this.originalElement.value||this.originalElement.innerHTML},createFakeElement:function(){var a,d=null,e=this;return e.isTextBased&&b(e.originalElement)&&(d=c.create("<div>")[0],e.originalElement.disabled||e.originalElement.readOnly||c.attr(d,"contenteditable",!0),c.attr(d,"aria-readonly",!1),c.addClass(d,e.prefix+"wrapper"),a=c.attr(e.originalElement,"id"),a&&c.attr(d,"id",e.prefix+a),c.insertAfter(d,e.originalElement)),d},adjustStyles:function(a,b,d){var e,f,g,h="."+this.prefix+"wrapper{overflow: auto;overflow-x: hidden;padding: 1px;font-style: normal;font-weight: normal;text-align: start;color: #000;border: 1px solid #b3b3b3;background: #fff;}."+this.prefix+"input{overflow-y: hidden;white-space: nowrap;border-color: #a9a9a9;}."+this.prefix+"textarea{white-space: pre-wrap;padding: 2px;border-color: #808080;-moz-appearance: textfield-multiline;-webkit-appearance: textfield;appearance: textfield;resize: both;}."+this.prefix+"wrapper[contentEditable=true]:empty:before{content: attr(data-placeholder);color: #888;}";if(e=c.attr(a,"style"),e="string"==typeof e?e:e.cssText,c.attr(b,"style",e),f=c.attr(a,"class"),c.addClass(b,f),g=c.find("#"+this.prefix+"wrapper-styles")[0],!g||g.innerHTML!==h){var i=c.create("<style>")[0];c.attr(i,"id",this.prefix+"wrapper-styles"),c.attr(i,"type","text/css"),i.styleSheet?i.styleSheet.cssText=h:i.innerHTML=h,c.prependTo(i,"head")}c.addClass(b,this.prefix+(this.isInputBased?"input":"textarea"));var j=c.css(a,"width"),k=c.css(a,"height");c.css(b,{width:j,height:k});var l=c.css(a,"fontFamily"),m=c.css(a,"fontSize");c.css(b,{fontFamily:l,fontSize:m}),c.attr(b,"spellcheck","false");var n=c.attr(a,"title"),o=c.attr(a,"placeholder");c.attr(b,"title",n),c.attr(b,"data-placeholder",o),"object"==typeof d&&c.css(b,this.styles)},attachEvents:function(){var a,b,c,e=this;this.fakeElement?(this.sandbox.subscribe({eventType:"keydown",element:this.fakeElement,handler:function(d){var f=d;c=1,a=!1,b=!1,13===f.keyCode&&(f.preventDefault(),a=!0,e.isInputBased?b=!0:f.altKey||f.ctrlKey?b=!0:c=2),this.sandbox.fire({eventType:"keydownCharLengthOnFakeElement",data:{charLength:c}})},priority:2e3}),this.sandbox.subscribe({eventType:"keyup",element:this.fakeElement,handler:function(){e.originalElement.value=e.DataProcessor.htmlToText(e.fakeElement.innerHTML,e.isInputBased)}})):this.sandbox.subscribe({eventType:"keydown",element:e.getOriginalElement(),handler:function(c){b&&c.stopImmediatePropagation(),a&&c.preventDefault()},priority:2e3}),e.sandbox.subscribe("pasteProcessed",this.onPasteHandler,e,1e3),this.fakeElement&&(e.isInputBased||e.sandbox.subscribe({eventType:"keydown",element:this.originalElement,handler:function(a){var b=a;13===b.keyCode&&(b.preventDefault(),e.onEnterKeyHandler()),!d.Browser.gecko||8!==b.keyCode&&46!==b.keyCode||e.onDeleteKeyHandler()}}),e.sandbox.subscribe("afterPaste,replaceWord,replacePhrase,afterDrop,undo,redo",function(){e.originalElement.value=e.DataProcessor.htmlToText(e.fakeElement.innerHTML,e.isInputBased)},e,-2e3))},setMaxLength:function(){var a;this.isTextBased&&(a=parseInt(c.attr(this.originalElement,"maxlength"),10),a>=0&&this.sandbox.setOption("maxLength",a))},detachEvents:function(){var a=this;a.sandbox.unsubscribe("replaceWord",a),a.sandbox.unsubscribe("afterPaste",a),a.sandbox.unsubscribe("paste",a),a.sandbox.unsubscribe("keypress",a),a.sandbox.unsubscribe("afterDrop",a),a.sandbox.unsubscribe("undo",a),a.sandbox.unsubscribe("redo",a),a.sandbox.unsubscribe({eventType:"keydown, keyup",element:a.getTextContainer()})},onEnterKeyHandler:function(){var a,b=this.sandbox.getSelection(),d=c.create("<br>")[0];a=b.getRangeAt(0),a.collapsed()||(a.deleteContents(),a.collapse(!0)),this.isEndOfContainer(a)&&this.appendBogus(),a.insertNode(d),a.setStartAfter(d),b.removeAllRanges(),b.addRange(a)},onDeleteKeyHandler:function(){var a=this.sandbox.getOption("container");setTimeout(function(){"<br>"===a.innerHTML&&(a.innerHTML="")},0)},onPasteHandler:function(a){var b,c=a.pasteInto,d=this,e=d.sandbox.getOption("container");c===e&&(a.text=d.sandbox.getHtmlWithoutSpellingNodes(a.text),a.text=d.sandbox.getHtmlWithoutGrammarNodes(a.text),a.text=a.text.replace(/<meta.*?>/i,""),a.text=a.text.replace(/style="[^\"]*"/gi,""),b=a.text.match(/<!--StartFragment-->([\s\S]*?)<!--EndFragment-->/i),a.text=b?b[1]:a.text,d.isTextBased&&("html"===a.contentType&&(a.text=d.DataProcessor.htmlToText(a.text),a.text=d.DataProcessor.encodingTools.htmlEncode(a.text)),a.text=d.DataProcessor.textToHtml(a.text,d.isInputBased)))},isEndOfContainer:function(a){var b,c,d=this,e=d.sandbox.getOption("container"),f=a.cloneRange();return f.collapse(!1),f.setEnd(e,e.childNodes.length),f.toString().length>0?!1:(b=f.getNodes(),c=b.filter(function(a){return"br"===a.nodeName.toLowerCase()}),c.length>0?!1:!0)},appendBogus:function(){var a,b=this,e=b.sandbox.getOption("container");a=c.find("br.wsc-bogus",e)[0],a=a||c.create('<br class="wsc-bogus">')[0],d.Browser.gecko&&c.attr(a,"type","_moz"),c.appendTo(a,e)}};var g=function(a,b,c){var f,g,h,i=a||this,j=["click","focus","keypress","keydown","keyup","blur","mouseout","change","dblclick","mousedown","mousemove","mouseover","mouseup","select","paste","cut","copy","contextmenu","drag","dragend","dragenter","dragleave","dragover","dragstart","drop"];return{init:function(a){b.addEventProxy({from:i,to:a,eventsNames:j}),d.Browser.ie&&b.subscribe("pasteProcessed",function(){b.fire({element:a,eventType:"paste"})}),b.subscribe({element:i,eventType:"mouseup",handler:function(){f=b.getSelection(),f.rangeCount()>0&&!f.getRangeAt(0).collapsed()&&b.fire({element:a,eventType:"select"})}}),b.subscribe({element:i,eventType:"focus",handler:function(){g=e.htmlToText(i.innerHTML,c.isInputBased)}}),b.subscribe({element:i,eventType:"blur",handler:function(){h=e.htmlToText(i.innerHTML,c.isInputBased),g!==h&&b.fire({element:a,eventType:"change"})}})}}};a.Wrapper=f}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.maxLength=this.sandbox.getOption("maxLength"),this.blockDOMKeyDown=!1,this.isInputBased=this.sandbox.UILib.hasClass(this.sandbox.getOption("container"),"proofrayt-input"),this.keydownCharLength=1};b.prototype={init:function(){var a=this;return this.maxLength<0?!1:(this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.onKeyDownHandler,priority:2e3}),this.sandbox.subscribe({eventType:"keydownCharLengthOnFakeElement",handler:function(a){this.keydownCharLength=a.charLength}}),a.sandbox.subscribe("pasteProcessed",this.onPasteHandler,a,0),void a.sandbox.subscribe("drop",this.onDropHandler,a,0))},onKeyDownHandler:function(a){function b(a){for(var b=!1,c=!0,d=0;d<k.length;d+=1){c=!0;for(var e in k[d])if(c=c&&a[e]===k[d][e],!c)break;b=b||c}return b}var c,d,e,f=(this.sandbox.Utils,a),g=67,h=88,i=65,j=[186,187,188,189,190,191,192,219,220,221,222,96,97,98,99,100,101,102,103,104,105,106,107,109,110,111],k=[{keyCode:13,altKey:!1,ctrlKey:!1},{keyCode:32,altKey:!1}];return this.blockDOMKeyDown=!1,c=(f.ctrlKey||f.metaKey)&&f.keyCode===h,d=(f.ctrlKey||f.metaKey)&&f.keyCode===g,e=(f.ctrlKey||f.metaKey)&&f.keyCode===i,(!c&&!d&&!e&&!f.ctrlKey&&!f.altKey&&!f.metaKey&&f.keyCode>=48&&f.keyCode<=90||!f.ctrlKey&&!f.altKey&&j.indexOf(f.keyCode)>=0||b(f))&&this.checkMaxLength(this.keydownCharLength)>0&&(this.blockDOMKeyDown=!0),this.blockDOMKeyDown?(f.preventDefault(),f.stopPropagation(),!1):void 0},onPasteHandler:function(a){var b,c=a.pasteInto,d=this.sandbox.DataProcessor,e=this.sandbox.getOption("container"),f=a.text;c==e&&(f=d.htmlToText(f,this.isInputBased),b=this.checkMaxLength(f.length),b>0&&(f=f.substring(0,f.length-b),f=d.textToHtml(f,this.isInputBased),a.text=f))},onDropHandler:function(a){var b,c=this.sandbox.DataProcessor,d=(this.sandbox.getOption("container"),a.text);1!==a.dropState&&(d=c.htmlToText(d,this.isInputBased),b=this.getTextLength()+d.length-this.maxLength,b>0&&(d=d.substring(0,d.length-b),d=c.textToHtml(d,this.isInputBased),a.text=d))},checkMaxLength:function(a){var b,c=0;return b=this.sandbox.getSelection().getRangeAt(0),b.collapsed()||(b.deleteContents(),b.collapse(!0)),c=this.getTextLength()+a-this.maxLength},getTextLength:function(){var a,b=this.sandbox.getOption("container"),c=this.sandbox.DataProcessor,d=-1;return a=b.innerHTML,this.isInputBased&&this.sandbox.Utils.Browser.gecko&&(a=a.replace(/<br>/gi,"")),d=c.htmlToText(a,this.isInputBased).length}},a.MaxLength=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.UILib=b.UILib,this.Utils=b.Utils,this.control=b.getOption("container"),this.controlFocused=b.getOption("focused"),this.browser=this.Utils.Browser,this.eventsNames={focus:"focus",blur:"blur",beforefocus:"beforefocus",beforeblur:"beforemanualcontrolblur",restoreSelection:"restoreSelection"},this.sandbox=b,this.bookmark=null};b.prototype={constructor:b,init:function(){var a=this.sandbox,b=this.control;a.subscribe({eventType:this.eventsNames.focus,element:b,handler:this.focusHandler}),a.subscribe({eventType:this.eventsNames.restoreSelection,element:b,handler:this.restoreSelection}),a.subscribe({eventType:this.eventsNames.beforeblur,handler:this.beforeBlurHandler})},restoreSelection:function(){this.bookmark&&(this.sandbox.fire({eventType:"focus",element:this.control}),this.sandbox.restoreSelection(this.bookmark),this.bookmark=null)},focusHandler:function(){var a=this;setTimeout(function(){a.bookmark&&a.sandbox.removeMarkers(a.bookmark)},0)},beforeBlurHandler:function(){this.bookmark=this.sandbox.saveSelection()}},a.FocusManager=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d,e,f=a.prototype.UILib,g=a.prototype.Utils,h=(a.prototype.DataProcessor,{internalDrop:1,externalDrop:2,crossContainerDrop:3}),i=0,j=!1,k=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.isTextBasedContainer=this.sandbox.getOption("isTextBasedContainer")};k.prototype={init:function(){var a=this;return g.Browser.ie&&g.Browser.version<=8?void this.sandbox.subscribe({eventType:"drop",element:this.container,handler:function(b){b.preventDefault(),a.sandbox.console.warn("Drag and Drop functionality are not supported in Internet Explorer 8 and its earlier versions.")}}):(this.sandbox.subscribe({eventType:"drop",element:this.container,handler:a.handleNativeDrop}),this.sandbox.subscribe({eventType:"dragstart",element:this.container,handler:a.handleDragStart}),this.sandbox.subscribe({eventType:"dragend",element:this.container,handler:a.handleDragEnd}),void this.sandbox.subscribe("dropProcessed",function(b){a.handleDrop(b)},this,-2e3))},destroy:function(){this.removeAllEventHandlers()},handleNativeDrop:function(a){var e,f,j,k,l,m,n=this.container;return e=this.isTextBasedContainer||g.Browser.safari||g.Browser.ie?a.dataTransfer.getData("Text")||a.dataTransfer.getData("text/plain"):a.dataTransfer.getData("text/html"),!e&&this.isTextBasedContainer?void a.preventDefault():(i=b?b&&d===n?h.internalDrop:h.crossContainerDrop:h.externalDrop,f=this.getCaretRangeFromDrop(a),!f||this.isCaretRangeInEndOfDragRange(b,f)?void a.preventDefault():(b?(j=this.isCaretRangeWillAffected(b,f),j||(c=this.sandbox.saveRange(b)),k=this.sandbox.saveRange(f),j&&(c=this.sandbox.saveRange(b))):k=this.sandbox.saveRange(f),l=i===h.internalDrop?c:k,m=i===h.internalDrop?k:null,void this.sandbox.fire("dropProcessed",{event:a,text:e,dropState:i,savedRange:l,savedRangeToRemove:m,savedCaretRange:k})))},handleDrop:function(a){a.event.preventDefault(),j=!0,this.addContent(a.text,a.savedCaretRange)},handleDragStart:function(){b=this.sandbox.getSelection().getRangeAt(0),d=this.container},handleDragEnd:function(a){{var d,e;this.sandbox.getOption("data_attribute_name")}(j||"none"!==a.dataTransfer.dropEffect)&&(i===h.crossContainerDrop&&this.sandbox.fire("crossContainerDrop",{event:a,savedRange:c}),d=j?this.sandbox.restoreRange(c):b,d&&j&&(e=this.sandbox.getSelection(),e.removeAllRanges(),e.addRange(d),g.Browser.ie&&this.sandbox.setOption("leftMouseButtonPressed",!1),this.sandbox.fire("removeMarkupInSelectionNode"),d=e.getRangeAt(0),d.deleteContents(),this.sandbox.fire("afterDrop"))),this.clearTemporaryData()},addContent:function(a,b){var c,d,e,h,i,j=this,k=this.sandbox.createRange(),l=this.sandbox.getOption("data_attribute_name"),m=document.createElement("span");a=this.sandbox.getHtmlWithoutSpellingNodes(a),a=this.sandbox.getHtmlWithoutGrammarNodes(a),a=a.replace(/<meta.*?>/i,""),a=a.replace(/style="[^\"]*"/gi,""),m.innerHTML=a,setTimeout(function(){j.sandbox.fire({element:j.container,eventType:"focus"}),i=j.sandbox.getSelection(),c=j.sandbox.restoreRange(b),d=c.startContainer(),g.Browser.ie&&j.sandbox.setOption("leftMouseButtonPressed",!1),g.Browser.ie&&j.sandbox.setOption("focused",!0),0===c.startOffset()&&g.isEqualNode(d,l)?(b=j.sandbox.saveRange(c),j.sandbox.fire("removeMarkupInSelectionNode",{selectionNode:d}),c=j.sandbox.restoreRange(b)):(i.removeAllRanges(),i.addRange(c),j.sandbox.fire("removeMarkupInSelectionNode"),c=i.getRangeAt(0)),c.insertNode(m),e=j.sandbox.createRange(),h=j.sandbox.createRange(),e.selectNode(m),h.selectNodeContents(m),e.commonAncestorContainer().insertBefore(h.extractContents(),m),k.setStartAfter(m),k.collapse(!0),i.removeAllRanges(),i.addRange(k),f.remove(m),j.clearTemporaryData(),j.sandbox.fire("afterDrop")},50)},getCaretRangeFromDrop:function(a){var b=this.sandbox.getSelection(),c=b.rangeCount()>0?b.getRangeAt(0):void 0;return this.sandbox.Utils.Browser.ie&&this.sandbox.Utils.Browser.version>8&&void 0!==c&&i===h.internalDrop?c:this.sandbox.getCaretRangeFromEvent(a)},isCaretRangeWillAffected:function(a,b){return a.endContainer()===b.startContainer()&&a.endOffset()<b.endOffset()?!0:!1},isCaretRangeInEndOfDragRange:function(a,b){return a&&a.endContainer()===b.startContainer()&&a.endOffset()===b.endOffset()?!0:!1},clearTemporaryData:function(){i=0,b=null,c=null,d=null,e=null,j=!1},removeAllEventHandlers:function(){this.sandbox.unsubscribe({eventType:"drop, dragstart, dragend",element:this.container})}},a.DragAndDropManager=k}(WEBSPELLCHECKER.CORE),function(a){"use strict";a.prototype.UILib;WEBSPELLCHECKER.ALT=a.ALT=.1,WEBSPELLCHECKER.CTRL=a.CTRL=.2,WEBSPELLCHECKER.SHIFT=a.SHIFT=.4;var b=function(a,b){this.name=a,this.sandbox=b,this.shortcutsList={},this.modifierKeys=this.sandbox.getOption("modifierKeys")};b.prototype={init:function(){this.setShortcuts(this.sandbox.getOption("shortcutsList")),this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.handleKeydown,priority:1e3}),this.sandbox.subscribe("setShortcuts",function(a){this.setShortcuts(a.shortcuts)}),this.sandbox.subscribe("removeShortcuts",function(a){this.removeShortcuts(a.shortcuts)})},handleKeydown:function(a){var b,c,d=a.keyCode||a.which;if((a.ctrlKey||a.metaKey)&&(d+=this.modifierKeys.CTRL),a.shiftKey&&(d+=this.modifierKeys.SHIFT),a.altKey&&(d+=this.modifierKeys.ALT),d=d.toFixed(1),this.shortcutsList.hasOwnProperty(d))for(var e=0,f=this.shortcutsList[d].length;f>e;e++)b=this.shortcutsList[d][e].callback,c=this.shortcutsList[d][e].context,b.call(c,a)||(a.preventDefault(),a.stopPropagation())
},setShortcuts:function(a){if(a.length)for(var b=0,c=a.length;c>b;b++)this.setShortcut(a[b].shortcut,a[b].callback,a[b].context)},setShortcut:function(a,b,c){a=a.toFixed(1),this.shortcutsList.hasOwnProperty(a)||(this.shortcutsList[a]=[]),this.shortcutsList[a].push({callback:b,context:c||this})},removeShortcuts:function(a){if(a.length)for(var b=0,c=a.length;c>b;b++)this.removeShortcut(a[b].shortcut,a[b].callback)},removeShortcut:function(a,b){a=a.toFixed(1);for(var c=0,d=this.shortcutsList[a].length;d>c;c++)this.shortcutsList[a][c].callback===b&&this.shortcutsList[a].splice(c,1)}},a.KeyboardManager=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=(a.prototype.UILib,a.prototype.Utils),c=a.prototype.DataProcessor,d=function(a,b){this.name=a,this.sandbox=b,this.data=[],this.container=this.sandbox.getOption("container"),this.limit=this.sandbox.getOption("undoDataSize")||20,this.index=-1,this.isTyping=!1,this.isDeleted=!1,this.isDirty=!1};d.prototype={init:function(){var a=this;this.sandbox.subscribe("allModulesReady",function(){this.setShortcuts()}),this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:this.handleKeydown,priority:1e3}),this.sandbox.subscribe({eventType:"click",element:this.container,handler:a.handleNavigation}),this.sandbox.subscribe("cutProcessed, replaceWord, replacePhrase",function(){this.handleCutReplace()},this,1e3),this.sandbox.subscribe("pasteProcessed",function(a){this.handlePaste(a)},this,-1e3),this.sandbox.subscribe("dropProcessed",function(a){this.handleDrop(a)},this,-1e3),this.sandbox.subscribe("crossContainerDrop",function(a){this.handleCrossContainerDrop(a)}),this.sandbox.subscribe("executeUndo",function(){this.undo()},this),this.sandbox.subscribe("executeRedo",function(){this.redo()},this),this.sandbox.subscribe("checkUndoRedoPosibility",function(){this.checkUndoRedoPosibility()},this),this.breakingRichMarkupCommands={bold:!1,underline:!1,italic:!1}},destroy:function(){this.removeAllEventHandlers()},handleKeydown:function(a){var b=a.keyCode||a.which,c=b>=16&&20>=b||91===b||a.altKey||a.ctrlKey||a.metaKey,d=13===b||8===b||46===b;return b>=33&&40>=b?void this.handleNavigation():(d||c||this.isTyping||(this.add({fixRichMarkup:!0}),this.isTyping=!0,this.isDeleted=!1,this.isDirty=!0),13===b&&(this.add(),this.isTyping=!1,this.isDeleted=!1,this.isDirty=!0),void(8!==b&&46!==b||this.isDeleted||(this.add(),this.isTyping=!1,this.isDeleted=!0,this.isDirty=!0)))},setShortcuts:function(){var a=this,b=this.sandbox.getOption("modifierKeys");this.sandbox.fire("setShortcuts",{shortcuts:[{shortcut:b.CTRL+90,callback:a.undo,context:a},{shortcut:b.CTRL+b.SHIFT+90,callback:a.redo,context:a},{shortcut:b.CTRL+89,callback:a.redo,context:a}]}),this.sandbox.getOption("isTextBasedContainer")||this.sandbox.fire("setShortcuts",{shortcuts:[{shortcut:b.CTRL+66,callback:function(){a.execCommand("bold",!1,null),a.setBreakingRichMarkupCommands("bold")},context:a},{shortcut:b.CTRL+73,callback:function(){a.execCommand("italic",!1,null),a.setBreakingRichMarkupCommands("italic")},context:a},{shortcut:b.CTRL+85,callback:function(){a.execCommand("underline",!1,null),a.setBreakingRichMarkupCommands("underline")},context:a}]})},handlePaste:function(a){(!a||a.text)&&(this.add(),this.isDirty=!0)},handleCutReplace:function(){this.add(),this.isDirty=!0},handleDrop:function(a){(!a||a.text)&&(this.add(a),this.isDirty=!0)},handleCrossContainerDrop:function(a){this.add(a),this.isDirty=!0},handleNavigation:function(){this.isTyping&&(this.isTyping=!1),this.isDeleted&&(this.isDeleted=!1),this.clearBreakingRichMarkupCommands()},add:function(a){{var d,e,f,g;b.getCurrentDocument(this.sandbox.getOption("documentContainer"))}this.data.length&&(d=this.sandbox.removeMarkupFromString(this.data[this.index].html),d=c.getHtmlWithoutRangyMarkerNodes(d)),e=this.sandbox.removeMarkupFromString(this.container.innerHTML),e=c.getHtmlWithoutRangyMarkerNodes(e),this.clearRedo(),(d!==e||a&&a.savedRangeToRemove)&&(a&&a.savedRange||(f=this.sandbox.saveSelection(),g=this.sandbox.getSavedSelectionParentContainer(f)),this.checkDataLimit(),this.data.push({html:b.removeFillingCharacter(this.container.innerHTML),savedSelection:f?f:null,savedRange:a&&a.savedRange?a.savedRange:null,savedRangeToRemove:a&&a.savedRangeToRemove?a.savedRangeToRemove:null}),f&&(this.sandbox.restoreSelection(f),b.Browser.gecko&&g&&g.normalize()),a&&a.fixRichMarkup&&this.fixRichMarkup(),this.clearBreakingRichMarkupCommands(),this.index=this.data.length-1)},undo:function(){this.isDirty&&(this.add(),this.clearFlags()),this.index<=0||(this.container.innerHTML=this.data[--this.index].html,this.restoreSelection(),this.clearFlags(),this.clearBreakingRichMarkupCommands(),this.sandbox.fire("undo",{undoLevel:this.data[this.index]}))},redo:function(){this.index>=this.data.length-1||(this.container.innerHTML=this.data[++this.index].html,this.restoreSelection(),this.clearFlags(),this.clearBreakingRichMarkupCommands(),this.sandbox.fire("redo",{undoLevel:this.data[this.index]}))},checkUndoRedoPosibility:function(){this.sandbox.fire("undoRedoPosibility",{canUndo:this.isDirty||this.index>0?!0:!1,canRedo:this.index<this.data.length-1?!0:!1})},clearRedo:function(){this.data.splice(this.index+1)},clearFlags:function(){this.isTyping=!1,this.isDeleted=!1,this.isDirty=!1},checkDataLimit:function(){this.data.length>this.limit&&this.data.shift()},restoreSelection:function(){var a,b=this.sandbox.getSelection(),c=this.data[this.index].savedSelection,d=this.data[this.index].savedRange,e=this.data[this.index].savedRangeToRemove;e&&this.sandbox.restoreRange(e),c&&(c.restored=!1,this.sandbox.restoreSelection(c)),d&&(a=this.sandbox.restoreRange(d),b.removeAllRanges(),b.addRange(a))},removeAllEventHandlers:function(){this.sandbox.unsubscribe({eventType:"keydown",element:this.container,handler:this.handleKeydown}),this.sandbox.unsubscribe({element:this.container,eventType:"click",handler:this.handleNavigation})},setBreakingRichMarkupCommands:function(a){a in this.breakingRichMarkupCommands&&this.breakingRichMarkupCommands.hasOwnProperty(a)&&(this.breakingRichMarkupCommands[a]=!this.breakingRichMarkupCommands[a])},clearBreakingRichMarkupCommands:function(){for(var a in this.breakingRichMarkupCommands)this.breakingRichMarkupCommands.hasOwnProperty(a)&&(this.breakingRichMarkupCommands[a]=!1)},fixRichMarkup:function(){for(var a in this.breakingRichMarkupCommands)this.breakingRichMarkupCommands.hasOwnProperty(a)&&this.breakingRichMarkupCommands[a]===!0&&this.execCommand(a,!1,null)},execCommand:function(a){var c=b.getCurrentDocument(this.sandbox.getOption("documentContainer"));c.execCommand(a,!1,null)}},a.UndoManager=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.delay=1e3,this.mutationObserver=null,this.mutationOptions={attributes:!0,attributeOldValue:!0,childList:!0,characterData:!0,characterDataOldValue:!1,subtree:!0},this.inThrottle=!1};b.prototype={init:function(){this.sandbox.getOption("isMutationObserver")&&(this.mutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.startMutationObserver(),this.sandbox.subscribe("lockMutationsListener",function(a){this.lockMutationsListener(a)},this))},lockMutationsListener:function(a){a.lock?this.stopMutationObserver():this.startMutationObserver()},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(document.getElementsByTagName("body")[0],this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},handleMutations:function(){var a=this;this.inThrottle||(this.inThrottle=!0,setTimeout(function(){a.inThrottle=!1,a.sandbox.fire("periodicalChecking")},this.delay))},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null}},a.DOMChangesListener=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.cache=this.createCacheSentences(),this.sandbox.subscribe("startGrammarCheck",function(){this.startGrammarCheck()},this),this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:function(a){var b=this.sandbox.getOption("enableGrammar");b&&this.handleKeydown(a)}}),this.sandbox.subscribe("collectSentences",function(a){var b=this.sandbox.getOption("enableGrammar");b&&this.findSentences(a.source)},this),this.sandbox.subscribe("updateSentencesCache",function(a){this.handleCacheUpdate(a)},this),this.sandbox.subscribe("enableGrammarChanged",function(a){a.state&&this.sandbox.fire("updateSentencesCache",{phrase:null})},this)},handleCacheUpdate:function(a){var b=a.phrase,c=a.phrasesInfo;b?this.cache.deleteSentencesByPhrase(b):c?this.cache.update(c.sentence,c.phrases):this.cache.clear()},createCacheSentences:function(){var b=this,c={},d="sentence__";return{add:function(a){return c[d+a]={sentence:a,phrases:[]}},get:function(a){return c[d+a]},deleteSentencesByPhrase:function(a){var b,d;for(var e in c){b=c[e];for(var f=0;f<b.phrases.length;f++)if(d=b.phrases[f],d.phrase===a){delete c[e];break}}},update:function(){var e=Object.prototype.toString.call(arguments[0]).slice(8,-1).toLowerCase(),f=(a.GrammarDictionaryManager.Dictionary,[]);if("array"===e){for(var g=arguments[0],h=b.sandbox.getOption("lang"),i=[],j=0,k=(g.length,"");k=g[j];j++)if(c[d+k]){var l=c[d+k];l.stayAlive&&i.push(l),l.stayAlive=!0}else{var m=this.add(k);m.stayAlive=!0,f.push(k)}i=b.sandbox.Utils.ArrayUtils.arrayUnique(i,function(a,b){return a.sentence===b.sentence}),b.sandbox.fireInAllApps("problemSentencesFound",{sentences:i,lang:h});for(var n in c)c[n].stayAlive?delete c[n].stayAlive:delete c[n];return f}if("string"===e){var k=arguments[0],o=arguments[1]||[];c[d+k]&&(c[d+k].phrases=o)}},isEmpty:function(){return!!b.Utils.getKeys(c).length},clear:function(){c={}}}},findSentences:function(a){var b,c,d=this;return this.sandbox.Utils.is(a,"String")&&(b=this.collectSentencesFromString(a)),this.sandbox.Utils.is(a,"Object")&&(b=this.collectSentencesInRange(a)),c=d.cache.update(b),this.sandbox.fire("sentencesCollected",{sentencesCollection:c}),c},collectSentencesInRange:function(a){var b=this.createStringForGrammarCheck(a.commonAncestorContainer());return this.collectSentencesFromString(b)},createStringForGrammarCheck:function(a){for(var b=this.sandbox.UILib,c="",d=[a],e=d.shift(),f=this.sandbox.RegularsManager,g=f.ieSeparator,h=f.blockElementsRegex,i=f.ignoreElementsRegex,j=f.ignoreGrammarElementsRegex,k=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),l=f.sentenceEndCharsGrammar,m=f.nonWhiteSpaceExtended;e;){switch(e.nodeType){case 3:c+=e.nodeValue;break;case 1:if(!k.test(b.attr(e,"className"))&&!i.match(e.nodeName)&&!j.match(e.nodeName)){for(var n=0;n<e.childNodes.length;n++)d.splice(n,0,e.childNodes[n]);h.match(e.nodeName)&&(d.length>e.childNodes.length&&d.splice(n,0,document.createTextNode("\u2029")),c.length>0&&-1===l.search(c)&&-1!==m.search(c)?d.splice(0,0,document.createTextNode("\u2029")):c.length>0&&" "!=c[c.length-1]&&d.splice(0,0,document.createTextNode(" ")))}}e=d.shift()}return c=this.sandbox.removeSpecialCharacters(c),c=g.replace(c," ")},collectSentencesFromString:function(a){function b(a){function b(a){var b=/[\t|\v|\f|\r]+/g;return b.lastIndex=0,a.replace(b," ")}function d(a,b,c){j=c.substring(a,b),j=j.trim(),j.length&&g.push(j)}function e(a,b){this.position=a,this.offset=5,this.left=b.substr(this.position-5,5),this.right=b.substr(this.position+1,6),this.toString=this.left.concat(b.charAt(this.position),this.right)}function f(a,b,f){if(8233===a.charCodeAt(0))return d(h,b,f),void(h=i=b+1);var g=new e(b,f);/\d/g.test(g.left)||/[\n|\t|\v|\f|\r]+/g.test(g.left)||c.hasUppercaseLetter(g.left)||(g.position+1===f.length||c.startsWithSpaceAndUppercaseLetter(g.right))&&(d(h,g.position+1,f),h=i=g.position+1)}var g=[],h=0,i=0,j="",k=/[.!?\u2029](?=[\s\xA0]?)/gm;return k.lastIndex=0,a=a.trim(),a=b(a),a.replace(k,f),d(i,a.length,a),g}var c=this.sandbox.Utils;return a=a.source||a,b(a)},handleKeydown:function(a){var b=this;(32==a.keyCode||13==a.keyCode||32==a.charCode||13==a.charCode)&&b.sandbox.addDeferredFunction("collectSentencesAfterKeypress",{single:!0,delay:0,deferredFunction:function(){b.startGrammarCheck()}}),b.sandbox.addDeferredFunction("collectSentencesAfter4Sec",{single:!0,delay:4e3,deferredFunction:function(){b.startGrammarCheck()}})},startGrammarCheck:function(){var a=this.sandbox.createRange(),b=this.sandbox.getOption("container");a.selectNodeContents(b),this.sandbox.fire("collectSentences",{source:a})}},a.SentencesCollector=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";if(!a.GrammarDictionaryManager){var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("sentencesCollected",function(a){this.sentencesCollectedHandler(a.sentencesCollection)},this),this.sandbox.subscribe("getGrammarSuggestionsList",function(a){this.getSuggestionsListHandler(a.phrase,a.rule,a.lang)},this)},sentencesCollectedHandler:function(a){var b=this.sandbox.getOption("lang");a.length>0&&this.getPhraseInfo(a,b)},getSuggestionsListHandler:function(a,c,d){var e=b.Dictionary.getPhrase(a,c,d);this.sandbox.fire("suggestionListSend",{suggestionList:e?e.suggestions:[]})},getPhraseInfo:function(a,c){var d=this,e=this.sandbox.getOption("grammarLangList"),f=b.Dictionary;return e?c in e.ltr||c in e.rtl?void this.sandbox.addDeferredFunction("getPhraseInfo",{delay:500,collection:a,partialItemsCount:2,deferredFunction:function(a){return d.sandbox.fire("remoteAction",{actionMethod:"grammarCheck",lang:c,sentences:JSON.stringify(a),onSuccess:function(a){for(var b=[],e=0;e<a.length;e++){for(var g=a[e],h=[],i=0;i<g.matches.length;i++){var j=g.matches[i];h.push(j),j.phrase=g.sentence.substring(j.offset,j.offset+j.length),f.addPhrase(j,c)}d.sandbox.fire("updateSentencesCache",{phrasesInfo:{sentence:g.sentence,phrases:h}}),h.length&&b.push({sentence:g.sentence,phrases:h})}d.sandbox.fireInAllApps("problemSentencesFound",{sentences:b,lang:c}),d.sandbox.setOption("numberOfFailedRequest",0)},onError:function(){var b=d.sandbox.getOption("numberOfFailedRequest");d.sandbox.setOption("numberOfFailedRequest",++b),b>4?(d.sandbox.setPaused(!0),d.sandbox.removeAllDeferredFunctions()):d.getPhraseInfo(a,c)}}),!0}}):void this.sandbox.console.warn('Specified "'+c+'" language is not supported for your Customer ID. More details at http://wiki.webspellchecker.net or contact support@webspellchecker.net'):void console.warn("Webspellchecker: Grammarcheck lang list not defined.")},getPhraseFromDictionary:function(a,c,d){var e=b.Dictionary;return e.getPhrase(a,c,d)}},b.Dictionary=b.Dictionary||function(){var a={},b={},c="phrase_",d=function(b,d){var e=b.phrase,f=b.suggestions,g=b.rule.id,h=b.message;return(!f||0===f.length||1===f.length&&""==f[0])&&(f=[]),a[d]=a[d]||{},a[d][g]=a[d][g]||{},a[d][g][c+e]={suggestions:f,problemDescription:h},a[d][g][c+e]};return{addPhrase:function(){return d.apply(this,arguments)},getPhrase:function(b,d,e){return a[e]&&a[e][d]&&a[e][d][c+b]},getProblemDescription:function(b,d,e){return a[e]&&a[e][d]&&a[e][d][c+b]&&a[e][d][c+b].problemDescription},each:function(b,d){if("function"==typeof d)for(var e in a[b])for(var f in a[b][e]){var g=f.substring(c.length);d(a[b][e][f],g)}},clear:function(){a={}},setIgnoreInInstance:function(a,d,e){"undefined"!=typeof e&&(b[e]||(b[e]={}),b[e]=b[e]||{},b[e][d]=b[e][d]||{},b[e][d][c+a]=!0)},isIgnoreInInstance:function(a,d,e){return"undefined"!=typeof e?b[e]&&b[e][d]&&b[e][d][c+a]:void 0}}}(),a.GrammarDictionaryManager=b}}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("problemSentencesFound",function(a){this.processGrammarProblem(a.sentences,a.lang)},this)},processGrammarProblem:function(b,c){var d=this,e=d.sandbox.getOption("lang"),f=d.sandbox.getOption("uid"),g=a.GrammarDictionaryManager.Dictionary;if(c!=e)return!1;for(var h=[],i=0;i<b.length;i++){for(var j=b[i],k=[],l=0;l<j.phrases.length;l++){var m=j.phrases[l];g.isIgnoreInInstance(m.phrase,m.rule.id,f)||k.push(m)}k.length&&h.push({sentence:j.sentence,phrases:k})}0!==h.length&&d.sandbox.addDeferredFunction("findGrammarProblemRangesForMarkupForLang_"+c,{delay:100,collection:h,defferedFunctionArgs:[c],partialItemsCount:1,deferredFunction:function(a,b){{var c,e,f=d.sandbox.isFocused();d.sandbox.Utils.getCurrentDocument(d.sandbox.getOption("documentContainer"))}f&&(c=d.sandbox.saveSelection(),e=d.sandbox.getSavedSelectionParentContainer(c));var g=d.findPhraseRangesForMarkup(a);d.sandbox.fire("markupPhrase",{ranges:g,lang:b}),c&&(d.sandbox.restoreSelection(c),d.sandbox.Utils.Browser.gecko&&e&&e.normalize())}})},findPhraseRangesForMarkup:function(a){var c,d=this.sandbox.createRange(),e=this.sandbox.getOption("container");d.selectNodeContents(e),c=new b.Finder(this.sandbox),c.collectBlockInfo(d.commonAncestorContainer());for(var f=[],g=0;g<a.length;g++)if(a[g].sentence.length)for(c.lastIndex=0;null!==c.findPhrases(a[g]);)f=f.concat(c.phraseRanges);return f.reverse()}},b.Finder=function(a){this.newParts={getPos:function(a){for(;!this[a];)a--;return this[a]}},this.resultText="",this.lastIndex=0,this.phraseRange=null,this.reset=function(){this.resultText="",this.lastIndex=0,this.phraseRange=null;for(var a in this.newParts)this.newParts.hasOwnProperty(a)&&"getPos"!==a&&delete this.newParts[a]},this.collectBlockInfo=function(b){function c(a,b,c){if(a!==b){var d={node:c.el,start:j.resultText.length,end:j.resultText.length+b-a,offset:a,problemPhrase:c.problemPhrase};j.newParts[d.start]=d,j.newParts[d.end]=d,j.resultText+=0==c.editable?c.el.nodeValue.replace(/./g," ").substring(a,b):c.el.nodeValue.substring(a,b)}}for(var d,e=[{el:b,editable:"false"==b.getAttribute("contenteditable")?!1:!0}],f=e.shift(),g=a.getOption("lang"),h=a.getOption("languagesMap"),i=a.getOption("languageAttributeName"),j=(a.getOption("languageNodeName"),this),k=a.RegularsManager,l=k.blockElementsRegex,m=k.ignoreElementsRegex,n=k.ignoreGrammarElementsRegex,o=k.ieSeparator,p=a.getOption("problem_grammar_node"),q=a.getOption("problem_grammar_data_attribute"),r=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),s=k.sentenceEndCharsGrammar,t=k.nonWhiteSpaceExtended,u=0,v="",w=[],x=k.specialCharacters.set().onePlus();f;){switch(f.el.nodeType){case 3:f.el.length&&(u=f.indexOffset||0,v=f.el.nodeValue,w=x.match(v.substring(u)),w?(c(u,u+w.index,f),f.indexOffset=u+w.index+w[0].length,e.splice(0,0,f)):(c(u,v.length,f),f.emptyCharsCountInPart=0));break;case 1:if(d=f.el.lang&&h[f.el.getAttribute(i)]!==g?!0:!1,f.el.nodeName.toLowerCase()==p.toLowerCase()&&f.el.getAttribute(q)&&f.el.innerHTML){var v=f.el.getAttribute(q);e.splice(0,0,{el:document.createTextNode(v),editable:!0,problemPhrase:!0})}else if(!(r.test(a.UILib.attr(f.el,"className"))||m.test(f.el.nodeName)||n.test(f.el.nodeName)||d)){for(var y="false"==f.el.getAttribute("contenteditable")?!1:!0,z=0;z<f.el.childNodes.length;z++)e.splice(z,0,{el:f.el.childNodes[z],editable:y});l.match(f.el.nodeName)&&(e.length>f.el.childNodes.length&&e.splice(z,0,{el:document.createTextNode("\u2029"),editable:!0}),this.resultText.length>0&&-1===s.search(this.resultText)&&-1!==t.search(this.resultText)?e.splice(0,0,{el:document.createTextNode("\u2029"),editable:!0}):this.resultText.length>0&&" "!=this.resultText[this.resultText.length-1]&&e.splice(0,0,{el:document.createTextNode(" "),editable:!0}))}}f=e.shift()}this.resultText=o.replace(this.resultText," ")},this.findPhrases=function(b){var c,d,e=a.RegularsManager,f=(e.wordBoundaryRegex,b.sentence),g=this.resultText.indexOf(f,this.lastIndex),h=/[.!?\u2029][\s\xA0]*$/g,i=/^[\s\xA0]*(?=[\u2029]+)/g,j=e.nonWhiteSpaceExtended,k=a.Utils,l=!1,m=!1,n=[];if(g>0)this.lastIndex=g+f.length,c=this.resultText.substring(0,g),d=this.resultText.substring(this.lastIndex),(h.test(c)||-1===j.search(c))&&(l=!0),(this.lastIndex===this.resultText.length||i.test(d)||-1===j.search(d)||k.startsWithSpaceAndUppercaseLetter(d))&&(m=!0),g=l&&m?g:"skipped";else{if(0!==g)return null;this.lastIndex=g+f.length,d=this.resultText.substring(this.lastIndex),(i.test(d)||-1===j.search(d)||k.startsWithSpaceAndUppercaseLetter(d))&&(m=!0),g=m?g:"skipped"}if("skipped"==g)return this.findPhrases.call(this,b);for(var o=0;o<b.phrases.length;o++){var p=a.createRange(),q=b.phrases[o],r=this.newParts.getPos(g+q.offset),s=this.newParts.getPos(g+q.offset+q.length-1);r.problemPhrase||s.problemPhrase||(p.setStart(r.node,g+q.offset-r.start+r.offset),p.setEnd(s.node,g+q.offset+q.length-s.start+s.offset),p=a.Utils.fixRangeBoundaryPoints(p),n.push({range:p,rule:q.rule.id}))}return this.phraseRanges=n,this.phraseRanges}},a.GrammarPhrasesFinder=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){this.sandbox.subscribe("replacePhrase",function(a){this.replacePhraseInSelection(a.phrase,a.grammarNode)},this),this.sandbox.subscribe("ignorePhrase",function(a){this.ignorePhraseInSelection(a.grammarNode)},this),this.sandbox.subscribe("ignoreAllPhrases",function(a){this.ignorePhraseInDocument(a.grammarNode)},this)},replacePhraseInSelection:function(a,b){var c,d=this.sandbox.getOption("container");if(c=b?b:this.sandbox.getGrammarNodeFromSelection(),c&&d.contains(c)){var e=this.sandbox.UILib.attr(c,this.sandbox.getOption("problem_grammar_data_attribute"));this.sandbox.fire("updateSentencesCache",{phrase:e}),this.replacePhraseByNode(c,a)}},ignorePhraseInSelection:function(a){var b,c=this.sandbox.getOption("container");b=a?a:this.sandbox.getGrammarNodeFromSelection(),b&&c.contains(b)&&this.ignorePhrases([b])},ignorePhraseInDocument:function(a){var b,c,d=this.sandbox.getOption("container"),e=this.sandbox.getOption("problem_grammar_node"),f=this.sandbox.getOption("problem_grammar_data_attribute"),g=this.sandbox.getOption("problem_grammar_data_attribute_rule"),h=[];b=a?a:this.sandbox.getGrammarNodeFromSelection(),b&&d.contains(b)&&(c=b.getAttribute(f).replace(/"/g,'\\"'),h.push.apply(h,this.sandbox.UILib.query(d,e+"["+f+'="'+c+'"]['+g+'="'+b.getAttribute(g)+'"]')),this.ignorePhrases(h))},ignorePhrases:function(b){for(var c=this.sandbox.saveSelection(),d=this.sandbox.createRange(),e=a.GrammarDictionaryManager.Dictionary,f=this.sandbox.getOption("problem_grammar_data_attribute"),g=this.sandbox.getOption("problem_grammar_data_attribute_rule"),h=this.sandbox.getOption("lang"),i=this.sandbox.getOption("uid");b.length>0;){var j=b.shift(),k=j.getAttribute(f),l=j.getAttribute(g);e.getPhrase(k,l,h)&&e.setIgnoreInInstance(k,l,i),d.selectNode(j);var m=d.createContextualFragment(j.innerHTML);d.deleteContents(),d.insertNode(m),this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:d.commonAncestorContainer()})}this.sandbox.restoreSelection(c)},replacePhraseByNode:function(a,b){a.innerHTML=b;var c=this.sandbox.createRange();c.selectNodeContents(a),c.collapse(!1);var d=this.sandbox.getSelection();d.removeAllRanges(),d.addRange(c);var e=this.sandbox.saveSelection();c=this.sandbox.createRange(),c.selectNode(a);var f=c.createContextualFragment(a.innerHTML);if(c.deleteContents(),c.insertNode(f),this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:c.commonAncestorContainer(),textChanged:!0}),this.sandbox.restoreSelection(e),this.sandbox.getOption("mirrorBasedInstance")){var g=this.sandbox.getTextBeforeCursor();null!==g&&g.substring(g.length-b.length)!==b&&(g+=b),this.sandbox.fire("textReplaced",{textBeforeCursor:g?g:null,newText:b})}}},a.SentencesProcessor=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){this.name=a,this.container=c.getOption("container"),this.sandbox=c,b=c.UILib};c.prototype={init:function(){var a=this;this.sandbox.subscribe("markupPhrase",function(a){this.markupPhrase(a.ranges,a.lang)},this),this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:function(b){var c=this.sandbox.getOption("enableGrammar");c&&a.handleKeydown(b)}}),this.sandbox.subscribe("removeMarkupInSelectionNode, removeGrammarMarkupInSelectionNode",function(a){var b=this.sandbox.getOption("enableGrammar");b&&this.removeMarkupInSelectionNode(a)},this),this.sandbox.subscribe("removeMarkupInDocument",function(){var a=this.sandbox.getOption("enableGrammar");a&&this.removeMarkupInDocument()},this),this.sandbox.subscribe("removeMarkupFromPhrases",function(a){this.removeMarkupFromPhrases(a.phrases)},this),this.sandbox.subscribe("removeMarkup",function(a){a.grammar&&this.removeMarkup(a.nodes)},this)},handleKeydown:function(a){var b,c,d,e,f,g,h,i,j,k=this,l=this.sandbox.Utils,m=67,n=65,o=90,p=89,q=[45],r=[8,13,32,106,107,109,110,111,187,186,188,190,191,192,219,220,221,222];r.push(l.Browser.gecko?173:189),b=(a.ctrlKey||a.metaKey)&&a.keyCode===m,c=(a.ctrlKey||a.metaKey)&&a.keyCode===n,d=(a.ctrlKey||a.metaKey)&&!a.shiftKey&&a.keyCode===o,e=(a.ctrlKey||a.metaKey)&&a.shiftKey&&a.keyCode===o,f=(a.ctrlKey||a.metaKey)&&!a.shiftKey&&a.keyCode===p,g=!(b||c||d||e||f),h=a.keyCode>40&&a.keyCode<91||a.keyCode>=96&&a.keyCode<=105,i=q.indexOf(a.keyCode)<0,j=r.indexOf(a.keyCode)>=0,(g&&h&&i||j)&&k.removeMarkupInSelectionNode()},markupPhrase:function(a,c){if(0!==a.length){var d=this,e=d.sandbox.getOption("documentContainer"),f=d.sandbox.getOption("problem_grammar_node"),g=d.sandbox.getOption("problem_grammar_data_attribute"),h=d.sandbox.getOption("problem_grammar_data_attribute_rule"),i=d.sandbox.getOption("problem_grammar_class"),j=d.sandbox.getOption("data_lang_attribute"),k=d.sandbox.RegularsManager.ieSeparator,l=d.sandbox.Utils.getCurrentDocument(e).createElement(f);this.sandbox.UILib.addClass(l,i),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var m=0;m<a.length;m++){var n=a[m].range,o=n.commonAncestorContainer(),p=d.sandbox.Utils.isEqualNode(o,g)?[o]:b.findNodeParents(o,f,g);if(0===p.length){var q=l.cloneNode(!0),r=n.toString();c&&q.setAttribute(j,c),r=d.sandbox.removeSpecialCharacters(r),r=k.replace(r," "),q.setAttribute(g,r),q.setAttribute(h,a[m].rule),q.appendChild(n.extractContents()),n.insertNode(q),this.sandbox.fire("markupedNode",{node:q});for(var s=b.findNodeChildren(q,f,g);s.length>0;){var t=s.shift();d.removeMarkup(t)}}}this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})}},removeMarkupInDocument:function(){var a=this,c=this.container,d=a.sandbox.getOption("problem_grammar_node"),e=a.sandbox.getOption("problem_grammar_data_attribute"),f=b.query(c,d+"["+e+"]");a.removeMarkup(f),this.sandbox.fire("updateSentencesCache",{})},removeMarkupFromPhrases:function(a){for(var b,c=this,d=this.sandbox.UILib,e=this.container,f=c.sandbox.getOption("problem_grammar_node"),g=c.sandbox.getOption("problem_grammar_data_attribute"),h=[],i=0;i<a.length;i++)h.push.apply(h,d.query(e,f+"["+g+'="'+a[i].phrase+'"]'));c.removeMarkup(h),d.each(h,function(a,e){b=d.attr(e,g),c.sandbox.fire("updateSentencesCache",{phrase:b})})},removeMarkupInSelectionNode:function(a){function b(a){var b=[];return b=a.filter(function(a){return j.isEqualNode(a,l)}),0===b.length&&(b=k.findNodeParents(a[0],m,l)),b}var c,d,e,f,g,h,i=this,j=this.sandbox.Utils,k=this.sandbox.UILib,l=this.sandbox.getOption("problem_grammar_data_attribute"),m=this.sandbox.getOption("problem_grammar_node"),n=a&&a.selectionNode,o=a&&a.removeInside,p=a&&a.forceBookmark,q=this.sandbox.getSelection(),r=this.container,s=[],t=[];n?r.contains(n)&&(e=i.sandbox.createRange(),e.selectNode(n),s=e.getNodes(),t=s):q.rangeCount()>0&&(e=q.getRangeAt(0),c=e.startContainer(),d=e.endContainer(),f=e.startOffset(),g=e.endOffset(),s=this.getNeighbourGrammarNodes(c,d,f,g),t=e.getNodes(),t=s.concat(t),o&&(s=t)),t=b(t),s=b(s),t=j.ArrayUtils.arrayUnique(t),s=j.ArrayUtils.arrayUnique(s);for(var u=0,v=t.length;v>u;u+=1)h=k.attr(t[u],l),this.sandbox.fire("updateSentencesCache",{phrase:h});p&&!this.sandbox.getOption("focused")&&s.length>0&&this.sandbox.fire({eventType:"focus",element:this.container});for(var u=0,v=s.length;v>u;u+=1)s[u].innerHTML&&i.removeMarkup(s[u])},getNeighbourGrammarNodes:function(a,b,c,d){function e(a,b,c){var d,e,f,g=h.sandbox.getOption("container"),k=h.sandbox.RegularsManager,n=k.blockElementsRegex,o=k.nonWhiteSpaceExtended,p=o.g();if(b){f=new i.Walker(b,c,a,g);do{if(f.siblingNode&&n.test(f.siblingNode.nodeName.toLowerCase())&&f.textWalkedThrough.length>0&&o.test(f.textWalkedThrough))break;if(i.isEqualNode(f.currentNode,l)&&f.textWalkedThrough.length>0){d=f.currentNode;break}if(e=f.textWalkedThrough,a||(e=e.split("").reverse().join("")),p.setLastIndex(0),p.test(e)&&p.getLastIndex()+1<=e.length){d=j.findNodeParents(f.currentNode,m,l)[0];break}}while(f.getNext())}return d}var f,g,h=this,i=this.sandbox.Utils,j=this.sandbox.UILib,k=[],l=this.sandbox.getOption("problem_grammar_data_attribute"),m=this.sandbox.getOption("problem_grammar_node");return f=e(!1,a,c),g=e(!0,b,d),k=k.concat(f,g)},removeMarkup:function(a){var b,c,d=(this.sandbox.Utils.getCurrentDocument(this.sandbox.getOption("documentContainer")),this.sandbox.isFocused()),e=[].concat(a);for(d&&e.length>0&&(b=this.sandbox.saveSelection(),c=this.sandbox.getSavedSelectionParentContainer(b)),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});e.length>0;){var f=e.shift(),g=this.sandbox.createRange();g.selectNode(f);var h=g.createContextualFragment(f.innerHTML);g.deleteContents(),this.sandbox.fire("removedMarkupInContainer",{node:g.commonAncestorContainer()}),g.insertNode(h)}this.sandbox.restoreSelection(b),this.sandbox.Utils.Browser.gecko&&c&&c.normalize(),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})}},a.GrammarMarkup=c}(WEBSPELLCHECKER.CORE),function(){function a(a,b,c){function d(){var c=WEBSPELLCHECKER._createApp(a,function(a){k=k||f(a),k=g(k),b&&b(k)});c&&!k&&(k=f(c))}function f(a){var b=a._sandbox,c={openDialog:function(b){a.fire("openDialog",{dialogName:b})},setCssStyles:function(a){var c=b.getOption("container");for(var d in a)a.hasOwnProperty(d)&&(c.style[d]=a[d])},setShortcuts:function(a){b.fire("setShortcuts",{shortcuts:a})},removeShortcuts:function(a){b.fire("removeShortcuts",{shortcuts:a})}};return c=Object.assign(a,c)}function g(a){var b=a._sandbox,c=a._getService("MaxLength"),d=a._getService("Wrapper");return a.getTextLength=function(){return c.getTextLength()},a.refresh=function(){var c=b.getOption("container");d.isTextBased&&(c.innerHTML=b.DataProcessor.textToHtml(d.getData(),d.isInputBased),a.reloadMarkup())},a.getData=function(){return d.getData()},a.setData=function(b){"string"==typeof b&&(d.setData(b),a.reloadMarkup())},delete a._sandbox,delete a._getService,a}function h(){a.container.onload=function(){d()}}var i,k,l,m=window.WEBSPELLCHECKER_CONFIG,n=WEBSPELLCHECKER.CORE.prototype.Utils,o="";if(a=a||{},a.container="string"==typeof a.container?document.getElementById(a.container):a.container,a.autoStartup=a.autoStartup===!1?!1:!0,a=Object.assign({},a),function(){for(var b in e)"undefined"==typeof a[b]&&(m[b]&&(a[b]=m[b]),i=b.toLowerCase(),a[i]&&b.toLowerCase()!==b&&(a[b]=a[i],delete a[i]))}(),a=j.createOptions(a,e,function(a){a.reports.forEach(function(a){a.critical&&(o+=a.message+"; ")},this)}),""!==o)return l=new Error(o),c(l),l;if(a.container&&a.container.nodeName&&"iframe"===a.container.nodeName.toLowerCase())if(a.container.attachEvent)"complete"===a.container.readyState?d():a.container.attachEvent("onload",function(){d()});else{var p=a.container.contentWindow,q=p.document,r="about:blank",s=a.container.src.trim();"interactive"===q.readyState||"complete"===q.readyState?n.Browser.chrome&&p.location.href===r&&s!==r?h():d():h()}else d();return k}function b(a){function b(a,b){a.removeChild(b)}var c=document.createElement("script"),d=document.getElementsByTagName("head")[0];c.type="text/javascript",c.src=a.url,c.onload=function(){this.success||(this.success=!0,a.onSuccess(),b(d,c))},c.onerror=function(){a.onError(),b(d,c)},d.appendChild(c)}function c(a){a.url="../wscbundle/wscbundle.js",b(a)}function d(){WEBSPELLCHECKER.getControlById=function(a){return WEBSPELLCHECKER.CORE.prototype.instanceManager.getControlById(a)
},WEBSPELLCHECKER.createControlById=function(a,b,c,d){b=b||{},b.container=document.getElementById(a),WEBSPELLCHECKER.init(b,c,d)},i.forEach(function(a){a()}),g(),h=!0,function(){function b(){var a,b=WEBSPELLCHECKER.CORE.prototype.Utils.getBaseData("wscbundle.js").script,d="data-wsc-";b||(b=WEBSPELLCHECKER.CORE.prototype.Utils.getBaseData("app.js").script),b&&(i=l.getOptionsFromDataAttrs(b,d),a=i.autosearch||window.WEBSPELLCHECKER_CONFIG.autoSearch,a&&(i.autoStartup=!0,i.contextMenuByMouseover=!0,i.enableBadgeButton=!0,i.units=["spelling","grammar","ui","autoSearchCreation"],c(),k.on("blur",window,h),k.on("focusin",document,h),r.hidden&&k.on(r.visibilityChangeEvent,document,f)))}function c(){j=setTimeout(function(){c()},m),h()}function d(){clearTimeout(j),j=null}function f(){document[r.hidden]?d():c()}function g(){var a,b=document.activeElement,c=document.getElementsByTagName("body")[0],d=b===c?!0:!1,f=b&&b.nodeName&&"iframe"===b.nodeName.toLowerCase(),g=f?b.contentWindow.document.getElementsByTagName("body")[0]:null,h=l.isTextBased(b),i=l.isInputBased(b),j=f?g:b,m=e.getDefaultValue("instance_class");if(!b)return null;for(var p=0;p<n.length;p++)if(k.hasClass(j,n[p]))return null;for(var p=0;p<o.length;p++)if(k.attr(j,o[p]))return null;return d||f?j.isContentEditable?{element:j,iframe:f?b:null}:null:h?l.Browser.edge&&i?null:i||"off"!==j.getAttribute("wrap")&&"nowrap"!==l.getComputedStyle(j).whiteSpace?j.disabled||j.readOnly||l.isHidden(j)?null:{element:j}:null:k.parents(j,"."+m)[0]?null:(a=k.parents(j,'[contenteditable="true"]'),a.length&&(j=a[a.length-1]),j.isContentEditable?{element:j}:null)}function h(){setTimeout(function(){var b=g();b&&(k.addClass(b.element,p),i.container=b.iframe?b.iframe:b.element,i.autoStartup=i.autostartup===!1?!1:!0,a(i,function(){k.removeClass(b.element,p)}))},0)}var i,j,k=WEBSPELLCHECKER.CORE.prototype.UILib,l=WEBSPELLCHECKER.CORE.prototype.Utils,m=2e3,n=["sc-input-text","sc-cm-paste-holder","ck-editor__editable","ProseMirror","ql-editor","public-DraftEditor-content"],o=["trix-id"],p="wsc-inprocess",q=e.getDefaultValue("instance_class"),r=l.getVisibilityApiData();n.unshift(q,p),k.domReady(function(){b()})}(),function(){var b="data-wsc-",c=WEBSPELLCHECKER.CORE.prototype.UILib,d=WEBSPELLCHECKER.CORE.prototype.Utils;c.domReady(function(){setTimeout(function(){for(var e,f=c.find("*["+b+"autocreate]"),g=0;g<f.length;g++)e=d.getOptionsFromDataAttrs(f[g],b),e.container=f[g],e.autoStartup=e.autostartup===!1?!1:!0,function(b){a(e,function(a){f[b].webspellcheckerInstance=a})}(g);window.webspellcheckerAlreadyLoaded&&window.webspellcheckerAlreadyLoaded()},20)})}(),function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib;a.domReady(function(){var b=a.find("*[autofocus]")[0],c=b&&b.proofraytFakeElement;c&&c.contentEditable&&c.focus()})}()}window.WEBSPELLCHECKER_CONFIG=window.WEBSPELLCHECKER_CONFIG||{},window.WEBSPELLCHECKER=window.WEBSPELLCHECKER||{};var e,f="undefined"!=typeof WEBSPELLCHECKER.CORE,g="function"==typeof window.webspellcheckerReady?window.webspellcheckerReady:function(){},h=!1,i=[],j=WEBSPELLCHECKER.OptionsManager,k=j.optionTypes,l=j.importOptionsTemplate("AppTemplate");e=j.mergeOptionsTemplates({disableOptionsStorage:{defaultValue:[],type:k.array}},l),e.setDefaults({theme:"classic-blue",appType:"EditableControls",units:["editableControls","spelling","grammar","ui"]}),WEBSPELLCHECKER.ready=function(a){h===!1?i.push(a):a()},WEBSPELLCHECKER.init=function(b,c,d){var e,f=WEBSPELLCHECKER.Utils.TypeChecker.isFunction;return c=f(c)?c:function(){},d=f(d)?d:function(a){throw a},h!==!1?e=a(b,c,d):void WEBSPELLCHECKER.ready(function(){a(b,c,d)})},f===!1?c({onSuccess:function(){d(),f=!0},onError:function(){}}):d()}(),function(a){"use strict";var b=a.prototype.UILib,c=a.prototype.Utils,d=a.prototype.DataProcessor,e=function(a,b){this.name=a,this.sandbox=b,this.originalElement=this.sandbox.getOption("originalContainer"),this.mirrorElement=null,this.mirrorElementTextContainer=null,this.oldText="",this.isInput=c.isInputBased(this.originalElement),this.isIE11=c.Browser.ie&&11===c.Browser.version,this.leftMouseButtonPressed=!1,this.timeoutDelay=1e3,this.timeoutId=null,this.mutationOptions={attributes:!0,attributeOldValue:!1,childList:!1,characterData:!1,characterDataOldValue:!1,subtree:!1},this.textNodeParts={},this.nodesToRemove=[],this.visibilityApiData=c.getVisibilityApiData(),this.properties={outer:["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","textAlign"],inner:["direction","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"]}};e.prototype={init:function(){c.isTextBased(this.originalElement)&&!c.isHidden(this.originalElement)&&"MutationObserver"in window&&(this.createMirrorElement(),this.copyStyles(!0),this.renderProblems([]),this.startChecking(),this.sandbox.setContainer(this.mirrorElement),this.sandbox.setOption("documentContainer",this.mirrorElement),this.sandbox.setOption("mirrorBasedInstance",!0),this.sandbox.setOption("isTextBasedContainer",!0),this.mutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.startMutationObserver(),this.startInputListener(),this.sandbox.subscribe({eventType:"scroll",element:this.originalElement,handler:this.handleScroll}),this.sandbox.subscribe({eventType:"textReplaced",handler:this.updateTextInOriginalContainer}),this.isInput&&(this.sandbox.subscribe({eventType:"input, keyup, click, change, mousewheel, touchmove",element:this.originalElement,handler:this.handleScroll}),this.sandbox.subscribe({eventType:"focus, blur",element:this.originalElement,handler:this.handleScrollWithDelay})),this.visibilityApiData.hidden&&this.sandbox.subscribe({eventType:this.visibilityApiData.visibilityChangeEvent,element:document,handler:this.handleVisibilityChange}))},createMirrorElement:function(){var a=c.getComputedStyle(this.originalElement),d=null,e=null;d=b.create("<div>")[0],d.style.position="absolute",d.style.whiteSpace="pre-wrap",d.style.borderColor="transparent",d.style.color="transparent",c.Browser.gecko&&(d.style.visibility="hidden"),this.isInput||(d.style.wordWrap="break-word"),b.attr(d,"contenteditable",!0),b.attr(d,"spellcheck",!1),b.attr(d,"aria-readonly",!1),b.addClass(d,"wsc-mirror"),e=b.create("<span>")[0],e.style.visibility="visible",e.style.color="transparent",e.style.whiteSpace="pre-wrap",e.style.margin="0",e.style.padding="0",e.style.border="0",(c.Browser.gecko||c.Browser.ie)&&(e.style.display="inline-block"),this.isInput&&(e.style.whiteSpace="nowrap"),b.appendTo(e,d),b.appendTo(b.create("<br>")[0],d),b.insertBefore(d,this.originalElement),b.attr(this.originalElement,"spellcheck",!1),this.originalElement.style.backgroundColor="transparent",("static"===this.originalElement.style.position||"static"===a.position)&&(this.originalElement.style.position="relative"),c.Browser.gecko&&!this.isInput&&(this.originalElement.style.lineHeight=a.lineHeight),this.mirrorElement=d,this.mirrorElementTextContainer=e,this.oldText=this.originalElement.value},copyStyles:function(a){var b=c.getComputedStyle(this.originalElement),d=this.getPosition(),e=parseInt(this.mirrorElement.style.top),f=parseInt(this.mirrorElement.style.left),g=this.originalElement.getBoundingClientRect();a&&this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var h=0;h<this.properties.outer.length;h++){var i=this.properties.outer[h],j=this.mirrorElement.style[i];if("height"!==i&&"width"!==i||!c.Browser.ie){if(("overflowX"===i||"overflowY"===i)&&c.Browser.gecko)continue;j!==i&&(this.mirrorElement.style[i]=b[i])}else this.mirrorElement.style[i]="border-box"===b.boxSizing?g[i]+"px":b[i]}for(var h=0;h<this.properties.inner.length;h++){var i=this.properties.inner[h],k=this.mirrorElementTextContainer.style[i];!this.isInput&&"lineHeight"===i&&c.Browser.gecko&&k!==i?(this.mirrorElementTextContainer.style[i]=b[i],this.originalElement.style[i]=b[i]):k!==i&&(this.mirrorElementTextContainer.style[i]=b[i])}c.Browser.gecko?(this.originalElement.scrollHeight>parseInt(b.height)&&"scroll"!==this.mirrorElement.style.overflowY&&(this.mirrorElement.style.overflowY="scroll"),"hidden"!==this.mirrorElement.style.overflowX&&(this.mirrorElement.style.overflowX="hidden")):c.Browser.ie&&!this.isInput?this.mirrorElement.style.overflowX="hidden":(this.mirrorElement.style.overflowX="hidden",this.mirrorElement.style.overflowY="hidden"),f!==parseInt(d.x)&&(this.mirrorElement.style.left=d.x+"px"),e!==parseInt(d.y)&&(this.mirrorElement.style.top=d.y+"px"),a&&this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},startChecking:function(){var a=this;this.timeoutId=setTimeout(function(){a.startChecking()},this.timeoutDelay),this.copyStyles(!0),this.checkTextChanges()},stopChecking:function(){clearTimeout(this.timeoutId),this.timeoutId=null},getPosition:function(){var a={x:0,y:0},b=this.sandbox.getOffsetParent(this.mirrorElement),c=b.getBoundingClientRect(),d=this.originalElement.getBoundingClientRect();return a.x=d.left-c.left,a.y=d.top-c.top,a},handleMutations:function(){(this.originalElement.style.width&&this.originalElement.style.width!==this.mirrorElement.style.width||this.originalElement.style.height&&this.originalElement.style.height!==this.mirrorElement.style.height)&&this.copyStyles()},handleInput:function(){var a,b=this,c=this.getStringsDiff(),d=this.getFilteredProblemPositions(c),e=this.getBoundaries(d),f=this.sortBoundaries(e);this.isIE11&&d.length?(a=this.updateTextInMirrorContainer(c),a||this.renderProblems(f)):this.renderProblems(f),this.sandbox.addDeferredFunction("collectProblemsAfterDelay",{single:!0,delay:2e3,deferredFunction:function(){b.sandbox.fire("startSpellCheck"),b.sandbox.fire("startGrammarCheck")}})},handleScroll:function(){var a,b,d,e=this.originalElement.scrollWidth,f=this.originalElement.scrollHeight;c.Browser.gecko&&(this.isInput&&this.mirrorElementTextContainer.style.width!==e?this.mirrorElementTextContainer.style.width=e+"px":this.isInput||this.mirrorElementTextContainer.style.height===f||(this.mirrorElementTextContainer.style.height=f+"px")),c.Browser.ie&&(d=c.getScrollWidthForInput(this.originalElement),this.isInput&&this.mirrorElementTextContainer.style.width!==d?this.mirrorElementTextContainer.style.width=d+"px":this.isInput||this.mirrorElementTextContainer.style.height===f||(this.mirrorElementTextContainer.style.height=f+"px")),a=this.originalElement.scrollTop,this.mirrorElement.scrollTop=a,this.isInput?(b=c.getScrollLeftForInput(this.originalElement),this.mirrorElement.scrollLeft=b):(b=this.originalElement.scrollLeft,this.mirrorElement.scrollLeft=b)},handleScrollWithDelay:function(){var a=this;setTimeout(function(){a.handleScroll()},0)},handleVisibilityChange:function(){document[this.visibilityApiData.hidden]?this.stopChecking():this.startChecking()},updateTextInOriginalContainer:function(a){var b,c;b=d.htmlToText(this.mirrorElementTextContainer.innerHTML,this.isInput),this.originalElement.value=this.fixNewLineSymbols(this.originalElement.value,b),null!==a.textBeforeCursor?(this.originalElement.setSelectionRange(a.textBeforeCursor.length,a.textBeforeCursor.length),this.sandbox.fire({eventType:"focus",element:this.originalElement})):this.sandbox.fire({eventType:"blur",element:this.mirrorElement}),c=this.checkMaxLength(a),!c&&this.stopInputListener(),this.sandbox.fire({element:this.originalElement,eventType:"input"}),!c&&this.startInputListener(),this.handleScroll(),this.oldText=this.originalElement.value},updateTextInMirrorContainer:function(a){var d,e,f,g,h,i,j=this.sandbox.createRange(),k=this.sandbox.getOption("misspelled_word_node"),l=this.sandbox.getOption("data_attribute_name"),m=this.sandbox.getOption("problem_grammar_node"),n=this.sandbox.getOption("problem_grammar_data_attribute"),o=this,p=[];if(!a||!a.clear)return!1;switch(d=this.getNodePartByPosition(a.start),a.operation){case"insert":i=a.text,this.isInput&&(i=i.replace(/\s/g," ")),j.setStart(d.node,a.start-d.start),j.collapse(!0),j.insertNode(document.createTextNode(i)),f=j.startContainer(),g=c.isEqualNode(f,l)?f:b.findNodeParents(f,k,l)[0],h=c.isEqualNode(f,n)?f:b.findNodeParents(f,m,n)[0],g&&p.push(g),h&&(h.isGrammarNode=!0,p.push(h));break;case"delete":e=this.getNodePartByPosition(a.end),j.setStart(d.node,a.start-d.start),j.setEnd(e.node,a.end-e.start+1),j.deleteContents();break;default:return!1}if(this.originalElement.value===this.mirrorElementTextContainer.textContent){for(var q=0;q<this.nodesToRemove.length;q++)this.mirrorElementTextContainer.contains(this.nodesToRemove[q])&&-1===p.indexOf(this.nodesToRemove[q])&&p.push(this.nodesToRemove[q]);return this.sandbox.fire("removeMarkup",{wsc:!0,nodes:p}),b.each(p,function(a,c){if(c.isGrammarNode){var d=b.attr(c,n);o.sandbox.fire("updateSentencesCache",{phrase:d})}}),this.mirrorElementTextContainer.normalize(),!0}return!1},fixNewLineSymbols:function(a,b){var c=a.match(/\n*$/);return c[0].length&&(b=b.replace(/\n*$/,c[0])),b},checkMaxLength:function(a){var b,c=this.originalElement.maxLength,d=this.originalElement.value,e=d.length-c,f=e>=a.newText.length?a.newText.length:e;return-1===c||0>=e?!1:(a.textBeforeCursor?(b=this.originalElement.selectionStart,this.originalElement.value=d.substring(0,b-f)+d.substring(b),this.originalElement.setSelectionRange(b-f,b-f)):this.originalElement.value=d.substring(0,d.length-f),!0)},checkTextChanges:function(){this.originalElement.value!==this.oldText&&this.handleInput()},getStringsDiff:function(){var a,b,c=this.originalElement.value,d=this.oldText,e=c.length>d.length?!0:!1,f=c.length===d.length?!0:!1,g=e?c:d,h=e?d:c,i=e?c.length-d.length:d.length-c.length;if(d!==c){if(this.oldText=c,c.length>d.length){if(c.substring(0,d.length)===d)return{operation:"insert",clear:!0,changed:0,start:d.length,end:d.length,text:g.substring(d.length),lengthDiff:i};if(c.substring(i)===d)return{operation:"insert",clear:!0,changed:0,start:0,end:0,text:g.substring(0,i),lengthDiff:i}}if(d.length>c.length){if(d.substring(0,c.length)===c)return{operation:"delete",clear:!0,changed:0,start:c.length,end:c.length,text:g.substring(h.length),lengthDiff:i};if(d.substring(i)===c)return{operation:"delete",clear:!0,changed:0,start:0,end:0,text:g.substring(0,i),lengthDiff:i}}for(var j=0;j<g.length;j++)if(g[j]!==h[j]){a=j;break}for(var j=g.length-1;j>=0;j--)if(g[j]!==h[j-i]){b=a-j>0?a+i-1:j;break}return{operation:e?"insert":f?"change":"delete",clear:b-a+1===i?!0:!1,changed:b-a+1===i?0:b-a+1-i,start:a,end:b,text:g.substring(a,b+1),lengthDiff:i}}},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(this.originalElement,this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},startInputListener:function(){this.sandbox.subscribe({eventType:"input",element:this.originalElement,handler:this.handleInput})},stopInputListener:function(){this.sandbox.unsubscribe({eventType:"input",element:this.originalElement,handler:this.handleInput})},getFilteredProblemPositions:function(a){function b(a){var b={node:a,start:n.length,end:n.length+a.nodeValue.length};o.textNodeParts[b.start]=b,o.textNodeParts[b.end]=b}var c=[this.mirrorElementTextContainer],d=c.shift(),e=this.sandbox.getOption("misspelled_word_node"),f=this.sandbox.getOption("data_attribute_name"),g=this.sandbox.getOption("problem_grammar_node"),h=this.sandbox.getOption("problem_grammar_data_attribute"),i=this.sandbox.getOption("problem_grammar_data_attribute_rule"),j=this.sandbox.RegularsManager,k=j.wordBoundaryRegexAndQuotes,l=[],m=[],n="",o=this;for(this.textNodeParts={},this.nodesToRemove=[];d;){switch(d.nodeType){case 3:this.isIE11&&b(d),n+=d.nodeValue;break;case 1:var p=d.nodeName.toLowerCase()==e.toLowerCase()&&d.getAttribute(f),q=d.nodeName.toLowerCase()==g.toLowerCase()&&d.getAttribute(h);if(p||q){var r=d.getAttribute(p?f:h),s=q?d.getAttribute(i):"";l.push({text:r,rule:s,type:p?"spelling":"grammar",lang:d.getAttribute("data-wsc-lang"),start:n.length,end:n.length+(r.length-1),node:d})}for(var t=0;t<d.childNodes.length;t++)c.splice(t,0,d.childNodes[t])}d=c.shift()}for(var t=0;t<l.length;t++){var u=l[t];if("insert"===a.operation){var v=a.clear?a.start:a.end-a.lengthDiff+1;if(u.start>=v&&(u.start+=a.lengthDiff,u.end+=a.lengthDiff),this.originalElement.value.substring(u.start,u.end+1)!==u.text){this.isIE11&&this.nodesToRemove.push(u.node);continue}}if(u.start>=a.start&&u.end<=a.end)this.isIE11&&this.nodesToRemove.push(u.node);else if(a.start>=u.start&&a.start<=u.end||a.end>=u.start&&a.end<=u.end)this.isIE11&&this.nodesToRemove.push(u.node);else if(u.start-a.end!==1||k.test(this.originalElement.value[a.end]))if(a.start-u.end!==1||k.test(this.originalElement.value[a.start])){if("delete"===a.operation){var w=a.clear?a.start:a.end-a.lengthDiff+1;if(u.start>=w&&(u.start-=a.lengthDiff,u.end-=a.lengthDiff),this.originalElement.value.substring(u.start,u.end+1)!==u.text){this.isIE11&&this.nodesToRemove.push(u.node);continue}}m.push(l[t])}else this.isIE11&&this.nodesToRemove.push(u.node);else this.isIE11&&this.nodesToRemove.push(u.node)}return m},getBoundaries:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({pos:"start",index:d.start,type:d.type,text:d.text,rule:d.rule,lang:d.lang}),b.push({pos:"end",index:d.end+1})}return b},sortBoundaries:function(a){return a.sort(function(a,b){return a.index!==b.index?b.index-a.index:"end"===a.pos&&"start"===b.pos?1:"start"===a.pos&&"end"===b.pos?-1:"start"===a.pos&&"start"===b.pos?"spelling"===a.type&&"grammar"===b.type?-1:1:0}),a},renderProblems:function(a){var b=this.originalElement.value,d=this.sandbox.getOption("misspelled_word_node"),e=this.sandbox.getOption("data_attribute_name"),f=this.sandbox.getOption("misspelled_word_class"),g=this.sandbox.getOption("problem_grammar_data_attribute"),h=this.sandbox.getOption("problem_grammar_class"),i=this.sandbox.getOption("problem_grammar_data_attribute_rule"),j=this;this.isInput&&(b=b.replace(/\s/g," ")),c.Browser.chrome&&c.Browser.ie||(b=b.split(""));for(var k=0;k<a.length;k++){var l,m=a[k];l="end"===m.pos?"@lt;/"+d+"@gt;":"spelling"===m.type?"@lt;"+d+" class=@quot;"+f+"@quot; "+e+"=@quot;"+m.text+"@quot; data-wsc-lang=@quot;"+m.lang+"@quot;@gt;":"@lt;"+d+" class=@quot;"+h+"@quot; "+g+"=@quot;"+m.text+"@quot;  data-wsc-lang=@quot;"+m.lang+"@quot;"+i+"=@quot;"+m.rule+"@quot;@gt;",c.Browser.chrome&&c.Browser.ie?b=b.substring(0,m.index)+l+b.substring(m.index):b.splice(m.index,0,l)}c.Browser.chrome&&c.Browser.ie||(b=b.join("")),b=c.escapeHTML(b),b=c.unescapeProblemTags(b),b=b.replace(/\n$/,"\n\n"),j.mirrorElementTextContainer.innerHTML=b},getNodePartByPosition:function(a){for(;!this.textNodeParts[a];)a--;return this.textNodeParts[a]},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null,this.stopChecking(),this.mirrorElement&&b.remove(this.mirrorElement)}},a.Mirror=e}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=(a.prototype.Utils,a.prototype.UILib),c=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.mutationOptions={attributes:!1,attributeOldValue:!1,childList:!0,characterData:!1,characterDataOldValue:!1,subtree:!0}};c.prototype={init:function(){this.sandbox.subscribe("fixBrokenNodes",function(a){this.fixBrokenNodes(a)},this),"MutationObserver"in window&&(this.mutationObserver=new window.MutationObserver(this.fixBrokenNodes.bind(this)),this.startMutationObserver(),this.sandbox.subscribe("lockMutationsListener",function(a){this.lockMutationsListener(a)},this))},fixBrokenNodes:function(a){var c=this,d=this.sandbox.getOption("problem_grammar_data_attribute");this.sandbox.addDeferredFunction("collectBrokenNodesAfterChanges",{single:!0,delay:1e3,deferredFunction:function(){var e=c.collectBrokenNodes(a);c.sandbox.fire("removeMarkup",{wsc:!0,nodes:e}),b.each(e,function(a,e){if(e.isGrammarNode){var f=b.attr(e,d);c.sandbox.fire("updateSentencesCache",{phrase:f})}}),c.sandbox.fire("garbageCollected")}})},lockMutationsListener:function(a){a.lock?this.stopMutationObserver():this.startMutationObserver()},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(this.container,this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},collectBrokenNodes:function(c){for(var d=c&&c.container?[c.container]:[this.container],e=d.shift(),f=this.sandbox.RegularsManager,g=this.sandbox.getOption("misspelled_word_node"),h=this.sandbox.getOption("data_attribute_name"),i=this.sandbox.getOption("problem_grammar_node"),j=this.sandbox.getOption("problem_grammar_data_attribute"),k=this.sandbox.getOption("problem_grammar_data_attribute_rule"),l=f.blockElementsRegex,m=f.ignoreElementsRegex,n=(f.punctuationRegExp.set(),f.ieSeparator),o=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),p=f.wordBoundaryRegexAndQuotes,q=f.space,r=a.DictionaryManager.Dictionary,s=a.GrammarDictionaryManager.Dictionary,t=this.sandbox.getOption("lang"),u=[],v=[],w="";e;){switch(e.nodeType){case 3:w+=e.nodeValue;break;case 1:var x=e.nodeName.toLowerCase()==g.toLowerCase()&&e.getAttribute(h),y=e.nodeName.toLowerCase()==i.toLowerCase()&&e.getAttribute(j);if(!o.test(b.attr(e,"className"))&&!m.match(e.nodeName)){if(x||y){var z,A,B=e.getAttribute(x?h:j),C=e.textContent||e.innerText,D=C.length,t=x?b.attr(e,"data-wsc-lang"):t,E=y?e.getAttribute(k):"";C=this.sandbox.removeSpecialCharacters(C),C=n.replace(C," "),z=x?r.getWord(C,t):s.getPhrase(C,E,t),e.isGrammarNode=y?!0:!1,A={node:e,start:w.length,end:w.length+(D-1)},B===C&&z?u.push(A):v.push(e)}for(var F=0;F<e.childNodes.length;F++)d.splice(F,0,e.childNodes[F]);e.nodeName.match(l)&&(d.length>e.childNodes.length&&d.splice(F,0,document.createTextNode(" ")),w.length>0&&" "!=w[w.length-1]&&d.splice(0,0,document.createTextNode(" ")))}}e=d.shift()}for(var F=0;F<u.length;F++){var G=u[F],H=w[G.start],I=w[G.end],J=w[G.start-1],K=w[G.end+1];(0!==G.start&&!q.test(H)&&!p.test(J)||G.end!==w.length-1&&!q.test(I)&&!p.test(K))&&v.push(G.node)}return v.reverse()},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null}},a.GarbageCollector=c}(WEBSPELLCHECKER.CORE),function(){function a(a,b){var c;a=Object.assign({},a);for(var d in a)c=b[d],c&&(a[c]=a[d],delete a[d]);return a}function b(b,c,d,e,f){b=a(b,c);var g=d(b,e,f);return g}function c(a){function b(a,b){for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c])}var c;if(a.scayt_srcUrl&&(a.basePath=a.scayt_srcUrl.replace("ckscayt.js",""),a.basePath=a.basePath.replace("tinymcescayt.js","")),!a.basePath)for(var d in h)if(a.basePath=e.getBaseData(d+".js").path,a.basePath)break;return a.basePath?(c=e.getLocationInfo(a.basePath),b(a,{serviceProtocol:c.protocol,serviceHost:c.host,servicePort:c.port,servicePath:c.pathname+"./../../../script/ssrv.cgi"}),a):void 0}function d(){if("object"==typeof window.SCAYT_CONFIG){window.WEBSPELLCHECKER_CONFIG=window.WEBSPELLCHECKER_CONFIG||{};var a="";for(var b in window.SCAYT_CONFIG)a=g[b]||b,window.WEBSPELLCHECKER_CONFIG[a]=window.SCAYT_CONFIG[b]}}window.SCAYT=WEBSPELLCHECKER.CORE;var e=SCAYT.prototype.Utils,f=function(c,d,e){var f,g,h=WEBSPELLCHECKER.CORE.prototype.RegularsManager,i={customer_id:"serviceId",ignoreGraytElementsRegex:"ignoreGrammarElements",graytAutoStartup:"enableGrammar",charsToObserve:"charsToObserve",service_protocol:"serviceProtocol",service_host:"serviceHost",service_port:"servicePort",service_path:"servicePath",customDictionary:"customDictionaryIds","ignore-words-with-mixed-cases":"ignoreWordsWithMixedCases","ignore-all-caps-words":"ignoreAllCapsWords","ignore-domain-names":"ignoreDomainNames","ignore-words-with-numbers":"ignoreWordsWithNumbers"},j={graytStateChanged:"enableGrammarChanged"};if(c.autoStartup=!0,c.units=["spelling","grammar"],c["options-to-restore"])for(var k=0;k<c["options-to-restore"].length;k+=1)f=c["options-to-restore"][k],i[f]&&(c["options-to-restore"][k]=i[f]);var l=b(c,i,WEBSPELLCHECKER._createApp,d,e),m=l.subscribe;l._getOption=l.getOption,l.getOption=function(a){return g={wordBoundaryRegex:h.wordBoundaryRegex._getRegExp()},g[a]?g[a]:l._getOption(a)},l.subscribe=function(a){var b=[];a=j[a]?j[a]:a,b[0]=a;for(var c=1;c<arguments.length;c+=1)b[c]=arguments[c];m.apply(l,b)};var n=l.fire;l.fire=function(a,b){"getGrammarSuggestionsList"!==a||b.rule||(b.rule=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(l.getGrammarNodeRuleAttributeName())),n.apply(l,arguments)};var o=l.getProblemDescriptionText;l.getProblemDescriptionText=function(a,b,c){return 2===arguments.length&&(c=b,b=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(l.getGrammarNodeRuleAttributeName())),o(a,b,c)};var p=l.getProblemNodeFromSelection;l.getProblemNodeFromSelection=function(){return l.problemNodeFromSelection=p(),l.problemNodeFromSelection},l.isScaytNode=l.isSpellingNode,l.getScaytNodeAttributeName=l.getSpellingNodeAttributeName,l.getScaytLangList=l.getSpellingLangList,l.getGraytNodeAttributeName=l.getGrammarNodeAttributeName,l.getGraytNodeRuleAttributeName=l.getGrammarNodeRuleAttributeName,l.getGraytLangList=l.getGrammarLangList,l.getSelectionNode=l.getProblemNodeFromSelection,l.isGraytNode=l.isGrammarNode,l.isLicensed=function(){return!l.isBannerEnable()};var q=l.getApplicationConfig;l.getApplicationConfig=function(){var a,b=q.call(l),c={};for(var d in i)a=i[d],"undefined"!=typeof b[a]&&(c[d]=b[a]);return c};var r=l.commitOption;return l.commitOption=function(b){var c=b.changedOptions;c=a(c,i),b.changedOptions=c,r(b)},l.basePath&&(SCAYT.CKSCAYT.prototype.basePath=l.basePath),l},g={spellcheckLang:"lang",additionalMenuItems:"additionalActionItems",elementsToIgnore:"ignoreElements",contextMenuSections:"actionItemsSections",contextMenuCommands:"actionItems",uiTabs:"settingsSections",enableGrayt:"enableGrammar",customerId:"serviceId"},h={scayt:e.getBaseData("scayt.js").path,customscayt:e.getBaseData("customscayt.js").path,ckscayt:e.getBaseData("ckscayt.js").path,tinymcescayt:e.getBaseData("tinymcescayt.js").path};SCAYT.SCAYT=function(a,d,e){a.basePath=h.scayt,c(a),a.contextMenuSections&&(a.contextMenuSections=a.contextMenuSections.replace(/\s/g,""),a.contextMenuSections=a.contextMenuSections.split("|")),a.contextMenuCommands&&(a.contextMenuCommands=a.contextMenuCommands.replace(/\s/g,""),a.contextMenuCommands=a.contextMenuCommands.replace(/toggleproofrayt/g,"toggle"),a.contextMenuCommands=a.contextMenuCommands.split("|")),a.uiTabs&&(a.uiTabs=a.uiTabs.replace(/\s/g,""),a.uiTabs=a.uiTabs.split(","));var f=b(a,g,WEBSPELLCHECKER.init,d,e);return f},SCAYT.SCAYT.createScaytControl=function(a,b,c,d){return b.container=a,new SCAYT.SCAYT(b,c,d)},SCAYT.SCAYT.createScaytControlById=function(a,b,c,d){return b.container=a,new SCAYT.SCAYT(b,c,d)},SCAYT.SCAYT.getScaytControlById=WEBSPELLCHECKER.getControlById,SCAYT.prototype.instanceManager.getScaytControlById=SCAYT.prototype.instanceManager.getControlById,SCAYT.CUSTOMSCAYT=function(a,d,e){a=Object.assign({units:["spelling","grammar","ui"]},a),a.basePath=h.customscayt,a.data_attribute_name=a.data_attribute_name||"data-scayt-word",a.problem_grammar_data_attribute=a.problem_grammar_data_attribute||"data-grayt-phrase",a.appType="Froala",SCAYT.CUSTOMSCAYT.prototype.basePath=a.basePath,c(a),a.contextMenuSections&&(a.contextMenuSections=a.contextMenuSections.replace(/\s/g,""),a.contextMenuSections=a.contextMenuSections.split("|")),a.contextMenuCommands&&(a.contextMenuCommands=a.contextMenuCommands.replace(/\s/g,""),a.contextMenuCommands=a.contextMenuCommands.split("|"));var f=b(a,g,WEBSPELLCHECKER._createApp,d,e);return f},SCAYT.CKSCAYT=function(a,b,d){return a.basePath=h.ckscayt,a.appType="CKEditor",c(a),SCAYT.CKSCAYT.prototype.basePath=a.basePath,f(a,b,d)},SCAYT.CKSCAYT.prototype.basePath=h.ckscayt,SCAYT.TINYMCE=function(a,b,d){a.basePath=h.tinymcescayt,a.appType="TinyMCE",c(a),SCAYT.TINYMCE.prototype.basePath=a.basePath;var e=f(a,b,d);return e.getLangList=e.getSpellingLangList,e},function(){var a="data-scayt-",b="data-wsc-",e=WEBSPELLCHECKER.CORE.prototype.UILib,f=WEBSPELLCHECKER.CORE.prototype.Utils;e.domReady(function(){d();var i,j,k,l,m,n,o=e.find("*["+a+"autocreate]");i=c({basePath:h.scayt}),n=window.WEBSPELLCHECKER_CONFIG;for(var p=0;p<o.length;p++){j=o[p],k=f.HTMLCollectionToArray(j.attributes);for(var q=0;q<k.length;q+=1)if(l=k[q].name,l.includes(a)){m=j.getAttribute(l),j.removeAttribute(l),l=l.replace(a,b);for(var r in g)l.includes(r.toLowerCase())&&(l=l.replace(r.toLowerCase(),g[r]));j.setAttribute(l,m||"")}for(var s in i)!i.hasOwnProperty(s)||j.getAttribute(b+s)||n[s]||j.setAttribute(b+s,i[s])}})}(),window.scaytAlreadyLoaded&&window.scaytAlreadyLoaded(),e.inArray=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},e.indexOf=function(a){function b(a){"use strict";if(null==this)throw new TypeError;var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;if(b=0,arguments.length>1&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&1/0!=b&&b!=-1/0&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),b>=e)return-1;for(c=b>=0?b:Math.max(e-Math.abs(b),0);e>c;c++)if(c in d&&d[c]===a)return c;return-1}var c,d=Array.prototype.slice.apply(arguments);return d.shift(),c="[object Array]"!==Object.prototype.toString.call(a)||Array.prototype.indexOf?Array.prototype.indexOf.apply(a,d):b.apply(a,d)}}();